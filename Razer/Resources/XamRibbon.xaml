<igRibbon:XamRibbon xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
	xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	xmlns:igRibbon="http://infragistics.com/Ribbon"
	xmlns:igDock="http://infragistics.com/DockManager"
						xmlns:igEditors="http://infragistics.com/Editors"
						xmlns:igThemes="http://infragistics.com/Themes"
							xmlns:event="clr-namespace:RazerBase;assembly=RazerBase"
	xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
	xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:igWindows="http://infragistics.com/Windows" mc:Ignorable="d"
	xmlns:sys="clr-namespace:System;assembly=mscorlib"
	xmlns:System_ComponentModel="clr-namespace:System.ComponentModel;assembly=PresentationFramework" x:Name="XamRibbon1" Height="150">
	<igRibbon:XamRibbon.Resources>
		<sys:Boolean x:Key="{x:Static igRibbon:RibbonWindowContentHost.IsScenicThemeKey}">False</sys:Boolean>
		<!-- Converters-->
		<BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
		<igRibbon:ContextualTabBaseColorToHoverBrushConverter x:Key="contextualTabBaseColorToHoverBrushConverter" />
		<igWindows:StringWithoutMnemonicsConverter x:Key="stringWithoutMnemonicsConverter" />


 





        <!-- SSP 3/12/10 TFS27090 -->
		<igWindows:NullToFalseConverter x:Key="nullToFalseConverter" />
		<igWindows:TypeCheckConverter x:Key="typeCheckConverter" />
		<igWindows:NullToParameterConverter x:Key="nullToParameterConverter" />


		<!-- SSP 11/9/10 TFS33587 -->
		<igWindows:BoolToValueConverter x:Key="complementConverter" >
			<igWindows:BoolToValueConverter.TrueConvertValue>
				<sys:Boolean>False</sys:Boolean>
			</igWindows:BoolToValueConverter.TrueConvertValue>
			<igWindows:BoolToValueConverter.FalseConvertValue>
				<sys:Boolean>True</sys:Boolean>
			</igWindows:BoolToValueConverter.FalseConvertValue>
		</igWindows:BoolToValueConverter>

		<!-- ========== Pager Button Styles ========== -->

		<Style x:Key="PagerScrollButtonBase" TargetType="{x:Type RepeatButton}">
			<Setter Property="Focusable" Value="False"/>
			<Setter Property="Margin" Value="0"/>
			<Setter Property="Padding" Value="0"/>
		</Style>

		<!-- ========== ScrollLeft Pager Button ========== -->
		<Style x:Key="{x:Static igRibbon:RibbonGroupCollection.PagerScrollLeftButtonStyleKey}" BasedOn="{StaticResource PagerScrollButtonBase}" TargetType="{x:Type RepeatButton}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="12" Height="Auto" x:Name="grid">
							<Border Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="4,0,0,4" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonBorderDarkFillKey}}" BorderThickness="1,1,0,1" x:Name="border1" SnapsToDevicePixels="True"/>
							<Rectangle HorizontalAlignment="Right" Margin="0,1,0,1" Width="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonLeftOuterBorderGradientFillKey}}" SnapsToDevicePixels="True" x:Name="rectangle1"/>
							<Rectangle HorizontalAlignment="Right" Margin="0,1,1,1" Width="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonLeftInnerBorderGradientFillKey}}" x:Name="rectangle" SnapsToDevicePixels="True"/>
							<Border HorizontalAlignment="Stretch" Margin="2,2,2,2" Width="Auto" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="2,0,0,2" x:Name="border" SnapsToDevicePixels="True"/>
							<Path Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonGlyphFillKey}}" SnapsToDevicePixels="True" HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Center" Stretch="None" Data="M3,0L3,5 0,2.5z"/>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Margin" TargetName="rectangle" Value="0,2,1,1"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderBrush" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonHoverBorderFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonHoverBorderFillKey}}"/>
								<Setter Property="Visibility" TargetName="border" Value="Hidden"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="BorderBrush" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonPressedBorderFillKey}}"/>
								<Setter Property="Margin" TargetName="border" Value="1,0,1,0"/>
								<Setter Property="Visibility" TargetName="rectangle1" Value="Collapsed"/>
								<Setter Property="BorderThickness" TargetName="border1" Value="1,1,1,1"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="Visibility" TargetName="border" Value="Visible"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="Margin" TargetName="rectangle" Value="1,1,1,1"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ========== ScrollRight Pager Button==========  -->
		<Style x:Key="{x:Static igRibbon:RibbonGroupCollection.PagerScrollRightButtonStyleKey}" BasedOn="{StaticResource PagerScrollButtonBase}" TargetType="{x:Type RepeatButton}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="12" Height="Auto" x:Name="grid">
							<Border HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonBlueGradientFillKey}}" CornerRadius="0,4,4,0" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonBorderDarkFillKey}}" BorderThickness="0,1,1,1" x:Name="border1" SnapsToDevicePixels="True"/>
							<Rectangle HorizontalAlignment="Left" Margin="0,1,0,1" Width="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonLeftOuterBorderGradientFillKey}}" Stroke="{x:Null}" SnapsToDevicePixels="True" x:Name="rectangle1"/>
							<Rectangle HorizontalAlignment="Left" Margin="1,1,0,1" Width="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonLeftInnerBorderGradientFillKey}}" x:Name="rectangle" SnapsToDevicePixels="True"/>
							<Border HorizontalAlignment="Stretch" Margin="2,2,2,2" Width="Auto" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="0,2,2,0" x:Name="border" SnapsToDevicePixels="True"/>
							<Path Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonGlyphFillKey}}" HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Center" Width="Auto" Stretch="None" Data="M0,0L0,5 3,2.5z"/>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Margin" TargetName="rectangle" Value="1,2,0,1"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonHoverFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonHoverBorderFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonHoverBorderFillKey}}"/>
								<Setter Property="Visibility" TargetName="border" Value="Hidden"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="BorderBrush" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonPressedBorderFillKey}}"/>
								<Setter Property="Margin" TargetName="border" Value="1,0,1,0"/>
								<Setter Property="Visibility" TargetName="rectangle1" Value="Collapsed"/>
								<Setter Property="BorderThickness" TargetName="border1" Value="1,1,1,1"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamPagerButtonPressedCenterFillKey}}"/>
								<Setter Property="Visibility" TargetName="border" Value="Visible"/>
								<Setter Property="Background" TargetName="border1" Value="{x:Null}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ========== DropDown Arrow Glyphs ========== -->
		<Style x:Key="GlyphStyleBase" TargetType="{x:Type Control}">
			<Setter Property="Focusable" Value="False" />
			<!-- AS 11/9/07 BR27990 -->
			<Setter Property="IsHitTestVisible" Value="False" />
		</Style>

		<MenuScrollingVisibilityConverter x:Key="MenuScrollingVisibilityConverter" />

		<!-- ========== MenuScrollViewer_Button Styles ========== -->
		<Style x:Key="MenuScrollViewerUpButton" TargetType="{x:Type RepeatButton}" >
			<Setter Property="ClickMode" Value="Hover" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<Grid x:Name="MenuScrollViewerUpButton">
							<Border SnapsToDevicePixels="True" x:Name="BorderDark" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="2,2,2,2"/>
							<Border SnapsToDevicePixels="True" Margin="1,1,1,1" x:Name="BorderLight_Center" Background="{DynamicResource MenuBackgroundGradient}"/>
							<Path
								x:Name="Glyph"
								Margin="0,4,0,5"
								HorizontalAlignment="Center"
								VerticalAlignment="Center"
								Height="4"
								Width="8"
								Stretch="Fill"
								Opacity="1"
								Data="M 0,4 C0,4 8,4 8,4 8,4 4,0 4,0 4,0 0,4 0,4 z"
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerNormalGlyphFillKey}}" SnapsToDevicePixels="True" />
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderThickness" TargetName="BorderLight_Center" Value="1,1,1,1"/>
								<Setter Property="Background" TargetName="BorderLight_Center" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderBrush" TargetName="BorderLight_Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerHoverBorderLightFillKey}}"/>
								<Setter Property="Fill" TargetName="Glyph" Value="{DynamicResource MenuBackgroundGradient}"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderThickness" TargetName="BorderLight_Center" Value="1,1,1,1"/>
								<Setter Property="Background" TargetName="BorderLight_Center" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderBrush" TargetName="BorderLight_Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerPressedBorderLightFillKey}}"/>
								<Setter Property="Fill" TargetName="Glyph" Value="{DynamicResource MenuBackgroundGradient}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="MenuScrollViewerDownButton" TargetType="{x:Type RepeatButton}" >
			<Setter Property="ClickMode" Value="Hover" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<Grid x:Name="MenuScrollViewerDownButton">
							<Border SnapsToDevicePixels="True" x:Name="BorderDark" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="2,2,2,2"/>
							<Border SnapsToDevicePixels="True" Margin="1,1,1,1" x:Name="BorderLight_Center" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerNormalCenterFillKey}}"/>
							<Path
								x:Name="Glyph"
								Margin="0,5,0,4"
								HorizontalAlignment="Center"
								VerticalAlignment="Center"
								Height="3"
								Width="6"
								Stretch="Fill"
								Opacity="1"
								Data="M 1,0 C1,0 7,0 7,0 7,0 4,3 4,3 4,3 1,0 1,0 z"
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerNormalGlyphFillKey}}" SnapsToDevicePixels="True" ClipToBounds="False" />
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerHoverBorderDarkFillKey}}"/>
								<Setter Property="BorderThickness" TargetName="BorderLight_Center" Value="1,1,1,1"/>
								<Setter Property="Background" TargetName="BorderLight_Center" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderBrush" TargetName="BorderLight_Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerHoverBorderLightFillKey}}"/>
								<Setter Property="Fill" TargetName="Glyph" Value="{DynamicResource MenuBackgroundGradient}"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderThickness" TargetName="BorderLight_Center" Value="1,1,1,1"/>
								<Setter Property="Background" TargetName="BorderLight_Center" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderBrush" TargetName="BorderLight_Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuScrollViewerPressedBorderLightFillKey}}"/>
								<Setter Property="Fill" TargetName="Glyph" Value="{DynamicResource MenuBackgroundGradient}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ========== MenuScrollViewer ========== -->
		<Style x:Key="MenuScrollViewer" TargetType="{x:Type ScrollViewer}" BasedOn="{x:Null}">
			<Setter Property="HorizontalScrollBarVisibility" Value="Hidden" />
			<Setter Property="VerticalScrollBarVisibility" Value="Auto" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ScrollViewer}">
						<Grid SnapsToDevicePixels="true">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*" />
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" />
								<RowDefinition Height="*" />
								<RowDefinition Height="Auto" />
							</Grid.RowDefinitions>
							<Border Grid.Row="1" Grid.Column="0">
								<ScrollContentPresenter CanContentScroll="{TemplateBinding CanContentScroll}" x:Name="PART_ScrollContentPresenter"  Margin="{TemplateBinding Padding}" />
							</Border>
							<RepeatButton Style="{StaticResource MenuScrollViewerUpButton}" Grid.Row="0" Grid.Column="0" Command="{x:Static ScrollBar.LineUpCommand}" Focusable="false" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Margin="0,1,1,1">
								<RepeatButton.Visibility>
									<MultiBinding FallbackValue="Visibility.Collapsed" Converter="{StaticResource MenuScrollingVisibilityConverter}" ConverterParameter="0">
										<Binding Path="ComputedVerticalScrollBarVisibility" RelativeSource="{RelativeSource TemplatedParent}" />
										<Binding Path="VerticalOffset" RelativeSource="{RelativeSource TemplatedParent}" />
										<Binding Path="ExtentHeight" RelativeSource="{RelativeSource TemplatedParent}" />
										<Binding Path="ViewportHeight" RelativeSource="{RelativeSource TemplatedParent}" />
									</MultiBinding>
								</RepeatButton.Visibility>
							</RepeatButton>
							<RepeatButton Style="{StaticResource MenuScrollViewerDownButton}" Grid.Row="2" Grid.Column="0" Command="{x:Static ScrollBar.LineDownCommand}" Focusable="false" CommandTarget="{Binding RelativeSource={RelativeSource TemplatedParent}}" Margin="0,1,1,1">
								<RepeatButton.Visibility>
									<MultiBinding FallbackValue="Visibility.Collapsed" Converter="{StaticResource MenuScrollingVisibilityConverter}" ConverterParameter="100">
										<Binding Path="ComputedVerticalScrollBarVisibility" RelativeSource="{RelativeSource TemplatedParent}" />
										<Binding Path="VerticalOffset" RelativeSource="{RelativeSource TemplatedParent}" />
										<Binding Path="ExtentHeight" RelativeSource="{RelativeSource TemplatedParent}" />
										<Binding Path="ViewportHeight" RelativeSource="{RelativeSource TemplatedParent}" />
									</MultiBinding>
								</RepeatButton.Visibility>
							</RepeatButton>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="{x:Static igRibbon:MenuTool.MenuToolDropDownArrowStyleKey}" TargetType="{x:Type Control}" BasedOn="{StaticResource GlyphStyleBase}" >
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphHoverForegroundFillKey}}" />
			<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphHoverBackgroundFillKey}}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Control}">
						<igWindows:CardPanel>
							<Grid x:Name="containerGrid" HorizontalAlignment="Center" VerticalAlignment="Center">
								<Path x:Name="arrowBG" SnapsToDevicePixels="True" Fill="{TemplateBinding Background}" Stretch="None" Data="M 0,0 C0,0 0,1 0,1 0,1 1,1 1,1 1,1 1,2 1,2 1,2 2,2 2,2 2,2 2,3 2,3 2,3 3,3 3,3 3,3 3,2 3,2 3,2 4,2 4,2 4,2 4,1 4,1 4,1 5,1 5,1 5,1 5,0 5,0 5,0 0,0 0,0 z" d:LayoutOverrides="Height" HorizontalAlignment="Center" Margin="0,1,0,0" VerticalAlignment="Top"/>
								<Path x:Name="arrowFG" SnapsToDevicePixels="True" d:LayoutOverrides="Height" HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Top" Fill="{TemplateBinding Foreground}" Stretch="None" Data="M 0,0 C0,0 0,1 0,1 0,1 1,1 1,1 1,1 1,2 1,2 1,2 2,2 2,2 2,2 2,3 2,3 2,3 3,3 3,3 3,3 3,2 3,2 3,2 4,2 4,2 4,2 4,1 4,1 4,1 5,1 5,1 5,1 5,0 5,0 5,0 0,0 0,0 z"/>
							</Grid>
						</igWindows:CardPanel>
						<ControlTemplate.Triggers>
							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="arrowBG" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphDisabledBackgroundFillKey}}" />
								<Setter TargetName="arrowFG" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphDisabledForegroundFillKey}}" />
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<DataTrigger Binding="{Binding (igRibbon:MenuToolBase.Location), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="QuickAccessToolbar">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphHoverForegroundFillKey}}" />
					<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphHoverBackgroundFillKey}}" />
				</DataTrigger>

				<!--<DataTrigger Binding="{Binding Path=(igRibbon:MenuTool.IsEnabled), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="False">
				<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphDisabledForegroundFillKey}}" />
				<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphDisabledBackgroundFillKey}}" />
			</DataTrigger>-->

				<DataTrigger Binding="{Binding (UIElement.IsMouseOver), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphHoverForegroundFillKey}}" />
					<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphHoverBackgroundFillKey}}" />
				</DataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding (UIElement.IsMouseOver), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="False"/>
						<Condition Binding="{Binding (ButtonBase.IsPressed), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="False"/>
						<Condition Binding="{Binding (igRibbon:MenuToolBase.IsOpen), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="False"/>
						<Condition Binding="{Binding (igRibbon:MenuToolBase.IsActive), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="False"/>
						<Condition Binding="{Binding (igRibbon:RibbonGroup.IsOpen), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="False"/>
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphNormalForegroundFillKey}}" />
					<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphNormalBackgroundFillKey}}" />
				</MultiDataTrigger>
			</Style.Triggers>
		</Style>

		<Style x:Key="{x:Static igRibbon:MenuTool.QuickCustomizeMenuDropDownArrowStyleKey}" TargetType="{x:Type Control}" BasedOn="{StaticResource GlyphStyleBase}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Control}">
						<igWindows:CardPanel>
							<Grid HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,2,2,0" Width="Auto" Height="Auto">
								<Path SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.QATCustomizeDropdownNormalBackgroundFillKey}}" Stretch="None" Data="M 0,0 C0,0 0,1 0,1 0,1 1,1 1,1 1,1 1,2 1,2 1,2 2,2 2,2 2,2 2,3 2,3 2,3 3,3 3,3 3,3 3,2 3,2 3,2 4,2 4,2 4,2 4,1 4,1 4,1 5,1 5,1 5,1 5,0 5,0 5,0 0,0 0,0 z" Width="5" d:LayoutOverrides="Height" Margin="0,4,0,0"/>
								<Path SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.QATCustomizeDropdownNormalForegroundFillKey}}" Stretch="None" Data="M 0,0 C0,0 0,1 0,1 0,1 1,1 1,1 1,1 1,2 1,2 1,2 2,2 2,2 2,2 2,3 2,3 2,3 3,3 3,3 3,3 3,2 3,2 3,2 4,2 4,2 4,2 4,1 4,1 4,1 5,1 5,1 5,1 5,0 5,0 5,0 0,0 0,0 z" d:LayoutOverrides="Width, Height" Margin="0,3,0,0"/>
								<Rectangle SnapsToDevicePixels="True" Height="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.QATCustomizeDropdownNormalForegroundFillKey}}" Margin="0,0,0,0" VerticalAlignment="Top" Width="Auto"/>
								<Rectangle SnapsToDevicePixels="True" Width="5" Height="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.QATCustomizeDropdownNormalBackgroundFillKey}}" VerticalAlignment="Top" Margin="0,1,0,0"/>
							</Grid>
						</igWindows:CardPanel>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="{x:Static igRibbon:MenuTool.MenuItemDropDownArrowStyleKey}" TargetType="{x:Type Control}" BasedOn="{StaticResource GlyphStyleBase}">
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuItemDropDownArrowFillKey}}"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Control}">
						<Grid  x:Name="Menu_Arrow" Margin="4,0,5,0" DockPanel.Dock="Right" igRibbon:XamRibbon.KeyTipPlacementType="DropDownButton" Grid.Column="3" HorizontalAlignment="Center" VerticalAlignment="Center" Width="Auto" Height="Auto">
							<Path x:Name="Glyph_Arrow" Fill="{TemplateBinding Foreground}"  SnapsToDevicePixels="True" Width="Auto" Stretch="None" Data="M0,0L0,7 4,3.5z" HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Center" Height="Auto"/>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<DataTrigger Binding="{Binding (UIElement.IsMouseOver), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuItemDropDownArrowHottrackFillKey}}" />
				</DataTrigger>
			</Style.Triggers>
		</Style>

		<!-- ========== Data Templates ========== -->
		<DataTemplate DataType="{x:Type igRibbon:RibbonGroupCollection}">
			<Grid x:Name="RootPanel">
				<ItemsControl ItemsSource="{Binding}" Padding="0,3,0,2" Focusable="False">
					<ItemsControl.Template>
						<ControlTemplate TargetType="{x:Type ItemsControl}">
							<igWindows:XamPager ScrollViewer.CanContentScroll="True" Focusable="False"
							ScrollLeftButtonStyle="{DynamicResource {x:Static igRibbon:RibbonGroupCollection.PagerScrollLeftButtonStyleKey}}"
							ScrollRightButtonStyle="{DynamicResource {x:Static igRibbon:RibbonGroupCollection.PagerScrollRightButtonStyleKey}}"
							ScrollViewer.VerticalScrollBarVisibility="Hidden"
							ScrollViewer.HorizontalScrollBarVisibility="Auto"
							Margin="-2,0,-2,0">
								<!-- AS 6/4/08 BR32242 
							The DataContext will be set by WPF to the RibbonGroupCollection but pass along the Ribbon data context instead.
							-->
								<!-- AS 5/3/10 TFS30101
				We were propogating the DataContext of the Ribbon via the Ribbon property. However there seems to be an issue in the WPF
				framework where when the element is coming out of the visual tree but not out of the logical tree, its inherited properties 
				are not getting fixed up properly. In this case the element's datacontext goes to null and never gets a change notification 
				back to the new value when its back in the visual tree - presumably because the value would be the same as what would be 
				provided by the logical parent. To try and get around this issue we can get a reference to the ribbon once since it will 
				never change once set and then just bind to the datacontext off that cached value.
			  <ItemsPresenter DataContext="{Binding Path=(igRibbon:XamRibbon.Ribbon).DataContext, RelativeSource={x:Static RelativeSource.Self}}"  Margin="{TemplateBinding Padding}"/>
			  -->
                                <!--Updated this below line. -->
								<ItemsPresenter Tag="{Binding (igRibbon:XamRibbon.Tag), Mode=OneTime, RelativeSource={x:Static RelativeSource.Self}}"
								DataContext="{Binding Tag.DataContext, RelativeSource={x:Static RelativeSource.Self}}"  
							  Margin="{TemplateBinding Padding}"/>
							</igWindows:XamPager>
						</ControlTemplate>
					</ItemsControl.Template>

					<ItemsControl.ItemsPanel>
						<ItemsPanelTemplate >
							<igRibbon:RibbonGroupPanel Background="{DynamicResource MenuBackgroundGradient}"/>
						</ItemsPanelTemplate>
					</ItemsControl.ItemsPanel>
				</ItemsControl>
			</Grid>
		</DataTemplate>

		<DataTemplate DataType="{x:Type igRibbon:ContextualTabGroup}">
			<igWindows:CardPanel SnapsToDevicePixels="True">
				<!--<Rectangle SnapsToDevicePixels="True" Height="Auto" Margin="0,0,0,0" VerticalAlignment="Stretch" x:Name="baseColorInCaption"
		 Fill="{Binding BaseBackColorResolvedBrush}"        >
				<Rectangle.OpacityMask>
					<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
						<GradientStop Color="#00000000" Offset="0.357"/>
						<GradientStop Color="#8FFFFFFF" Offset="1"/>
						<GradientStop Color="#19808080" Offset="0.646"/>
						<GradientStop Color="#42DDDDDD" Offset="0.837"/>
						<GradientStop Color="#38C7C7C7" Offset="0.824"/>
					</LinearGradientBrush>
				</Rectangle.OpacityMask>
			</Rectangle>-->
				<Rectangle SnapsToDevicePixels="True" Height="2" Margin="1,0,1,0" VerticalAlignment="Bottom" x:Name="BaseColorBottomGlow"
		 Fill="{DynamicResource MenuBackgroundGradient}"        >
					<Rectangle.OpacityMask>
						<LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
							<GradientStop Color="#99000000" Offset="0.5"/>
							<GradientStop Color="#00FFFFFF" Offset="1"/>
							<GradientStop Color="#00000000" Offset="0"/>
							<GradientStop Color="#3F000000" Offset="0.25"/>
							<GradientStop Color="#3F575757" Offset="0.75"/>
							<GradientStop Color="#99000000" Offset="0.364"/>
							<GradientStop Color="#99262626" Offset="0.636"/>
						</LinearGradientBrush>
					</Rectangle.OpacityMask>
				</Rectangle>

				<Rectangle x:Name="ContextualTabSideBorderLeft"
				HorizontalAlignment="Left"
				VerticalAlignment="Stretch"
				Width="1"
				Height="Auto"
				SnapsToDevicePixels="True"
				IsHitTestVisible="False"
				Fill="{DynamicResource MenuBackgroundGradient}"/>

				<Rectangle x:Name="ContextualTabSideBorderRight"
				HorizontalAlignment="Right"
				VerticalAlignment="Stretch"
				Width="1"
				Height="Auto"
				SnapsToDevicePixels="True"
				IsHitTestVisible="False"
				Fill="{DynamicResource MenuBackgroundGradient}"/>

				<TextBlock
				x:Name="CaptionGroupLabel"
				Foreground="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ContextualCaptionTextFillKey}}"
				Text="{Binding Caption}"
				VerticalAlignment="Center"
				TextAlignment="Left"
				Margin="8,0,0,0"
				TextTrimming="CharacterEllipsis"
				igWindows:ClippedTextToolTipService.ShowToolTipWhenClipped="True"
				igWindows:ClippedTextToolTipService.AncestorTypeForToolTip="{x:Type ContentControl}"
				igWindows:ClippedTextToolTipService.ToolTipStyleKey="{x:Static igRibbon:XamRibbon.ToolTipStyleKey}"/>

				<Rectangle SnapsToDevicePixels="True" Height="1" x:Name="BottomMask" Width="Auto" VerticalAlignment="Bottom"
				Fill="{DynamicResource MenuBackgroundGradient}"
				Margin="1,0,1,0"/>

			</igWindows:CardPanel>
			<DataTemplate.Triggers>

				<!--<DataTrigger Binding="{Binding Path=(igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True">
				<Setter TargetName="CaptionGroupLabel" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowColor=White, GlowSize=10, Opacity=0.6}" />
				<Setter TargetName="CaptionGroupLabel" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}" />
			</DataTrigger>-->

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
					</MultiDataTrigger.Conditions>
					<Setter TargetName="CaptionGroupLabel" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}" />
					<Setter TargetName="CaptionGroupLabel" Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}" />
				</MultiDataTrigger>

				<!-- HC 1/4/2008 === When a window==Maximized and IsGlassActive==True, any text that lives in the caption turns white-->
				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized" />
					</MultiDataTrigger.Conditions>
					<Setter TargetName="CaptionGroupLabel" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VistaWindowMaximizedTextFillKey}}" />
				</MultiDataTrigger>

			</DataTemplate.Triggers>
		</DataTemplate>

		<!-- ======================================== Styles ================================================== -->

		<!-- =================================================================== -->
		<!-- Styles for buttons in MenuButtonArea -->
		<!-- =================================================================== -->
		<!-- AS 11/8/07 BR27990  Moved up and adjusted the template to have a root level panel that could be used to provide the background -->
		<Style TargetType="{x:Type ContentControl}" x:Key="PlainContentControlStyle">
			<Setter Property="OverridesDefaultStyle" Value="True" />
			<Setter Property="Margin" Value="0" />
			<Setter Property="Padding" Value="0" />
			<Setter Property="Focusable" Value="False" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ContentControl}">
						<igWindows:CardPanel Background="{DynamicResource MenuBackgroundGradient}">
							<ContentPresenter Margin="{TemplateBinding Padding}"
								igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"  />
						</igWindows:CardPanel>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>


		<!-- ========== Caption Button Styles ========== -->

		<!--LeftCaptionButton-->
		<Style x:Key="XamRibbonCaptionButton_Left" BasedOn="{x:Null}" TargetType="{x:Type Button}">
			<Setter Property="Margin" Value="0,2"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Grid x:Name="XamRibbonCaptionButton_Left" Background="#00000000">
							<Border SnapsToDevicePixels="True" Visibility="Hidden" x:Name="BorderDark" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverBorderDarkFillKey}}" CornerRadius="3,3,3,3"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="1,1,1,1" x:Name="BorderLight" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverBorderLightFillKey}}" CornerRadius="2,2,2,2"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Center" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverCenterFillKey}}" CornerRadius="1,1,1,1"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Overlay1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverOverlayFillKey}}"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Overlay2" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedTopOverlayFillKey}}"/>
							<Path Opacity="1" Width="7" Height="2" Stretch="Fill" 
				  Data="F1 M0,-4.4703484E-08 L7,-4.4703484E-08 7,1 7,2 0,2 0,1 0,-4.4703484E-08 z" 
				  x:Name="IconBackground" SnapsToDevicePixels="True" 
				  Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeNormalBackgroundFillKey}}" 
				  HorizontalAlignment="Center" 
				  Margin="0,8,0,0" 
				  VerticalAlignment="Center"/>
							<Path Opacity="1" Width="7" Height="2" Stretch="Fill" 
				  Data="F1 M0,-4.4703484E-08 L7,-4.4703484E-08 7,1 7,2 0,2 0,1 0,-4.4703484E-08 z" 
				  x:Name="IconForeground" SnapsToDevicePixels="True" 
				  Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeNormalForegroundFillKey}}" 
				  HorizontalAlignment="Center" 
				  Margin="0,7,0,1" 
				  VerticalAlignment="Center"/>
						</Grid>
						<ControlTemplate.Triggers>

							<DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False">
								<Setter TargetName="IconForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeInactiveForegroundFillKey}}" />
							</DataTrigger>

							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay1" Value="Visible"/>
								<Setter Property="Fill" TargetName="IconBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeHoverBackgroundFillKey}}"/>
								<Setter Property="Fill" TargetName="IconForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeHoverForegroundFillKey}}"/>
							</Trigger>

							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay1" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay2" Value="Visible"/>
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBorderDarkFillKey}}"/>
								<Setter Property="Background" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBorderLightFillKey}}"/>
								<Setter Property="Background" TargetName="Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedCenterFillKey}}"/>
								<Setter Property="Background" TargetName="Overlay1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBottomOverlayFillKey}}"/>
								<Setter Property="Fill" TargetName="IconForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeNormalForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="IconBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeNormalBackgroundFillKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- MiddleCaptionButton-->
		<Style x:Key="XamRibbonCaptionButton_Middle" BasedOn="{x:Null}" TargetType="{x:Type Button}">
			<Setter Property="Margin" Value="0,2"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Grid x:Name="XamRibbonCaptionButton_MiddleContainer" Background="#00000000">
							<Border SnapsToDevicePixels="True" Visibility="Hidden" x:Name="BorderDark" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverBorderDarkFillKey}}" CornerRadius="3,3,3,3"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="1,1,1,1" x:Name="BorderLight" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverBorderLightFillKey}}" CornerRadius="2,2,2,2"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Center" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverCenterFillKey}}" CornerRadius="1,1,1,1"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Overlay1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverOverlayFillKey}}"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Overlay2" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedTopOverlayFillKey}}"/>
							<Grid
					x:Name="Maximize"
					HorizontalAlignment="Center"
					VerticalAlignment="Center"
					IsHitTestVisible="False">
								<Path
							x:Name="MaximizeBackground"
							Height="7"
							Width="9"
							Stretch="Fill"
							Opacity="1"
							Data="M 44,17 C44,17 51,17 51,17 51,17 51,20 51,20 51,20 44,20 44,20 44,20 44,17 44,17 zM 43,14 C43,14 43,21 43,21 43,21 52,21 52,21 52,21 52,14 52,14 52,14 43,14 43,14 z"
							SnapsToDevicePixels="True"
							Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalBackgroundFillKey}}"
							d:LayoutOverrides="Height" Margin="0,3,0,0" VerticalAlignment="Center"/>
								<Path
							x:Name="MaximizeForeground"
							Height="7"
							Width="9"
							Stretch="Fill"
							Opacity="1"
							Data="M 44,17 C44,17 51,17 51,17 51,17 51,20 51,20 51,20 44,20 44,20 44,20 44,17 44,17 zM 43,14 C43,14 43,21 43,21 43,21 52,21 52,21 52,21 52,14 52,14 52,14 43,14 43,14 z"
							SnapsToDevicePixels="True"
							Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}"
							d:LayoutOverrides="Width, Height" Margin="0,1,0,0" HorizontalAlignment="Center" VerticalAlignment="Center"/>
							</Grid>
							<Grid
						x:Name="MaximizeRestore"
						Visibility="Collapsed"
						Height="8"
						Width="9"            
						HorizontalAlignment="Center"
						VerticalAlignment="Center"
						IsHitTestVisible="False">
								<Path
								Stretch="Fill"
								Opacity="1"
								Data="M 1,3 C1,3 6,3 6,3 6,3 6,6 6,6 6,6 1,6 1,6 1,6 1,3 1,3 zM 0,1 C0,1 0,7 0,7 0,7 7,7 7,7 7,7 7,1 7,1 7,1 0,1 0,1 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeNormalBackgroundFillKey}}" Margin="0,2,2,0"
								x:Name="MaximizeRestoreBackground1"/>
								<Path
								Stretch="Fill"
								Opacity="1"
								Data="M 2,0 C2,0 2,2 2,2 2,2 3,2 3,2 3,2 7,2 7,2 7,2 8,2 8,2 8,2 8,5 8,5 8,5 7,5 7,5 7,5 7,6 7,6 7,6 9,6 9,6 9,6 9,0 9,0 9,0 2,0 2,0 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMinimizeNormalBackgroundFillKey}}" Margin="2,1,0,1"
								x:Name="MaximizeRestoreBackground2"/>
								<Path
								Margin="2,0,0,0"
								HorizontalAlignment="Left"
								VerticalAlignment="Top"
								Height="6"
								Width="7"
								Stretch="Fill"
								Opacity="1"
								Data="M 2,0 C2,0 2,2 2,2 2,2 3,2 3,2 3,2 7,2 7,2 7,2 8,2 8,2 8,2 8,5 8,5 8,5 7,5 7,5 7,5 7,6 7,6 7,6 9,6 9,6 9,6 9,0 9,0 9,0 2,0 2,0 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}"
								x:Name="MaximizeRestoreForeground2"/>
								<Path
								Margin="0,1,0,0"
								HorizontalAlignment="Left"
								VerticalAlignment="Top"
								Height="6"
								Width="7"
								Stretch="Fill"
								Opacity="1"
								Data="M 1,3 C1,3 6,3 6,3 6,3 6,6 6,6 6,6 1,6 1,6 1,6 1,3 1,3 zM 0,1 C0,1 0,7 0,7 0,7 7,7 7,7 7,7 7,1 7,1 7,1 0,1 0,1 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}"
								x:Name="MaximizeRestoreForeground1"/>
							</Grid>
						</Grid>
						<ControlTemplate.Triggers>

							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False" />
									<Condition Binding="{Binding IsEnabled, RelativeSource={RelativeSource TemplatedParent}}" Value="True" />
								</MultiDataTrigger.Conditions>
								<Setter TargetName="MaximizeRestoreForeground1" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveForegroundFillKey}}" />
								<Setter TargetName="MaximizeRestoreForeground2" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveForegroundFillKey}}" />
								<Setter TargetName="MaximizeForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveForegroundFillKey}}" />
							</MultiDataTrigger>

							<!-- Trigger that will hide the left two caption buttons when the ResizeMode of the window is NoResize-->
							<DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized">
								<Setter TargetName="Maximize" Property="Visibility" Value="Collapsed"/>
								<Setter TargetName="MaximizeRestore" Property="Visibility" Value="Visible"/>
							</DataTrigger>

							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Fill" TargetName="MaximizeForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalDisabledForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreForeground1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalDisabledForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreForeground2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalDisabledForegroundFillKey}}"/>
							</Trigger>

							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False" />
									<Condition Binding="{Binding IsEnabled, ElementName=XamRibbonCaptionButton_Middle}" Value="False" />
								</MultiDataTrigger.Conditions>
								<Setter Property="Fill" TargetName="MaximizeForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveDisabledForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreForeground1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveDisabledForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreForeground2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveDisabledForegroundFillKey}}"/>
							</MultiDataTrigger>

							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay1" Value="Visible"/>
								<Setter Property="Fill" TargetName="MaximizeForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverBackgroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreForeground1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreBackground1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverBackgroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreForeground2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeRestoreBackground2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverBackgroundFillKey}}"/>
							</Trigger>

							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay1" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay2" Value="Visible"/>
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBorderDarkFillKey}}"/>
								<Setter Property="Background" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBorderLightFillKey}}"/>
								<Setter Property="Background" TargetName="Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedCenterFillKey}}"/>
								<Setter Property="Background" TargetName="Overlay1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBottomOverlayFillKey}}"/>
								<Setter Property="Fill" TargetName="MaximizeBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalBackgroundFillKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- RightCaptionButton -->
		<Style x:Key="XamRibbonCaptionButton_Right" BasedOn="{x:Null}" TargetType="{x:Type Button}">
			<Setter Property="Margin" Value="0,2,2,2"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Button}">
						<Grid x:Name="XamRibbonCaptionButton_Right" Background="#00000000">
							<Border SnapsToDevicePixels="True" Visibility="Hidden" x:Name="BorderDark" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverBorderDarkFillKey}}" CornerRadius="3,3,3,3"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="1,1,1,1" x:Name="BorderLight" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverBorderLightFillKey}}" CornerRadius="2,2,2,2"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Center" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverCenterFillKey}}" CornerRadius="1,1,1,1"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Overlay1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonHoverOverlayFillKey}}"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="Overlay2" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedTopOverlayFillKey}}"/>
							<!-- AS 8/21/08 BR35778
						<Path x:Name="IconBackground"
								Stretch="Fill"
								Opacity="1"
								Data="M 646,303 C646,303 644.5,305 644.5,305 644.5,305 643,303 643,303 643,303 640,303 640,303 640,303 643,307 643,307 643,307 640,311 640,311 640,311 643,311 643,311 643,311 644.5,309 644.5,309 644.5,309 646,311 646,311 646,311 649,311 649,311 649,311 646,307 646,307 646,307 649,303 649,303 649,303 646,303 646,303 z" 
								SnapsToDevicePixels="True" 
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalBackgroundFillKey}}" 
								d:LayoutOverrides="Height" 
								Margin="8,9,8,7" 
								VerticalAlignment="Bottom"/>
						<Path x:Name="IconForeground"
								Stretch="Fill"
								Opacity="1"
								Data="M 646,303 C646,303 644.5,305 644.5,305 644.5,305 643,303 643,303 643,303 640,303 640,303 640,303 643,307 643,307 643,307 640,311 640,311 640,311 643,311 643,311 643,311 644.5,309 644.5,309 644.5,309 646,311 646,311 646,311 649,311 649,311 649,311 646,307 646,307 646,307 649,303 649,303 649,303 646,303 646,303 z" 
								SnapsToDevicePixels="True" 
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}" 
								d:LayoutOverrides="Width, Height" 
								HorizontalAlignment="Stretch" 
								Margin="8,9,8,8" 
								VerticalAlignment="Bottom"/>
						-->
							<Path x:Name="IconBackground"
							Height="8"
							Width="9"
							Stretch="Fill"
							Opacity="1"
							Data="M 0,0 C0,0 0,1 0,1 0,1 3,4 3,4 3,4 0,7 0,7 0,7 0,8 0,8 0,8 3,8 3,8 3,8 4,6 4,6 4,6 5,6 5,6 5,6 6,8 6,8 6,8 9,8 9,8 9,8 9,7 9,7 9,7 6,4 6,4 6,4 9,1 9,1 9,1 9,0 9,0 9,0 6,0 6,0 6,0 5,2 5,2 5,2 4,2 4,2 4,2 3,0 3,0 3,0 0,0 0,0 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalBackgroundFillKey}}" d:LayoutOverrides="Height"
							  VerticalAlignment="Center"/>
							<Path x:Name="IconForeground"
							Height="8"
							Width="9"
							Stretch="Fill"
							Opacity="1"
							Data="M 0,0 C0,0 0,1 0,1 0,1 3,4 3,4 3,4 0,7 0,7 0,7 0,8 0,8 0,8 3,8 3,8 3,8 4,6 4,6 4,6 5,6 5,6 5,6 6,8 6,8 6,8 9,8 9,8 9,8 9,7 9,7 9,7 6,4 6,4 6,4 9,1 9,1 9,1 9,0 9,0 9,0 6,0 6,0 6,0 5,2 5,2 5,2 4,2 4,2 4,2 3,0 3,0 3,0 0,0 0,0 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}" d:LayoutOverrides="Width, Height" HorizontalAlignment="Stretch" 
							  VerticalAlignment="Center"/>
						</Grid>
						<ControlTemplate.Triggers>

							<DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False">
								<Setter TargetName="IconForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseInactiveForegroundFillKey}}" />
							</DataTrigger>

							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay1" Value="Visible"/>
								<Setter Property="Fill" TargetName="IconBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverBackgroundFillKey}}"/>
								<Setter Property="Fill" TargetName="IconForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseHoverForegroundFillKey}}"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay1" Value="Visible"/>
								<Setter Property="Visibility" TargetName="Overlay2" Value="Visible"/>
								<Setter Property="Background" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBorderDarkFillKey}}"/>
								<Setter Property="Background" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBorderLightFillKey}}"/>
								<Setter Property="Background" TargetName="Center" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedCenterFillKey}}"/>
								<Setter Property="Background" TargetName="Overlay1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonPressedBottomOverlayFillKey}}"/>
								<Setter Property="Fill" TargetName="IconForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}"/>
								<Setter Property="Fill" TargetName="IconBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalBackgroundFillKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>


		<!-- Styles -->

		<!-- Templates Start -->

		<ControlTemplate TargetType="{x:Type ButtonBase}" x:Key="RibbonButtonToolTemplate">
			<igRibbon:RibbonButtonChrome x:Name="chrome" IsPressed="{TemplateBinding IsPressed}" IsChecked="{TemplateBinding ToggleButton.IsChecked}" SnapsToDevicePixels="True">
				<!-- JM BR27007 10-3-07 -->
				<!--<Grid Margin="1" x:Name="chromeContentPanel" >-->
				<Grid Margin="1" x:Name="chromeContentPanel" HorizontalAlignment="{Binding HorizontalContentAlignment, RelativeSource={x:Static RelativeSource.TemplatedParent}}">
					<Grid.RowDefinitions>
						<RowDefinition Height="*" x:Name="row0"/>
						<RowDefinition Height="Auto" x:Name="row1" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto" />
						<ColumnDefinition Width="Auto" />
					</Grid.ColumnDefinitions>

					<igWindows:AutoDisabledImage Width="16" Height="16" x:Name="image"
					igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
					igWindows:Utilities.SnapElementToDevicePixels="True"
				Visibility="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"
				Source="{TemplateBinding igRibbon:ButtonTool.ImageResolved}" HorizontalAlignment="Left"
				/>
					<ContentPresenter x:Name="textSmall" Grid.Column="1"
					Content="{TemplateBinding igRibbon:ButtonTool.Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}"
					SnapsToDevicePixels="True"
					VerticalAlignment="Center"
					TextBlock.TextAlignment="Left"
					igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"
					Margin="3,0,2,1" HorizontalAlignment="Left"/>
					<igRibbon:LargeToolCaptionPresenter x:Name="textLarge" Grid.Row="2"
					Text="{TemplateBinding igRibbon:ButtonTool.Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}" Visibility="Collapsed" HorizontalAlignment="Left" />
				</Grid>
			</igRibbon:RibbonButtonChrome>

			<ControlTemplate.Triggers>

				<Trigger Property="ToggleButton.IsChecked" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
				</Trigger>

				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
				</Trigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="igRibbon:ButtonTool.SizingMode" Value="ImageOnly" />
						<Condition Property="igRibbon:ButtonTool.HasImage" Value="True" />
					</MultiTrigger.Conditions>
					<Setter TargetName="textSmall" Property="Visibility" Value="Collapsed"/>
				</MultiTrigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="igRibbon:ButtonTool.SizingMode" Value="ImageAndTextLarge" />
						<Condition Property="igRibbon:XamRibbon.Location" Value="Ribbon" />
					</MultiTrigger.Conditions>
					<Setter TargetName="textSmall" Property="Visibility" Value="Collapsed"/>
					<Setter TargetName="textLarge" Property="Visibility" Value="Visible"/>
					<Setter TargetName="image" Property="Width" Value="50"/>
					<Setter TargetName="image" Property="Height" Value="50"/>
					<Setter TargetName="image" Property="Margin" Value="0,0,0,2"/>
					<Setter TargetName="row0" Property="Height" Value="Auto"/>
					<Setter TargetName="row1" Property="Height" Value="*"/>
					<Setter TargetName="chromeContentPanel" Property="Margin" Value="1,1,5,0"/>
				</MultiTrigger>

				<Trigger Property="igRibbon:XamRibbon.Location" Value="Ribbon">
					<Setter Property="HorizontalAlignment" Value="Left"/>
				</Trigger>

				<Trigger Property="igRibbon:XamRibbon.Location" Value="QuickAccessToolbar">
					<Setter Property="Margin" Value="0,-2,0,0"/>
					<Setter TargetName="chrome" Property="Padding" Value="0,2,0,0"/>
				</Trigger>

				<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
				<Trigger Property="igRibbon:XamRibbon.Location" Value="ApplicationMenuFooterToolbar">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
					<Setter Property="Margin" Value="6,0,0,0"/>
				</Trigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<!-- AS 2/22/08 BR30647 - Added parens around path -->
						<Condition Binding="{Binding (igRibbon:XamRibbon.Location), RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="False" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
					</MultiDataTrigger.Conditions>
					<Setter TargetName="textSmall" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}" />
					<Setter TargetName="textLarge" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}" />
				</MultiDataTrigger>

				<Trigger Property="igRibbon:XamRibbon.HideAccessKey" Value="False">
					<Setter TargetName="textSmall" Property="RecognizesAccessKey" Value="True"/>
					<Setter TargetName="textSmall" Property="Content" Value="{Binding (igRibbon:ButtonTool.Caption), RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
				</Trigger>

				<Trigger Property="IsEnabled" Value="False">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
				</Trigger>
			</ControlTemplate.Triggers>
		</ControlTemplate>

		<ControlTemplate TargetType="{x:Type ButtonBase}" x:Key="RibbonButtonToolTemplate1">
			<igRibbon:RibbonButtonChrome x:Name="chrome" IsPressed="{TemplateBinding IsPressed}" IsChecked="{TemplateBinding ToggleButton.IsChecked}" SnapsToDevicePixels="True">
				<!-- JM BR27007 10-3-07 -->
				<!--<Grid Margin="1" x:Name="chromeContentPanel" >-->
				<Grid Margin="1" x:Name="chromeContentPanel" HorizontalAlignment="{Binding HorizontalContentAlignment, RelativeSource={x:Static RelativeSource.TemplatedParent}}">
					<Grid.RowDefinitions>
						<RowDefinition Height="*" x:Name="row0"/>
						<RowDefinition Height="Auto" x:Name="row1" />
						<RowDefinition Height="Auto" />
					</Grid.RowDefinitions>
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="Auto" />
						<ColumnDefinition Width="Auto" />
					</Grid.ColumnDefinitions>

					<igWindows:AutoDisabledImage Width="50" Height="50" x:Name="image"
					igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
					igWindows:Utilities.SnapElementToDevicePixels="True"
				Visibility="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"
				Source="{TemplateBinding igRibbon:ButtonTool.ImageResolved}"
				/>
					<ContentPresenter x:Name="textSmall" Grid.Column="1"
					Content="{TemplateBinding igRibbon:ButtonTool.Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}"
					SnapsToDevicePixels="True"
					VerticalAlignment="Center"
					TextBlock.TextAlignment="Left"
					igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"
					Margin="3,0,2,1"/>
					<igRibbon:LargeToolCaptionPresenter x:Name="textLarge" Grid.Row="2"
					Text="{TemplateBinding igRibbon:ButtonTool.Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}" Visibility="Collapsed" />
				</Grid>
			</igRibbon:RibbonButtonChrome>

			<ControlTemplate.Triggers>

				<Trigger Property="ToggleButton.IsChecked" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
				</Trigger>

				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
				</Trigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="igRibbon:ButtonTool.SizingMode" Value="ImageOnly" />
						<Condition Property="igRibbon:ButtonTool.HasImage" Value="True" />
					</MultiTrigger.Conditions>
					<Setter TargetName="textSmall" Property="Visibility" Value="Collapsed"/>
				</MultiTrigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="igRibbon:ButtonTool.SizingMode" Value="ImageAndTextLarge" />
						<Condition Property="igRibbon:XamRibbon.Location" Value="Ribbon" />
					</MultiTrigger.Conditions>
					<Setter TargetName="textSmall" Property="Visibility" Value="Collapsed"/>
					<Setter TargetName="textLarge" Property="Visibility" Value="Visible"/>
					<Setter TargetName="image" Property="Width" Value="50"/>
					<Setter TargetName="image" Property="Height" Value="50"/>
					<Setter TargetName="image" Property="Margin" Value="0,0,0,2"/>
					<Setter TargetName="row0" Property="Height" Value="Auto"/>
					<Setter TargetName="row1" Property="Height" Value="*"/>
					<Setter TargetName="chromeContentPanel" Property="Margin" Value="1,1,5,0"/>
				</MultiTrigger>

				<Trigger Property="igRibbon:XamRibbon.Location" Value="Ribbon">
					<Setter Property="HorizontalAlignment" Value="Left"/>
				</Trigger>

				<Trigger Property="igRibbon:XamRibbon.Location" Value="QuickAccessToolbar">
					<Setter Property="Margin" Value="0,-2,0,0"/>
					<Setter TargetName="chrome" Property="Padding" Value="0,2,0,0"/>
				</Trigger>

				<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
				<Trigger Property="igRibbon:XamRibbon.Location" Value="ApplicationMenuFooterToolbar">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
					<Setter Property="Margin" Value="6,0,0,0"/>
				</Trigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<!-- AS 2/22/08 BR30647 - Added parens around path -->
						<Condition Binding="{Binding (igRibbon:XamRibbon.Location), RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="False" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
					</MultiDataTrigger.Conditions>
					<Setter TargetName="textSmall" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}" />
					<Setter TargetName="textLarge" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}" />
				</MultiDataTrigger>

				<Trigger Property="igRibbon:XamRibbon.HideAccessKey" Value="False">
					<Setter TargetName="textSmall" Property="RecognizesAccessKey" Value="True"/>
					<Setter TargetName="textSmall" Property="Content" Value="{Binding (igRibbon:ButtonTool.Caption), RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
				</Trigger>

				<Trigger Property="IsEnabled" Value="False">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
				</Trigger>
			</ControlTemplate.Triggers>
		</ControlTemplate>

		<!-- AS 7/13/09 TFS18489 
		Changed all properties that were using a FindAncestor to the RibbonWindowContentHost to use a new inherited property 
		since the findancestor is asynchronous and causes the initial measure to have the wrong value and therefore get another 
		measure/arrange when the ancestor binding is updated.
	-->
		<ControlTemplate TargetType="{x:Type Control}" x:Key="CaptionButtonAreaTemplate">
			<StackPanel  Background="{DynamicResource MenuBackgroundGradient}"
			x:Name="captionButtonPanel" 
			MinHeight="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).MinCaptionHeight, RelativeSource={RelativeSource TemplatedParent}}" 
			Margin="1,1,1,0" Orientation="Horizontal" >

				<Button x:Name="XamRibbonCaptionButton_Left" Focusable="False" Style="{StaticResource XamRibbonCaptionButton_Left}"
					Width="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonWidth, RelativeSource={RelativeSource TemplatedParent}}" 
					Height="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonHeight, RelativeSource={RelativeSource TemplatedParent}}"
					Command="igRibbon:RibbonWindowCommands.MinimizeCommand" 
					CommandTarget="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"/>

				<Button x:Name="XamRibbonCaptionButton_Middle" Focusable="False" Style="{StaticResource XamRibbonCaptionButton_Middle}"
					Width="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonWidth, RelativeSource={RelativeSource TemplatedParent}}" 
					Height="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonHeight, RelativeSource={RelativeSource TemplatedParent}}"
					Command="igRibbon:RibbonWindowCommands.MaximizeCommand" 
					CommandTarget="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"/>

				<Button x:Name="XamRibbonCaptionButton_Right" Focusable="False" Style="{StaticResource XamRibbonCaptionButton_Right}"
					Width="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonWidth, RelativeSource={RelativeSource TemplatedParent}}" 
					Height="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonHeight, RelativeSource={RelativeSource TemplatedParent}}"
					Command="igRibbon:RibbonWindowCommands.CloseCommand" 
					CommandTarget="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}"/>

			</StackPanel>
			<ControlTemplate.Triggers>
				<!-- Trigger that will hide the left two caption buttons when the ResizeMode of the window is NoResize-->
				<DataTrigger Binding="{Binding ResizeMode, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="NoResize">
					<Setter TargetName="XamRibbonCaptionButton_Left" Property="Visibility" Value="Collapsed" />
					<Setter TargetName="XamRibbonCaptionButton_Middle" Property="Visibility" Value="Collapsed" />
				</DataTrigger>

				<!-- The CaptionButtonAreaWidth is really only used when glass is active. for all other cases we can 
					 let the panel determine the width based on the buttons within. Otherwise this property must 
					 also make the same check as above for when the caption buttons would be hidden-->
				<DataTrigger Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True">
					<Setter TargetName="captionButtonPanel" Property="Width" Value="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).CaptionButtonAreaWidth, RelativeSource={RelativeSource TemplatedParent}}" />
				</DataTrigger>

				<!-- Trigger that will change the command of the middle button to restore a maximized window -->
				<DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized">
					<Setter TargetName="XamRibbonCaptionButton_Middle" Property="Command" Value="igRibbon:RibbonWindowCommands.RestoreCommand" />
				</DataTrigger>

				<!-- JJD 05/17/10 - NA 2010 Volume 2 - Scenic Ribbon support-->
				<DataTrigger Binding="{Binding (igRibbon:XamRibbon.IsScenicTheme), RelativeSource={x:Static RelativeSource.TemplatedParent}}" Value="True">
					<Setter TargetName="XamRibbonCaptionButton_Left" Property="Style" Value="{DynamicResource {x:Static igRibbon:RibbonWindowContentHost.ScenicMinimizeButtonStyleKey}}" />
					<Setter TargetName="XamRibbonCaptionButton_Middle" Property="Style" Value="{DynamicResource {x:Static igRibbon:RibbonWindowContentHost.ScenicMaximizeRestoreButtonStyleKey}}" />
					<Setter TargetName="XamRibbonCaptionButton_Right" Property="Style" Value="{DynamicResource {x:Static igRibbon:RibbonWindowContentHost.ScenicCloseWindowButtonStyleKey}}" />
					<Setter TargetName="captionButtonPanel" Property="Margin" Value="1,4,5,0"/>
				</DataTrigger>

				<!--<Trigger SourceName="MiddleCaptionButton" Property="IsPressed" Value="True">
							<Setter Property="Fill" TargetName="MaximizeBackground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalBackgroundFillKey}}"/>
							<Setter Property="Fill" TargetName="MaximizeForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamRibbonCaptionButtonIconMaxCloseNormalForegroundFillKey}}"/>
						</Trigger>-->
			</ControlTemplate.Triggers>
		</ControlTemplate>

		<!-- Templates End -->

		<!-- =================================================================== -->
		<!-- XamRibbonWindow Style -->
		<!-- =================================================================== -->
		<!-- AS 6/3/08 BR32772 - Moved to the XamRibbonWindow static ctor or else the xaml cannot be used in xbap.
	<Style TargetType="{x:Type igRibbon:XamRibbonWindow}">
	<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}"/>
	<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.WindowBackgroundBrushKey}}"/>
	<Setter Property="BorderThickness" Value="0,0,0,0"/>
	<Setter Property="BorderBrush" Value="Transparent"/>
	<Setter Property="MinWidth" Value="255"/>
	<Setter Property="Template">
	  <Setter.Value>
		<ControlTemplate TargetType="{x:Type igRibbon:XamRibbonWindow}">
		  <Grid>
			<AdornerDecorator>
			  <ContentPresenter/>
			</AdornerDecorator>


			<ResizeGrip x:Name="WindowResizeGrip"
						Visibility="Collapsed"
						Style="{DynamicResource {x:Static igRibbon:XamRibbonWindow.ResizeGripStyleKey}}"
						HorizontalAlignment="Right"
						VerticalAlignment="Bottom"
						IsTabStop="False"
						/>
		  </Grid>
		  <ControlTemplate.Triggers>
			<MultiTrigger>
			  <MultiTrigger.Conditions>
				<Condition Property="ResizeMode" Value="CanResizeWithGrip" />
				<Condition Property="WindowState" Value="Normal" />
			  </MultiTrigger.Conditions>
			  <Setter Property="Visibility" TargetName="WindowResizeGrip" Value="Visible" />
			</MultiTrigger>
		  </ControlTemplate.Triggers>
		</ControlTemplate>
	  </Setter.Value>
	</Setter>
  </Style>-->

		<!-- =================================================================== -->
		<!-- ScenicRibbonCaptionArea Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ScenicRibbonCaptionArea}">
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="BorderThickness" Value="0,0,0,1"/>
			<Setter Property="MinHeight" Value="30"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:ScenicRibbonCaptionArea}">
						<Grid>
							<Border x:Name="Main" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="3,3,0,0" />
							<Border BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"/>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsWithinRibbonWindow" Value="False">
								<Setter TargetName="Main" Property="Margin" Value="0"/>
							</Trigger>
							<Trigger Property="RoundCorners" Value="False">
								<Setter TargetName="Main" Property="CornerRadius" Value="0"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False">
					<Setter Property="BorderBrush" Value="{StaticResource {x:Static igRibbon:RibbonBrushKeys.ScenicCaptionAreaInactiveBorderKey}}"/>
				</DataTrigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- RibbonWindowContentHost Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:RibbonWindowContentHost}">
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="BorderThickness" Value="0,0,0,0"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
		</Style>

		<!-- =================================================================== -->
		<!-- XamRibbon Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:XamRibbon}" x:Name="XamRibbonStyle2">
			<Setter Property="FontSize" Value="11"/>
			<Setter Property="FontFamily" Value="Arial"/>
			<!-- AS 11/6/07 BR28165 
		Do not stretch by default. Doing so when the ribbon is in a panel like a grid will 
		cause it to vertically fill and not use its preferred size information -->
			<Setter Property="VerticalAlignment" Value="Top" />

		</Style>

		<!-- =================================================================== -->
		<!-- ApplicationMenu Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ApplicationMenu}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:ApplicationMenu}">
						<ContentPresenter x:Name="PART_MenuToolPresenterSite"/>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- MenuTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:MenuTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:MenuTool}">
						<ContentPresenter x:Name="PART_MenuToolPresenterSite"/>
						<ControlTemplate.Triggers>
							<Trigger Property="Location" Value="Ribbon">
								<Setter Property="HorizontalAlignment" Value="Stretch"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="Location" Value="ApplicationMenu">
					<Setter Property="UseLargeImages" Value="True" />
				</Trigger>

				<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
				<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
					<Setter Property="Margin" Value="6,0,0,0"/>
				</Trigger>
			</Style.Triggers>
		</Style>


		<Style x:Key="ToolMenuItemDescription_ContentPresenter" TargetType="{x:Type ContentPresenter}">
			<Style.Resources>
				<DataTemplate DataType="{x:Type sys:String}">
					<TextBlock TextWrapping="Wrap" TextAlignment="Left"  Text="{Binding}" />
				</DataTemplate>
			</Style.Resources>
		</Style>

		<!-- JJD 12/4/07 - BR28873 -->
		<!-- Added Border style for menu item icon area background -->
		<Style x:Key="MenuItem_IconAreaBackground" TargetType="{x:Type Border}">
			<Setter Property="SnapsToDevicePixels" Value="True"/>
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}"/>
			<Setter Property="BorderThickness" Value="0,0,1,0"/>
		</Style>

		<!-- =================================================================== -->
		<!-- SubmenuItem Template (used for NON-menu tools inside a menu)        -->
		<!-- =================================================================== -->
		<ControlTemplate x:Key="{x:Static igRibbon:MenuToolBase.SubmenuItemTemplateKey}"
		TargetType="{x:Type igRibbon:ToolMenuItem}">
			<Grid Margin="0,0,0,0">
				<Grid x:Name="ApplicationMenuItem_Hover" Height="Auto" Width="Auto" Visibility="Collapsed">
					<Rectangle SnapsToDevicePixels="True" x:Name="BorderDark" Width="Auto" Height="Auto" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ApplicationMenuSideSelectBorderFillKey}}" RadiusX="3" RadiusY="3"/>
					<Border SnapsToDevicePixels="True" Margin="1,1,1,1" x:Name="BorderLight_CenterFill" Width="Auto" Height="Auto" Background="{DynamicResource MenuBackgroundGradient}" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ApplicationMenuSideSelectBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="2,2,2,2"/>
				</Grid>
				<Grid x:Name="MenuItem_Hover" Height="Auto" Width="Auto" Visibility="Collapsed">
					<Border SnapsToDevicePixels="True" x:Name="BorderDark1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuHottrackCenterFillKey}}" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuHottrackBorderDarkFillKey}}" CornerRadius="3" BorderThickness="1" >
						<Rectangle SnapsToDevicePixels="True" x:Name="BorderLight_CenterFill1" Stroke="{DynamicResource MenuBackgroundGradient}" RadiusX="1" RadiusY="1" StrokeThickness="1"/>
					</Border>
				</Grid>
				<Border  x:Name="Bd"
				Background="Transparent"
				BorderThickness="{TemplateBinding BorderThickness}"
				BorderBrush="{TemplateBinding BorderBrush}"
				SnapsToDevicePixels="true">
					<Grid>
						<Grid.ColumnDefinitions>
							<ColumnDefinition MinWidth="17" Width="Auto" x:Name="iconColumn"  SharedSizeGroup="MenuItemIconColumnGroup" />
							<ColumnDefinition Width="*" />
							<ColumnDefinition Width="Auto" SharedSizeGroup="MenuItemIGTColumnGroup" />
							<ColumnDefinition Width="14" />
						</Grid.ColumnDefinitions>

						<!-- JJD 12/4/07 - BR28873 -->
						<!-- Added icon area background element-->
						<Border x:Name="IconAreaBackground" Style="{StaticResource MenuItem_IconAreaBackground}" Background="{DynamicResource MenuBackgroundGradient}"/>

						<!-- OrangeBox for IsChecked -->
						<Border x:Name="OrangeCheckBox"
						SnapsToDevicePixels="True"
						BorderThickness="1" 
						CornerRadius="1"
						HorizontalAlignment="Center"
						VerticalAlignment="Center" 
						Margin="2,2,3,2">
							<!--Margin="2">-->

							<igWindows:CardPanel>
								<!-- Small check mark -->
								<Grid x:Name="GlyphPanel" Visibility="Collapsed" FlowDirection="LeftToRight" 
							  Background="Transparent" HorizontalAlignment="Center" 
								VerticalAlignment="Center" Width="16" Height="16" igRibbon:XamRibbon.KeyTipPlacementType="CheckIndicator">
									<Path
									Margin="4.946,2.008,0,0"
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Height="11.069"
									Width="7.026"
									Stretch="Fill"
									Opacity="1"
									Data="M 27.9883975982666,68.03516387939453 C27.9883975982666,68.03516387939453 30.490787506103516,72.08806610107422 30.490787506103516,72.08806610107422 30.490787506103516,72.08806610107422 35.01433563232422,61.019805908203125 35.01433563232422,61.019805908203125 "
									Stroke="Transparent"
									StrokeThickness="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" />
									<Path
									Margin="3.946,2.393,0,0"
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Height="10.684"
									Width="8.459"
									Stretch="Fill"
									Opacity="1"
									Data="M 26.9883975982666,67.03516387939453 C26.9883975982666,67.03516387939453 30.490787506103516,72.08806610107422 30.490787506103516,72.08806610107422 30.490787506103516,72.08806610107422 35.44744110107422,61.404788970947266 35.44744110107422,61.404788970947266 "
									Stroke="Transparent"
									StrokeThickness="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" />
									<Path
									Margin="4.946,2.008,0,0"
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Height="9.069" 
									Width="6.026"
									Stretch="Fill"
									Opacity="1"
									Data="M 27.9883975982666,68.03516387939453 C27.9883975982666,68.03516387939453 30.490787506103516,70.08806610107422 30.490787506103516,70.08806610107422 30.490787506103516,70.08806610107422 34.01433563232422,61.019805908203125 34.01433563232422,61.019805908203125 "
									Stroke="Transparent"
									StrokeThickness="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" />
									<Path
									Margin="4.946,2.393,0,0"
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Height="10.684"
									Width="7.459"
									Stretch="Fill"
									Opacity="1"
									Data="M 27.9883975982666,67.03516387939453 C27.9883975982666,67.03516387939453 30.490787506103516,72.08806610107422 30.490787506103516,72.08806610107422 30.490787506103516,72.08806610107422 35.44744110107422,61.404788970947266 35.44744110107422,61.404788970947266 "
									Stroke="Transparent"
									StrokeThickness="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" />
									<Path
									Margin="4.75,2.24,0,0"
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Height="9.862"
									Width="6.785"
									Stretch="Fill"
									Opacity="1"
									Data="M27.561812,66.880152 C27.561812,66.880152 30.275803,71.118003 30.275803,71.118003 30.275803,71.118003 34.457825,61.276845 34.457825,61.276845"
									Stroke="Transparent"
									StrokeThickness="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" />
									<Path
									HorizontalAlignment="Left"
									VerticalAlignment="Top"
									Height="9.899"
									Width="6.908"
									Stretch="Fill"
									Opacity="1"
									Data="M27.616231,66.205115 C27.616231,66.205115 30.445511,71.297952 30.445511,71.297952 30.445511,71.297952 34.499006,61.29204 34.499006,61.29204"
									Stroke="Transparent"
									StrokeThickness="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" Margin="4.627,2.363,0,0" />
								</Grid>


								<!-- Big check mark -->
								<Grid
								FlowDirection="LeftToRight" 
								x:Name="GlyphPanel32"
								Height="32"
								Width="32"
								Background="{x:Null}"
								HorizontalAlignment="Center"
								VerticalAlignment="Center"
								Visibility="Collapsed"
								igRibbon:XamRibbon.KeyTipPlacementType="CheckIndicator">
									<Path
									Margin="0,0,0,0"
									HorizontalAlignment="Center"
									VerticalAlignment="Center"
									Height="18"
									Width="13"
									Stretch="Fill"
									Opacity="1"
									Data="M 59,344 C59,344 63,353 63,353 63,353 72,335 72,335 "
									Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckMarkStrokeFillKey}}"
									StrokeThickness="2" SnapsToDevicePixels="True" />
									<Path
									Margin="0,0,0,0"
									HorizontalAlignment="Center"
									VerticalAlignment="Center"
									Height="18"
									Width="13.272"
									Stretch="Fill"
									Opacity="1"
									Data="M59,344 C59,344 63.32169,353 63.32169,353 63.32169,353 72.32169,335 72.32169,335"
									Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckMarkStrokeFillKey}}"
									StrokeThickness="2" SnapsToDevicePixels="True" />
								</Grid>

								<!-- icon -->
								<ContentPresenter x:Name="Icon" Width="16" Height="16" 
								igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
								HorizontalAlignment="Left"
								VerticalAlignment="Center"
								ContentSource="Icon"
								SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
							</igWindows:CardPanel>
						</Border>

						<!-- content -->
						<Grid x:Name="ContentArea" Grid.Column="1" VerticalAlignment="Center" Margin="0,0,1,0">
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="*" x:Name="descriptionRow"/>
							</Grid.RowDefinitions>

							<!-- content -->
							<ContentPresenter
							x:Name="Content"
							ContentSource="Header"
							Margin="15,0,7,0"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Center"
							RecognizesAccessKey="true"
							SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>

							<!-- MenuItemDescription -->
							<!--<TextBlock MaxWidth="{Binding ElementName=Content, Path=ActualWidth}" TextAlignment="Left" x:Name="MenuItemDescription"  Grid.Row="1" Margin="6,0,6,1" Text="{TemplateBinding igRibbon:MenuToolBase.MenuItemDescription}" TextWrapping="Wrap"/>-->
							<!--<igWindows:CardPanel Grid.Row="1" >
			  <igWindows:CardPanel.Resources>
				<DataTemplate DataType="{x:Type sys:String}">
				  <TextBlock TextWrapping="Wrap" TextAlignment="Left"  Text="{Binding}" />
				</DataTemplate>
			  </igWindows:CardPanel.Resources>
			  <ContentPresenter MaxWidth="{Binding ElementName=Content, Path=ActualWidth}" x:Name="MenuItemDescription"  Margin="6,0,6,1" Content="{TemplateBinding igRibbon:MenuToolBase.MenuItemDescription}"/>
			</igWindows:CardPanel>-->
							<ContentPresenter Style="{StaticResource ToolMenuItemDescription_ContentPresenter}" Grid.Row="1" MaxWidth="{Binding ActualWidth, ElementName=Content}" x:Name="MenuItemDescription"  Margin="6,0,6,1" Content="{TemplateBinding igRibbon:MenuToolBase.MenuItemDescription}"/>
						</Grid>


						<!-- InputGestureText -->
						<TextBlock
						x:Name="InputGestureText"
						VerticalAlignment="Center"
						Grid.Column="2"
						Text="{TemplateBinding InputGestureText}"
						Margin="0,0,0,0"
						DockPanel.Dock="Right" />


					</Grid>
				</Border>
			</Grid>
			<ControlTemplate.Triggers>

				<Trigger Property="IsEnabled" Value="false">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}" />
				</Trigger>

				<Trigger Property="UseLargeImage" Value="False">
					<Setter TargetName="Content" Property="Margin" Value="7,3,7,4"/>
					<!-- JJD 12/4/07 - BR28873 -->
					<!--<Setter TargetName="OrangeCheckBox" Property="Margin" Value="2,1,1,1"/>-->
					<Setter TargetName="Icon" Property="Margin" Value="2,0,0,0"/>
				</Trigger>

				<Trigger Property="UseLargeImage" Value="True">
					<Setter TargetName="Content" Property="Margin" Value="4,0,0,1"/>
					<Setter TargetName="Icon" Property="Width" Value="32" />
					<Setter TargetName="Icon" Property="Height" Value="32" />
					<Setter TargetName="Icon" Property="Margin" Value="1" />
					<!-- JJD 12/4/07 - BR28873 -->
					<!-- Added icon area background element which needs to be hidden when we are showing LargeImages-->
					<Setter TargetName="IconAreaBackground" Property="Visibility" Value="Collapsed"/>
				</Trigger>

				<!-- JJD 12/4/07 - BR28873 -->
				<!-- Added icon area background element which needs to be hidden when we are in the recent items area -->
				<Trigger Property="igRibbon:XamRibbon.Location" Value="ApplicationMenuRecentItems">
					<Setter TargetName="IconAreaBackground" Property="Visibility" Value="Collapsed"/>
				</Trigger>

				<Trigger Property="igRibbon:XamRibbon.Location" Value="ApplicationMenu">
					<Setter TargetName="OrangeCheckBox" Property="Margin" Value="4"/>
					<Setter TargetName="Icon" Property="Margin" Value="1,1,1,1"/>
				</Trigger>

				<Trigger Property="IsHighlighted" Value="True">
					<Setter TargetName="Bd" Property="Background" Value="Transparent" />
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
					<!-- JJD 12/4/07 - BR28873 -->
					<!-- Added icon area background element which needs to be hidden when we are highlighted-->
					<Setter TargetName="IconAreaBackground" Property="Visibility" Value="Collapsed"/>
				</Trigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsHighlighted" Value="True"/>
						<Condition Property="UseLargeImage" Value="True"/>
					</MultiTrigger.Conditions>
					<Setter TargetName="ApplicationMenuItem_Hover" Property="Visibility" Value="Visible"/>
				</MultiTrigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsHighlighted" Value="True"/>
						<Condition Property="UseLargeImage" Value="False"/>
					</MultiTrigger.Conditions>
					<Setter TargetName="MenuItem_Hover" Property="Visibility" Value="Visible"/>
				</MultiTrigger>


				<!--========================== IsChecked Triggers ==========================-->

				<Trigger Property="IsChecked" Value="True">
					<Setter TargetName="OrangeCheckBox" Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.IsCheckedBoxCenterFillKey}}" />
					<Setter TargetName="OrangeCheckBox" Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.IsCheckedBoxBorderFillKey}}" />
					<Setter TargetName="Bd" Property="Background" Value="Transparent" />
				</Trigger>

				<Trigger Property="Icon" Value="{x:Null}">
					<Setter Property="Visibility" TargetName="Icon" Value="Hidden"/>
				</Trigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="Icon" Value="{x:Null}"/>
						<Condition Property="IsChecked" Value="True"/>
						<Condition Property="UseLargeImage" Value="False"/>
					</MultiTrigger.Conditions>
					<Setter Property="Visibility" TargetName="GlyphPanel" Value="Visible"/>
				</MultiTrigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="Icon" Value="{x:Null}"/>
						<Condition Property="IsChecked" Value="True"/>
						<Condition Property="UseLargeImage" Value="True"/>
					</MultiTrigger.Conditions>
					<Setter Property="Visibility" TargetName="GlyphPanel32" Value="Visible"/>
				</MultiTrigger>

				<!-- END  IsChecked Triggers ==========================-->

				<Trigger Property="igRibbon:MenuToolBase.HasMenuItemDescription" Value="False">
					<Setter TargetName="descriptionRow" Property="Height" Value="0"/>
				</Trigger>

				<Trigger Property="igRibbon:MenuToolBase.HasMenuItemDescription" Value="True">
					<Setter TargetName="Content" Property="TextBlock.FontWeight" Value="Bold"/>
					<Setter TargetName="Content" Property="Margin" Value="6,4,0,1"/>
					<Setter TargetName="Content" Property="MinWidth" Value="{Binding MenuItemDescriptionMinWidth, RelativeSource={RelativeSource TemplatedParent}}"/>
					<Setter TargetName="MenuItemDescription" Property="Margin" Value="6,0,6,4"/>
				</Trigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="Icon" Value="{x:Null}"/>
						<Condition Property="IsCheckable" Value="False"/>
						<Condition Property="Location" Value="ApplicationMenuRecentItems"/>
					</MultiTrigger.Conditions>
					<Setter Property="Visibility" TargetName="OrangeCheckBox" Value="Collapsed"/>
					<Setter Property="SharedSizeGroup" TargetName="iconColumn" Value="{x:Null}"/>
					<Setter Property="MinWidth" TargetName="iconColumn" Value="0"/>
				</MultiTrigger>

				<!-- JJD 12/4/07 - BR28873 -->
				<!-- If IsSeparator is true collapse the Icon and InputGestureText and set the columnspan of the 
		   content area to 3 -->
				<Trigger Property="IsSeparator" Value="True">
					<Setter Property="Grid.ColumnSpan" TargetName="ContentArea" Value="3"/>
					<Setter Property="Visibility" TargetName="InputGestureText" Value="Collapsed"/>
					<Setter Property="Margin" TargetName="OrangeCheckBox" Value="2,0,3,0"/>
					<Setter Property="Visibility" TargetName="Icon" Value="Hidden"/>
					<Setter Property="Height" TargetName="Icon" Value="1"/>
					<Setter Property="Margin" TargetName="Content" Value="5,0,0,0"/>
					<Setter Property="Margin" TargetName="ContentArea" Value="0"/>
					<!-- AS 12/4/09 TFS25258 -->
					<Setter Property="IsHitTestVisible" Value="False"/>
				</Trigger>

				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsSeparator" Value="True"/>
						<Condition Property="UseLargeImage" Value="True"/>
					</MultiTrigger.Conditions>
					<Setter Property="Margin" TargetName="Content" Value="2,0,0,0"/>
				</MultiTrigger>

			</ControlTemplate.Triggers>
		</ControlTemplate>


		<!-- =================================================================== -->
		<!-- SubmenuHeader Template (used for menu tools inside another menu)    -->
		<!-- =================================================================== -->

		<!-- =================================================================== -->
		<!-- ToolMenuItem Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ToolMenuItem}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="TextBlock.TextAlignment" Value="Left" />
			<!-- AS 1/7/08 BR29445
				 This issue has manifested itself in several different ways. Basically, the following two bindings end
				 up leading to null reference exceptions within the wpf framework when the Style property is changed. The
				 Style property is changed when we encounter a menu item that represents a tool that should be embedded.
				 When WPF is unhooking the old style, they're making assumptions that they initialized certain variables - 
				 they even assert for it - but they don't do null checks so in a release version it ends up resulting in
				 a null reference exception. There doesn't seem to be any way for us to force them to update this internal
				 state so the best we can do is to remove the setters that they are evaluating that cause them to create
				 the null reference exception. The following two find ancestor bindings are leading to that here.
				 
		<Setter Property="Control.HorizontalContentAlignment">
			<Setter.Value>
				<Binding Path="HorizontalContentAlignment" RelativeSource="{RelativeSource AncestorLevel=1, Mode=FindAncestor, AncestorType=ItemsControl}" />
			</Setter.Value>
		</Setter>
		<Setter Property="Control.VerticalContentAlignment">
			<Setter.Value>
				<Binding Path="VerticalContentAlignment" RelativeSource="{RelativeSource AncestorLevel=1, Mode=FindAncestor, AncestorType=ItemsControl}" />
			</Setter.Value>
		</Setter>-->
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
			<Setter Property="Template" Value ="{DynamicResource {x:Static igRibbon:MenuToolBase.SubmenuItemTemplateKey}}"/>
			<Style.Triggers>
				<Trigger Property="Role" Value="{x:Static MenuItemRole.TopLevelHeader}">
					<Setter Property="Margin">
						<Setter.Value>
							<Thickness>0,1,0,1</Thickness>
						</Setter.Value>
					</Setter>
					<Setter Property="Padding">
						<Setter.Value>
							<Thickness>6,3,6,3</Thickness>
						</Setter.Value>
					</Setter>
					<Setter Property="Template" Value="{DynamicResource {ComponentResourceKey ResourceId=TopLevelHeaderTemplateKey, TypeInTargetAssembly={x:Type MenuItem}}}"/>
				</Trigger>
				<Trigger Property="Role" Value="{x:Static MenuItemRole.SubmenuHeader}">
					<Setter Property="DockPanel.Dock" Value="{x:Static Dock.Top}"/>
					<Setter Property="Padding">
						<Setter.Value>
							<Thickness>0,2,0,2</Thickness>
						</Setter.Value>
					</Setter>
					<Setter Property="Template" Value ="{DynamicResource {x:Static igRibbon:MenuToolBase.SubmenuHeaderTemplateKey}}"/>
				</Trigger>
				<Trigger Property="Role" Value="{x:Static MenuItemRole.SubmenuItem}">
					<Setter Property="DockPanel.Dock" Value="{x:Static Dock.Top}"/>
					<Setter Property="Padding">
						<Setter.Value>
							<Thickness>0,2,0,2</Thickness>
						</Setter.Value>
					</Setter>
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- MenuToolPresenter Style -->
		<!-- =================================================================== -->


		<!-- =================================================================== -->
		<!-- ApplicationMenuPresenter Style -->
		<!-- =================================================================== -->


		<!-- =================================================================== -->
		<!-- ApplicationMenuFooterToolbar Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ApplicationMenuFooterToolbar}">
			<Setter Property="Margin" Value="0,0,0,0"/>
			<Setter Property="Padding" Value="0,0,0,0"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:ApplicationMenuFooterToolbar}">
						<Grid>
							<Border HorizontalAlignment="Stretch" Margin="0,1,0,1" VerticalAlignment="Stretch" Width="Auto" Height="Auto">
								<ItemsPresenter HorizontalAlignment="Right" VerticalAlignment="Center" Width="Auto" Height="Auto"/>
							</Border>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- ToolbarBase Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ToolbarBase}">
			<Setter Property="ItemsPanel">
				<Setter.Value>
					<ItemsPanelTemplate>
						<StackPanel Orientation="Horizontal" Background="{DynamicResource MenuBackgroundGradient}"/>
					</ItemsPanelTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:ToolbarBase}">
						<Border Background="{DynamicResource MenuBackgroundGradient}">
							<ItemsPresenter/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- QuickAccessToolbar Style -->
		<!-- =================================================================== -->



		<!-- =================================================================== -->
		<!-- QatPlaceholderTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:QatPlaceholderTool}">
			<Setter Property="Margin" Value="0,-1,0,1"/>
		</Style>



		<!-- =================================================================== -->
		<!-- RibbonGroup Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:RibbonGroup}">
			<!--<Setter Property="Background" Value="{StaticResource RibbonGroupBackground}"/>
<Setter Property="BorderBrush" Value="{StaticResource RibbonGroupBorder}"/>
<Setter Property="BorderThickness" Value="1"/>
<Setter Property="Margin" Value="0,0,4,0"/>-->
			<Setter Property="SmallImage">
				<Setter.Value>
					<DrawingImage>
						<DrawingImage.Drawing>
							<DrawingGroup>
								<GeometryDrawing Brush="#00FFFFFF">
									<GeometryDrawing.Geometry>
										<RectangleGeometry Rect="0,0,11,11"/>
									</GeometryDrawing.Geometry>
								</GeometryDrawing>
								<DrawingGroup Opacity="0.67058823529411771">
									<GeometryDrawing Brush="#FFFFFFFF" Geometry="M1,1C1,1 10,1 10,1 10,1 10,10 10,10 10,10 1,10 1,10 1,10 1,1 1,1z M0,0C0,0 0,11 0,11 0,11 11,11 11,11 11,11 11,0 11,0 11,0 0,0 0,0z"/>
								</DrawingGroup>
								<DrawingGroup>
									<DrawingGroup.Transform>
										<MatrixTransform Matrix="1,0,0,1,3,3"/>
									</DrawingGroup.Transform>
									<GeometryDrawing Brush="#FFFFFFFF" Geometry="M5,0 C5,0 4.2857132,0 4.2857132,0 4.2857132,0 0,5 0,5 0,5 0.7142868,5 0.7142868,5 0.7142868,5 5,0 5,0 z"/>
								</DrawingGroup>
							</DrawingGroup>
						</DrawingImage.Drawing>
					</DrawingImage>
				</Setter.Value>
			</Setter>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:RibbonGroup}">
						<ControlTemplate.Resources>
							<!-- Fade-In Animations -->
							<Storyboard x:Key="RibbonGroup_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Center" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="BorderHover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="RibbonGroup_IsInContextual_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="IsInContextualCenter" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="BorderHover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="PART_Header_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Header_Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="InnerBorder_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="InnerBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="borderLight_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="borderLight" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<!-- Fade-Out Animations -->
							<Storyboard x:Key="RibbonGroup_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Center" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="BorderHover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="RibbonGroup_IsInContextual_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="IsInContextualCenter" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="BorderHover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="PART_Header_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Header_Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="InnerBorder_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="InnerBorder" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="borderLight_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="borderLight" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.5000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
						</ControlTemplate.Resources>
						<igWindows:CardPanel>
							<ContentControl x:Name="PART_RibbonGroupSite" Style="{StaticResource PlainContentControlStyle}" igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}" >
								<igWindows:CardPanel x:Name="groupPanel" Background="{DynamicResource MenuBackgroundGradient}">
									<Grid Opacity="0" x:Name="Center">
										<Border HorizontalAlignment="Stretch" Margin="1,1,2,2" VerticalAlignment="Stretch" Width="Auto" Height="Auto" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="2,2,2,2"/>
									</Grid>
									<Grid Opacity="0" x:Name="IsInContextualCenter">
										<Border HorizontalAlignment="Stretch" Margin="1,1,2,2" VerticalAlignment="Stretch" Width="Auto" Height="Auto" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="2,2,2,2"/>
									</Grid>
									<Border x:Name="borderLight" HorizontalAlignment="Stretch" Margin="1,1,0,0" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupNormalBorderLightFillKey}}" BorderThickness="1" CornerRadius="3" SnapsToDevicePixels="True"/>
									<Grid Margin="2,2,1,0" HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
										<DockPanel LastChildFill="True" KeyboardNavigation.TabNavigation="Local">
											<Grid Width="Auto" Height="Auto" DockPanel.Dock="Bottom" KeyboardNavigation.TabIndex="1" KeyboardNavigation.TabNavigation="Local">
												<Border x:Name="Header_Background"  Background="{DynamicResource MenuBackgroundGradient}" Margin="-1,0,1,2" HorizontalAlignment="Stretch" CornerRadius="0,0,2,2" SnapsToDevicePixels="True" />
												<Border x:Name="Header_Hover"  Background="{DynamicResource MenuBackgroundGradient}" Margin="-1,0,0,0" HorizontalAlignment="Stretch" CornerRadius="0,0,2,2" SnapsToDevicePixels="True" Opacity="0" />
												<DockPanel LastChildFill="True" d:IsHidden="True">
													<ContentControl x:Name="DialogBoxLauncher" Height="15" DockPanel.Dock="Right" Content="{TemplateBinding DialogBoxLauncherTool}" Visibility="Hidden" Focusable="False"/>
													<TextBlock x:Name="PART_Caption"
														Text="{TemplateBinding Caption}"
														Grid.Row="1"
														Margin="5,0,5,3"
														VerticalAlignment="Bottom"
														HorizontalAlignment="Stretch"
														TextTrimming="CharacterEllipsis"
														igWindows:ClippedTextToolTipService.ShowToolTipWhenClipped="True"
														igWindows:ClippedTextToolTipService.ToolTipStyleKey="{x:Static igRibbon:XamRibbon.ToolTipStyleKey}"
														TextAlignment="Center" Foreground="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCaptionTextFillKey}}"/>
												</DockPanel>
											</Grid>
											<ItemsPresenter x:Name="PART_Items" Margin="2,0,4,1" HorizontalAlignment="Center"
														KeyboardNavigation.TabIndex="0"
														KeyboardNavigation.TabNavigation="Local"
														SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
										</DockPanel>
									</Grid>
									<Border x:Name="InnerBorder" HorizontalAlignment="Stretch" Margin="1,1,2,2" BorderBrush="#FFFFFFFF" BorderThickness="1" CornerRadius="3" SnapsToDevicePixels="True" Opacity="0"/>
									<Border x:Name="borderDarkNormal" Margin="0,0,1,1" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupNormalBorderDarkFillKey}}" BorderThickness="1" CornerRadius="3" SnapsToDevicePixels="True" />
									<Grid x:Name="BorderHover" Opacity="0" SnapsToDevicePixels="True" >
										<Border x:Name="borderDarkHover" Margin="0,0,1,1" BorderBrush="{DynamicResource MenuBackgroundGradient}" BorderThickness="1" CornerRadius="3" SnapsToDevicePixels="True" />
									</Grid>
								</igWindows:CardPanel>
							</ContentControl>
							<igRibbon:DropDownToggle x:Name="PART_RibbonGroupButton"
										   igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"
										   IsDroppedDown="{Binding IsOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
										   Style="{DynamicResource {x:Static igRibbon:RibbonGroup.CollapsedGroupButtonStyleKey}}"
										   Visibility="Collapsed" />
							<!-- AS 9/23/09 TFS2236 - Added HandleMouseDownOnClose -->
							<Popup x:Name="PART_Popup"
								 AllowsTransparency="True"
							   StaysOpen="False"
								igWindows:PopupHelper.HandleMouseDownOnClose="True"
							   PlacementTarget="{Binding ElementName=PART_RibbonGroupButton}"
								 Placement="Bottom"
							   IsOpen="{Binding IsOpen, RelativeSource={RelativeSource TemplatedParent}}"/>
						</igWindows:CardPanel>
						<ControlTemplate.Triggers>
							<!-- AS 11/30/07 BR28788 -->
							<Trigger Property="IsOpen" Value="False">
								<Setter Property="PopupAnimation" TargetName="PART_Popup" Value="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"/>
							</Trigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<!-- JM BR28878 12-04-07 - Do not execute the trigger actions if we are at designtime -->
									<Condition Property="System_ComponentModel:DesignerProperties.IsInDesignMode" Value="False"/>
									<Condition Property="IsInContextualTabGroup" Value="True"/>
									<!-- AS BR33990 6/18/08 -->
									<!--<Condition Property="IsMouseOver" SourceName="groupPanel" Value="True"/>-->
									<!-- AS BR28885 12/5/07 - Added sourcename to only prevent highlight when something within the group has capture -->
									<!--<Condition Property="IsMouseCaptureWithin" SourceName="groupPanel" Value="False"/>-->
									<Condition Property="HighlightContent" Value="True"/>
								</MultiTrigger.Conditions>
								<MultiTrigger.EnterActions>
									<BeginStoryboard x:Name="RibbonGroup_IsInContextual_FadeIn_BeginStoryboard" Storyboard="{StaticResource RibbonGroup_IsInContextual_FadeIn}"/>
									<BeginStoryboard x:Name="PART_Header_IsInContextual_FadeIn_BeginStoryboard" Storyboard="{StaticResource PART_Header_FadeIn}"/>
									<BeginStoryboard x:Name="Contextual_InnerBorder_FadeIn_BeginStoryboard" Storyboard="{StaticResource InnerBorder_FadeIn}"/>
									<BeginStoryboard x:Name="Contextual_borderLight_FadeOut_BeginStoryboard" Storyboard="{StaticResource borderLight_FadeOut}"/>
								</MultiTrigger.EnterActions>
								<MultiTrigger.ExitActions>
									<StopStoryboard BeginStoryboardName="RibbonGroup_IsInContextual_FadeIn_BeginStoryboard"/>
									<StopStoryboard BeginStoryboardName="PART_Header_IsInContextual_FadeIn_BeginStoryboard"/>
									<BeginStoryboard x:Name="RibbonGroup_IsInContextual_FadeOut_BeginStoryboard" Storyboard="{StaticResource RibbonGroup_IsInContextual_FadeOut}"/>
									<BeginStoryboard x:Name="PART_Header_IsInContextual_FadeOut_BeginStoryboard" Storyboard="{StaticResource PART_Header_FadeOut}"/>
									<BeginStoryboard x:Name="Contextual_InnerBorder_FadeOut_BeginStoryboard" Storyboard="{StaticResource InnerBorder_FadeOut}"/>
									<BeginStoryboard x:Name="Contextual_borderLight_FadeIn_BeginStoryboard" Storyboard="{StaticResource borderLight_FadeIn}"/>
								</MultiTrigger.ExitActions>
							</MultiTrigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<!-- JM BR28878 12-04-07 - Do not execute the trigger actions if we are at designtime -->
									<Condition Property="System_ComponentModel:DesignerProperties.IsInDesignMode" Value="False"/>
									<Condition Property="IsInContextualTabGroup" Value="False"/>
									<!-- AS BR33990 6/18/08 -->
									<!--<Condition Property="IsMouseOver" SourceName="groupPanel" Value="True"/>-->
									<!-- AS BR28885 12/5/07 - Added sourcename to only prevent highlight when something within the group has capture -->
									<!--<Condition Property="IsMouseCaptureWithin" SourceName="groupPanel" Value="False"/>-->
									<Condition Property="HighlightContent" Value="True"/>
								</MultiTrigger.Conditions>
								<MultiTrigger.EnterActions>
									<BeginStoryboard x:Name="RibbonGroup_FadeIn_BeginStoryboard" Storyboard="{StaticResource RibbonGroup_FadeIn}"/>
									<BeginStoryboard x:Name="PART_Header_FadeIn_BeginStoryboard" Storyboard="{StaticResource PART_Header_FadeIn}"/>
									<BeginStoryboard x:Name="InnerBorder_FadeIn_BeginStoryboard" Storyboard="{StaticResource InnerBorder_FadeIn}"/>
									<BeginStoryboard x:Name="borderLight_FadeOut_BeginStoryboard" Storyboard="{StaticResource borderLight_FadeOut}"/>
								</MultiTrigger.EnterActions>
								<MultiTrigger.ExitActions>
									<StopStoryboard BeginStoryboardName="RibbonGroup_FadeIn_BeginStoryboard"/>
									<StopStoryboard BeginStoryboardName="PART_Header_FadeIn_BeginStoryboard"/>
									<BeginStoryboard x:Name="RibbonGroup_FadeOut_BeginStoryboard" Storyboard="{StaticResource RibbonGroup_FadeOut}"/>
									<BeginStoryboard x:Name="PART_Header_FadeOut_BeginStoryboard" Storyboard="{StaticResource PART_Header_FadeOut}"/>
									<BeginStoryboard x:Name="InnerBorder_FadeOut_BeginStoryboard" Storyboard="{StaticResource InnerBorder_FadeOut}"/>
									<BeginStoryboard x:Name="borderLight_FadeIn_BeginStoryboard" Storyboard="{StaticResource borderLight_FadeIn}"/>
								</MultiTrigger.ExitActions>
							</MultiTrigger>
							<Trigger Property="IsCollapsed" Value="True">
								<Setter Property="Visibility" TargetName="PART_RibbonGroupButton" Value="Visible"/>
								<Setter Property="igRibbon:RibbonGroup.Caption" TargetName="PART_RibbonGroupButton" Value="{Binding Caption, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="igRibbon:RibbonGroup.SmallImage" TargetName="PART_RibbonGroupButton" Value="{Binding SmallImage, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="Visibility" TargetName="PART_RibbonGroupSite" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="IsActive" Value="True">
								<Setter Property="Background" TargetName="PART_RibbonGroupButton" Value="Yellow"/>
							</Trigger>
							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Style" TargetName="PART_RibbonGroupButton" Value="{DynamicResource {x:Static igRibbon:RibbonGroup.QuickAccessToolbarGroupButtonStyleKey}}"/>
								<Setter Property="Visibility" TargetName="PART_RibbonGroupButton" Value="Visible"/>
								<Setter Property="igRibbon:RibbonGroup.Caption" TargetName="PART_RibbonGroupButton" Value="{Binding Caption, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="igRibbon:RibbonGroup.SmallImage" TargetName="PART_RibbonGroupButton" Value="{Binding SmallImage, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="Visibility" TargetName="PART_RibbonGroupSite" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="HasDialogBoxLauncherTool" Value="True">
								<Setter Property="Visibility" TargetName="DialogBoxLauncher" Value="Visible"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Margin" Value="2,0,0,0"/>
			<Style.Triggers>
				<Trigger Property="Location" Value="QuickAccessToolbar">
					<Setter Property="Margin" Value="0" />
					<Setter Property="Focusable" Value="True" />
				</Trigger>
				<Trigger Property="IsCollapsed" Value="True">
					<Setter Property="Focusable" Value="True" />
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- RadioButtonTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:RadioButtonTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
			<Setter Property="Template" Value="{StaticResource RibbonButtonToolTemplate}"/>

			<Style.Triggers>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
					</MultiDataTrigger.Conditions>
					<!--<Setter Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowColor=White, GlowSize=10, Opacity=0.6}" />-->
					<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VistaWindowMaximizedTextFillKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="False" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
				</MultiDataTrigger>

			</Style.Triggers>

		</Style>

		<!-- =================================================================== -->
		<!-- ToggleButtonTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ToggleButtonTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
			<Setter Property="Template" Value="{StaticResource RibbonButtonToolTemplate}"/>

			<Style.Triggers>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
					</MultiDataTrigger.Conditions>
					<!--<Setter Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowColor=White, GlowSize=10, Opacity=0.6}" />-->
					<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VistaWindowMaximizedTextFillKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="False" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
				</MultiDataTrigger>

			</Style.Triggers>

		</Style>

		<!-- =================================================================== -->
		<!-- CheckBoxTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:CheckBoxTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:CheckBoxTool}">
						<Grid Width="Auto">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="Auto"/>
								<ColumnDefinition Width="*"/>
							</Grid.ColumnDefinitions>

							<igWindows:AutoDisabledImage x:Name="image" Width="16" Height="16"
							igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
							igWindows:Utilities.SnapElementToDevicePixels="True"
							Visibility="{Binding HasImage, Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"
							Source="{TemplateBinding ImageResolved}" />
							<Grid x:Name="CheckBox" VerticalAlignment="Center" Grid.Column="1" Margin="3,0,3,0"
							igRibbon:XamRibbon.KeyTipPlacementType="CheckIndicator">
								<Rectangle Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxNormalOuterBoxCenterFillKey}}" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxNormalOuterBoxBorderFillKey}}" HorizontalAlignment="Left" VerticalAlignment="Top" Width="13" Height="13" x:Name="CheckBox_OuterBox" SnapsToDevicePixels="True"/>
								<Rectangle Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxNormalInnerBoxCenterFillKey}}" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxNormalInnerBoxBorderFillKey}}" HorizontalAlignment="Left" Margin="2,2,0,0" VerticalAlignment="Top" Width="9" Height="9" x:Name="CheckBox_InnerBox" SnapsToDevicePixels="True"/>
								<Grid Visibility="Hidden" Margin="0,0,0,0" x:Name="CheckMark">
									<Path
								 Height="9.661"
								 Width="10.137"
								 Stretch="Fill"
								 Opacity="0.8"
								 Data="M2.6673452,7.8617508 C2.6673452,7.8617508 5.817048,10.192734 5.817048,10.192734 5.817048,10.192734 9.5967099,4.4942121 9.5967099,4.4942121"
								 Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckmarkBackgroundFillKey}}"
								 StrokeThickness="3" SnapsToDevicePixels="True" HorizontalAlignment="Left" Margin="1.138,0.965,0,0" x:Name="Background" VerticalAlignment="Top" />
									<Path
									  Height="8.915"
									  Width="8.66"
									  Stretch="Fill"
									  Opacity="1"
									  Data="M1.6839831,7.7438574 C1.6839831,7.7438574 5.8697866,10.85053 5.8697866,10.85053 5.8697866,10.85053 10.540217,1.6301305 10.540217,1.6301305"
									  Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckmarkForegroundFillKey}}"
									  StrokeThickness="2" SnapsToDevicePixels="True" HorizontalAlignment="Left" Margin="1.855,1.465,0,0" x:Name="Foreground" VerticalAlignment="Top" />
								</Grid>
							</Grid>
							<Rectangle x:Name="activeRect" Visibility="Collapsed" Grid.Column="2" StrokeThickness="1" Stroke="Black" StrokeDashArray="1 2" SnapsToDevicePixels="true" />
							<ContentPresenter
						x:Name="text"
						Content="{TemplateBinding Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}"
						Grid.Column="2"
						VerticalAlignment="Center"
						HorizontalAlignment="Left"
						TextBlock.TextAlignment="Left"
						Margin="2,1,4,1"/>
						</Grid>
						<ControlTemplate.Triggers>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="Location" Value="ApplicationMenu"/>
									<Condition Property="IsMouseOver" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</MultiTrigger>

							<Trigger Property="Location" Value="Ribbon">
								<Setter Property="HorizontalAlignment" Value="Left"/>
							</Trigger>

							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
								<Setter Property="Visibility" Value="Collapsed" TargetName="image"/>
							</Trigger>

							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>

								<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
								<Setter Property="Margin" Value="6,0,0,0"/>
							</Trigger>

							<Trigger Property="IsActive" Value="True">
								<Setter Property="Fill" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxHoverInnerBoxCenterFillKey}}"/>
								<Setter Property="Stroke" TargetName="CheckBox_OuterBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxHoverOuterBoxBorderFillKey}}"/>
								<Setter Property="Stroke" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxHoverInnerBoxBorderFillKey}}"/>
								<Setter Property="Visibility" TargetName="activeRect" Value="Visible"/>
							</Trigger>

							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Fill" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxHoverInnerBoxCenterFillKey}}"/>
								<Setter Property="Stroke" TargetName="CheckBox_OuterBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxHoverOuterBoxBorderFillKey}}"/>
								<Setter Property="Stroke" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxHoverInnerBoxBorderFillKey}}"/>
							</Trigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsPressed" Value="True"/>
									<Condition Property="IsChecked" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter Property="Visibility" TargetName="CheckMark" Value="Visible"/>
								<Setter Property="Stroke" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxPressedInnerBoxBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxPressedInnerBoxCenterFillKey}}"/>
								<Setter Property="Stroke" TargetName="CheckBox_OuterBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxPressedOuterBoxBorderFillKey}}"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsPressed" Value="True"/>
									<Condition Property="IsChecked" Value="False"/>
								</MultiTrigger.Conditions>
								<Setter Property="Visibility" TargetName="CheckMark" Value="Visible"/>
								<Setter Property="Stroke" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxPressedInnerBoxBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="CheckBox_InnerBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxPressedInnerBoxCenterFillKey}}"/>
								<Setter Property="Stroke" TargetName="CheckBox_OuterBox" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxPressedOuterBoxBorderFillKey}}"/>
							</MultiTrigger>

							<Trigger Property="IsChecked" Value="True">
								<Setter Property="Visibility" TargetName="CheckMark" Value="Visible"/>
							</Trigger>

							<Trigger Property="IsChecked" Value="{x:Null}">
								<Setter TargetName="CheckBox_InnerBox" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxIndeterminateCenterFillKey}}"/>
								<Setter TargetName="CheckBox_InnerBox" Property="Stroke" Value="Transparent"/>
							</Trigger>

							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="CheckBox_OuterBox" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxDisabledOuterBoxCenterFillKey}}"/>
								<Setter TargetName="CheckBox_OuterBox" Property="Stroke" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxDisabledOuterBoxBorderFillKey}}"/>
								<Setter TargetName="CheckBox_InnerBox" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxDisabledInnerBoxCenterFillKey}}"/>
								<Setter TargetName="CheckBox_InnerBox" Property="Stroke" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CheckBoxDisabledInnerBoxBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}" />
							</Trigger>

							<Trigger Property="igRibbon:XamRibbon.HideAccessKey" Value="False">
								<Setter TargetName="text" Property="RecognizesAccessKey" Value="True"/>
								<Setter TargetName="text" Property="Content" Value="{Binding Caption, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>

							<!-- AS 1/4/08 BR29210 -->
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
									<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
								</MultiDataTrigger.Conditions>
								<Setter TargetName="text" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}" />
								<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}"/>
							</MultiDataTrigger>

							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
									<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized" />
								</MultiDataTrigger.Conditions>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VistaWindowMaximizedTextFillKey}}"/>
							</MultiDataTrigger>

						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- ButtonTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:ButtonTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
			<Setter Property="Template" Value="{StaticResource RibbonButtonToolTemplate}"/>
			<Style.Triggers>
				<Trigger Property="igRibbon:RibbonGroup.IsDialogBoxLauncherTool" Value="True">
					<Setter Property="Template" Value="{DynamicResource {x:Static igRibbon:RibbonGroup.DialogBoxLauncherToolTemplateKey}}"/>
				</Trigger>

				<!--<Trigger Property="Location" Value="QuickAccessToolbar">
				<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
			</Trigger>-->



				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
				</Trigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
					</MultiDataTrigger.Conditions>
					<!--<Setter Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowColor=White, GlowSize=10, Opacity=0.6}" />-->
					<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding IsBelowRibbon, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:QuickAccessToolbar}, 1}}" Value="False" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
						<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VistaWindowMaximizedTextFillKey}}"/>
				</MultiDataTrigger>

				<MultiDataTrigger>
					<MultiDataTrigger.Conditions>
						<Condition Binding="{Binding Location, RelativeSource={x:Static RelativeSource.Self}}" Value="QuickAccessToolbar" />
						<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="False" />
					</MultiDataTrigger.Conditions>
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
				</MultiDataTrigger>

				<Trigger Property="IsEnabled" Value="False">
					<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
				</Trigger>

			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- Ribbon's XamTabControl Style -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:XamRibbon.RibbonTabControlStyleKey}" TargetType="{x:Type igWindows:XamTabControl}">
			<Setter Property="KeyboardNavigation.DirectionalNavigation" Value="Continue" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igWindows:XamTabControl}">
						<Grid Margin="0,0,0,-1" ClipToBounds="True" SnapsToDevicePixels="True" KeyboardNavigation.TabNavigation="Local">
							<Grid.ColumnDefinitions>
								<ColumnDefinition x:Name="gridCol0" />
								<ColumnDefinition Width="0" x:Name="gridCol1" />
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto" x:Name="gridRow0" />
								<RowDefinition Height="*" x:Name="gridRow1" />
							</Grid.RowDefinitions>
							<Border
							SnapsToDevicePixels="True"
							BorderBrush="{x:Null}"
							x:Name="ContentPanel"
							KeyboardNavigation.TabIndex="2"
							KeyboardNavigation.TabNavigation="Local"
							KeyboardNavigation.DirectionalNavigation="Continue"
							Grid.Row="1"
							Visibility="Visible" Margin="0,-1,0,0"
							Background="{DynamicResource MenuBackgroundGradient}"
>
								<Grid Margin="1,0,0,1" SnapsToDevicePixels="True">
									<Border
								x:Name="BlueThemeOnlyOuterBorder"
								SnapsToDevicePixels="True"
								CornerRadius="5,5,5,5"
								Background="{DynamicResource MenuBackgroundGradient}"
								BorderBrush="{DynamicResource MenuBackgroundGradient}"
								BorderThickness="1,1,1,1"
								Margin="0,1,0,0">
										<Border
									x:Name="innerContentBorder"
									SnapsToDevicePixels="True"
									Background="{DynamicResource MenuBackgroundGradient}"
									CornerRadius="4,4,4,4"
									Margin="1,0,1,1"
									Padding="1,0,2,0">
											<Grid VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Height="Auto" Width="Auto" Margin="0,-1,0,-2">
												<Border
												x:Name="ContextualFill"
												CornerRadius="5,5,5,5"
												Visibility="Visible"
												SnapsToDevicePixels="True" 
												OpacityMask="{DynamicResource MenuBackgroundGradient}">
													<!--JJD 12/11/07 moved setting to Trigger if IsInContextualTabGroup == true -->
													<!--<Border.Background>
													<SolidColorBrush Color="{Binding Path=(igRibbon:XamRibbon.Ribbon).SelectedTab.ContextualTabGroup.BaseBackColorResolved, RelativeSource={x:Static RelativeSource.TemplatedParent}}" />
												</Border.Background>-->
												</Border>
												<ContentPresenter ContentSource="SelectedContent"
												Margin="{TemplateBinding Padding}"
												Height="{TemplateBinding TabItemContentHeight}"
												x:Name="PART_SelectedContentHost"
												SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
												ContentTemplate="{TemplateBinding SelectedContentTemplate}"
												Content="{TemplateBinding SelectedContent}" />
											</Grid>
										</Border>
									</Border>
								</Grid>
							</Border>
							<DockPanel x:Name="PART_HeaderArea" Panel.ZIndex="1" Background="{DynamicResource MenuBackgroundGradient}" SnapsToDevicePixels="True">
								<ContentPresenter x:Name="PreTabItemContent"
								   DockPanel.Dock="Left"
								   Content="{TemplateBinding PreTabItemContent}"
								   ContentTemplate="{TemplateBinding PreTabItemContentTemplate}"
								   ContentTemplateSelector="{TemplateBinding PreTabItemContentTemplateSelector}" />
								<ContentPresenter x:Name="PostTabItemContent"
								   DockPanel.Dock="Right"
								   Content="{TemplateBinding PostTabItemContent}"
								   ContentTemplate="{TemplateBinding PostTabItemContentTemplate}"
								   ContentTemplateSelector="{TemplateBinding PostTabItemContentTemplateSelector}" />
								<igWindows:XamPager x:Name="PART_TabItemScrollViewer" Focusable="False"
											 CanContentScroll="True"
											 KeyboardNavigation.TabIndex="1"
											 KeyboardNavigation.TabNavigation="Local"
											 KeyboardNavigation.DirectionalNavigation="Continue"
											 ScrollLeftButtonStyle="{DynamicResource {x:Static igRibbon:RibbonGroupCollection.PagerScrollLeftButtonStyleKey}}"
											 ScrollRightButtonStyle="{DynamicResource {x:Static igRibbon:RibbonGroupCollection.PagerScrollRightButtonStyleKey}}"
										   ScrollViewer.VerticalScrollBarVisibility="{TemplateBinding TabItemVerticalScrollBarVisibility}"
										   ScrollViewer.HorizontalScrollBarVisibility="{TemplateBinding TabItemHorizontalScrollBarVisibility}">
									<ItemsPresenter x:Name="PART_TabHeaderPanel"
															  Margin="2,1,2,0"
																KeyboardNavigation.TabNavigation="Once"/>
								</igWindows:XamPager>
							</DockPanel>
							<!-- AS 9/23/09 TFS2236 - Added HandleMouseDownOnClose -->
							<Popup x:Name="PART_Popup"
						  AllowsTransparency="True"
							igWindows:PopupHelper.HandleMouseDownOnClose="True"
							StaysOpen="False"
							IsOpen="{Binding IsDropDownOpen, RelativeSource={RelativeSource TemplatedParent}}"
							Width="{TemplateBinding PreferredDropDownExtent}"
							CustomPopupPlacementCallback="{TemplateBinding PreferredDropDownPlacementCallback}"
							Placement="Custom"
							SnapsToDevicePixels="True">
								<AdornerDecorator>
									<Border
								SnapsToDevicePixels="True"
								BorderThickness="0,0,0,0"
								KeyboardNavigation.TabIndex="2"
								KeyboardNavigation.TabNavigation="Local"
								KeyboardNavigation.DirectionalNavigation="Continue"
								Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonTabControlHeaderPanelBackgroundKey}}">
										<Border
									SnapsToDevicePixels="True"
									BorderBrush="{TemplateBinding Border.BorderBrush}"
									BorderThickness="{TemplateBinding Border.BorderThickness}"
									Margin="1,0,1,4">
											<Border
										SnapsToDevicePixels="True"
										Background="{TemplateBinding Panel.Background}"
										BorderThickness="1,1,1,1"
										BorderBrush="{DynamicResource MenuBackgroundGradient}"
										CornerRadius="3,3,3,3"
										Padding="2,0,2,0">
												<ContentPresenter
											ContentSource="SelectedContent"
											Margin="{TemplateBinding Padding}"
											Height="{TemplateBinding TabItemContentHeight}"
											x:Name="PART_SelectedContentHostMinimized"
											HorizontalAlignment="{Binding HorizontalAlignment, ElementName=PART_SelectedContentHost}"
											VerticalAlignment="{Binding VerticalAlignment, ElementName=PART_SelectedContentHost}"
											SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
											ContentTemplate="{TemplateBinding SelectedContentTemplate}"
											Content="{x:Null}"/>
											</Border>
										</Border>
									</Border>
								</AdornerDecorator>
							</Popup>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsDropDownOpen" Value="False">
								<Setter Property="PopupAnimation" TargetName="PART_Popup" Value="Fade"/>
							</Trigger>
							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="TextElement.Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GrayTextBrushKey}}"/>
							</Trigger>
							<Trigger Property="IsMinimized" Value="True">
								<Setter Property="Content" TargetName="PART_SelectedContentHostMinimized" Value="{Binding SelectedContent, RelativeSource={RelativeSource TemplatedParent}}" />
								<Setter Property="Visibility" TargetName="ContentPanel" Value="Collapsed" />
								<Setter Property="Content" TargetName="PART_SelectedContentHost" Value="{x:Null}" />
							</Trigger>
							<Trigger Property="igRibbon:XamRibbon.IsSelectedItemInContextualTabGroup" Value="True">
								<Setter Property="Background" TargetName="innerContentBorder" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="Background" TargetName="BlueThemeOnlyOuterBorder" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="BorderBrush" TargetName="innerContentBorder" Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="Background" TargetName="ContextualFill" 
					  Value="{DynamicResource MenuBackgroundGradient}"/>
								<Setter Property="Visibility" TargetName="ContextualFill" Value="Visible"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="PreTabItemContentTemplate">
				<Setter.Value>
					<DataTemplate>
						<Rectangle Width="{x:Static igRibbon:XamRibbon.ApplicationMenuButtonWidth}" Height="1"/>
					</DataTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="MaximumSizeToFitAdjustment" Value="18" />
			<Setter Property="MinimumTabExtent" Value="28" />
		</Style>

		<Style x:Key="CheckBoxFocusVisual">
			<Setter Property="Control.Template">
				<Setter.Value>
					<ControlTemplate>
						<Border>
							<Rectangle Margin="15,0,0,0" Stroke="#60000000" StrokeThickness="1" StrokeDashArray="1 2"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- TextEditorTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:TextEditorTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalCenterFillKey}}" />
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalBorderFillKey}}" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="Padding" Value="4,0,4,0" />
			<Setter Property="Margin" Value="1,0,1,0" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
			<Setter Property="SnapsToDevicePixels" Value="True" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:TextEditorTool}">
						<StackPanel Orientation="Horizontal" Background="#00000000">
							<igWindows:AutoDisabledImage Width="16" Height="16" x:Name="Image"
							 igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
							 igWindows:Utilities.SnapElementToDevicePixels="True"
							 Visibility="Collapsed"
							 Source="{TemplateBinding ImageResolved}"
						 />
							<ContentPresenter x:Name="Caption"
							Margin="0,-1,5,0"
							Visibility="{Binding (igRibbon:ButtonTool.HasCaption), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"
							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
							Content="{TemplateBinding Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}"/>
							<Border x:Name="MainBorder"
							Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalCenterFillKey}}"
							BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalBorderFillKey}}"
							BorderThickness="1,1,1,1"
							SnapsToDevicePixels="True"
							Width="{TemplateBinding EditAreaWidth}"
							>
								<Grid>
									<TextBlock x:Name="TextBlock"
									Margin="2,-1,0,0"
									Text="{TemplateBinding DisplayText}"
									TextWrapping="{TemplateBinding TextWrapping}"
									HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
									VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
									TextAlignment="{TemplateBinding TextAlignmentResolved}"/>
									<TextBox
									x:Name="PART_FocusSite"
									Margin="0,-1,0,0"
									Padding="0,0,0,0"
									BorderThickness="0,0,0,0"
									Text="{Binding Text, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}"
									TextWrapping="{TemplateBinding TextWrapping}"
									HorizontalScrollBarVisibility="{TemplateBinding HorizontalScrollBarVisibility}"
									VerticalScrollBarVisibility="{TemplateBinding VerticalScrollBarVisibility}"
									HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
									VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
									VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
									TextAlignment="{TemplateBinding TextAlignmentResolved}"
									IsReadOnly="{TemplateBinding ReadOnly}"
									MaxLength="{Binding ValueConstraint.MaxLength, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
									Background="Transparent"
									BorderBrush="Transparent"
									ContextMenu="{TemplateBinding ContextMenu}"
									Visibility="Collapsed"/>
								</Grid>
							</Border>
						</StackPanel>
						<ControlTemplate.Triggers>
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<!-- JJD 12/11/07 Added condition to check if we are in a menu before doing the FindAncestor for ToolMenuItem to prevent binding errors -->
									<Condition Binding="{Binding Location, Converter={x:Static igRibbon:ToolLocationToIsInMenuConverter.Instance}, RelativeSource={RelativeSource Self}}" Value="True"/>
									<Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:ToolMenuItem}, 1}}" Value="True" />
								</MultiDataTrigger.Conditions>
								<Setter TargetName="Caption" Property="TextElement.Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</MultiDataTrigger>

							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
								<Setter TargetName="TextBlock" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
							</Trigger>

							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />

								<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
								<Setter Property="Margin" Value="6,0,0,0"/>
							</Trigger>

							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="MainBorder" Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsDisabledCenterFillKey}}"/>
								<Setter TargetName="MainBorder" Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsDisabledBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True" SourceName="MainBorder">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsInEditMode" Value="True">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
								<Setter Property="IsTabStop" Value="False" />
								<Setter TargetName="PART_FocusSite" Property="Visibility" Value="Visible"/>
								<Setter TargetName="PART_FocusSite" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
								<Setter TargetName="TextBlock" Property="Visibility" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="IsFocused" Value="True">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsEmbedded" Value="False">
								<Setter TargetName="MainBorder" Property="CornerRadius" Value="0" />
							</Trigger>
							<Trigger Property="Location" Value="Ribbon">
								<Setter TargetName="Image"  Property="Visibility" Value="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
								<Setter TargetName="Image"  Property="Visibility" Value="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter TargetName="Caption"  Property="Visibility" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="igRibbon:XamRibbon.HideAccessKey" Value="False">
								<Setter TargetName="Caption" Property="RecognizesAccessKey" Value="True"/>
								<Setter TargetName="Caption" Property="Content" Value="{Binding Caption, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<!--<Setter Property="EditTemplate">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type igRibbon:TextEditorTool}">
					<StackPanel Orientation="Horizontal">
						<igWindows:AutoDisabledImage Width="16" Height="16" x:Name="Image"
							 igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
							 Visibility="Collapsed"
							 Source="{TemplateBinding igRibbon:TextEditorTool.ImageResolved}"
						 />
						<TextBlock x:Name="Caption"
						Margin="0,-1,5,0"
						Visibility="{Binding Path=(igRibbon:ButtonTool.HasCaption), RelativeSource={x:Static RelativeSource.TemplatedParent}, Converter={StaticResource BoolToVisConverter}}"
						VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
						Text="{TemplateBinding Caption}"/>
						<Border
							x:Name="MainBorder"
							Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"
							BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"
							BorderThickness="1,1,1,1"
							Width="{TemplateBinding EditAreaWidth}"
							SnapsToDevicePixels="True"
							>
							-->
			<!-- SSP 10/3/07 BR25672 Took the Margin="{TemplateBinding Padding}" code out of Border element above
								and instead added Padding="{TemplateBinding Padding}" to the TextBox below. Padding should not
								be outside the border and the background. It should be inside the border and around the editor's
								contents.-->
			<!--
							<TextBox
								Name="PART_FocusSite"
								Margin="-3,-1,0,0"
								Padding="0,0,0,0"
								BorderThickness="0,0,0,0"
								Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Text, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
								TextWrapping="{TemplateBinding TextWrapping}"
								HorizontalScrollBarVisibility="{TemplateBinding HorizontalScrollBarVisibility}"
								VerticalScrollBarVisibility="{TemplateBinding VerticalScrollBarVisibility}"
								HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
								VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
								VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
								TextAlignment="{TemplateBinding TextAlignmentResolved}"
								IsReadOnly="{TemplateBinding ReadOnly}"
								MaxLength="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ValueConstraint.MaxLength, Mode=OneWay}"
								Background="Transparent"
								BorderBrush="Transparent"
								Foreground="{TemplateBinding Foreground}"
								ContextMenu="{TemplateBinding ContextMenu}"
							/>
						</Border>
					</StackPanel>
					-->
			<!-- 
SSP 6/6/07 BR23366
Added trigger that sets IsTabStop to False based on IsInEditMode setting.
We need this in order to make the Tab and Shift+Tab navigation work properly.
Apparently presense of nested textbox causes Shift+Tab to misbehave and cause
the framwork to give focus to the parent ContentPresenter if the editor
is inside a HeaderedContentControl. This is similar to what inbox ComboBox
does.
-->
			<!--
					<ControlTemplate.Triggers>
						<Trigger Property="IsInEditMode" Value="True">
							<Setter Property="IsTabStop" Value="False" />
						</Trigger>
						<Trigger Property="Location" Value="Ribbon">
							<Setter TargetName="Image"  Property="Visibility" Value="{Binding Path=(igRibbon:ButtonTool.HasImage), RelativeSource={x:Static RelativeSource.TemplatedParent}, Converter={StaticResource BoolToVisConverter}}"/>
							<Setter TargetName="Caption"  Property="Visibility" Value="{Binding Path=(igRibbon:ButtonTool.HasCaption), RelativeSource={x:Static RelativeSource.TemplatedParent}, Converter={StaticResource BoolToVisConverter}}"/>
						</Trigger>
						<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
							<Setter TargetName="Image"  Property="Visibility" Value="{Binding Path=(igRibbon:ButtonTool.HasImage), RelativeSource={x:Static RelativeSource.TemplatedParent}, Converter={StaticResource BoolToVisConverter}}"/>
							<Setter TargetName="Caption"  Property="Visibility" Value="{Binding Path=(igRibbon:ButtonTool.HasCaption), RelativeSource={x:Static RelativeSource.TemplatedParent}, Converter={StaticResource BoolToVisConverter}}"/>
						</Trigger>
						<Trigger Property="Location" Value="QuickAccessToolbar">
							<Setter TargetName="Caption"  Property="Visibility" Value="Collapsed"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>-->
			<Style.Triggers>
				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsEmbedded" Value="True"/>
						<Condition Property="IsInEditMode" Value="False"/>
					</MultiTrigger.Conditions>
					<Setter Property="Background" Value="{x:Null}"/>
					<Setter Property="BorderBrush" Value="{x:Null}"/>
				</MultiTrigger>
			</Style.Triggers>
		</Style>

		<!-- SSP 8/18/10 TFS34483 -->
		<!--  _________________________ Spin Button Style  _______________________________________  -->
		<Style x:Key="spinButtonStyle" TargetType="{x:Type RepeatButton}">
			<Setter Property="Background" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnNormalCenterFillKey}}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnNormalOuterBorderFillKey}}"/>
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnGlyphNormalForegroundFillKey}}"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="Padding" Value="3,1"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<Border x:Name="Bd" BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="{DynamicResource {x:Static igEditors:EditorsBrushKeys.SpinButtonCornerRadiusKey}}">
							<Grid>
								<Border x:Name="innerBd" BorderBrush="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnNormalInnerBorderFillKey}}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="{DynamicResource {x:Static igEditors:EditorsBrushKeys.SpinButtonCornerRadiusKey}}"/>
								<ContentPresenter
							HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
							Margin="{TemplateBinding Padding}"/>
							</Grid>
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="BorderBrush" TargetName="innerBd" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnHottrackInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnHottrackCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnHottrackOuterBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="BorderBrush" TargetName="Bd" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnPressedOuterBorderFillKey}}"/>
								<Setter Property="Background" TargetName="Bd" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnPressedCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="innerBd" Value="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DropdownBtnPressedInnerBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsEnabled" Value="False"/>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- MaskedEditorTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:MaskedEditorTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalCenterFillKey}}" />
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalBorderFillKey}}" />
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="Padding" Value="4,0,4,0" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
			<Setter Property="SnapsToDevicePixels" Value="True" />
			<Setter Property="SpinButtonStyle" Value="{StaticResource spinButtonStyle}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:MaskedEditorTool}">
						<StackPanel Orientation="Horizontal">
							<igWindows:AutoDisabledImage Width="16" Height="16" x:Name="Image"
							igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
							igWindows:Utilities.SnapElementToDevicePixels="True"
							Visibility="Collapsed"
							Source="{TemplateBinding igRibbon:TextEditorTool.ImageResolved}"/>
							<ContentPresenter x:Name="Caption"
							Margin="0,-1,5,0"
							Visibility="{Binding (igRibbon:ButtonTool.HasCaption), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"
							VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
							Content="{TemplateBinding Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}"/>
							<Border x:Name="MainBorder"
							SnapsToDevicePixels="True"
							Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalCenterFillKey}}"
							BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalBorderFillKey}}"
							BorderThickness="1,1,1,1"
							Width="{TemplateBinding EditAreaWidth}">
								<!--SSP 10/1/09 NAS10.1 - Spin Buttons - Enclosed in dock panel element so we can display spin buttons-->
								<DockPanel>
									<!--SSP 10/1/09 NAS10.1 - Spin Buttons -->
									<Grid x:Name="PART_SpinButtons" DockPanel.Dock="Right" Visibility="{TemplateBinding SpinButtonVisibilityResolved}" Margin="0,1">
										<Grid.RowDefinitions>
											<RowDefinition Height="*"/>
											<RowDefinition Height="1"/>
											<RowDefinition Height="*"/>
										</Grid.RowDefinitions>
										<RepeatButton Style="{TemplateBinding SpinButtonStyle}" Focusable="false" Command="{x:Static igEditors:MaskedEditorCommands.SpinUp}" ContentTemplate="{DynamicResource {x:Static igEditors:EditorsBrushKeys.IncreaseGlyphKey}}"/>
										<RepeatButton Style="{TemplateBinding SpinButtonStyle}" Focusable="false" Command="{x:Static igEditors:MaskedEditorCommands.SpinDown}" Grid.Row="2" ContentTemplate="{DynamicResource {x:Static igEditors:EditorsBrushKeys.DecreaseGlyphKey}}"/>
									</Grid>
									<Grid>
										<TextBlock x:Name="TextBlock"
										Margin="2,-1,0,0"
										Text="{TemplateBinding DisplayText}"
										HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
										VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
										<igEditors:SectionsList
										x:Name="PART_FocusSite"
										Margin="2,-1,0,0"
										ItemsSource="{Binding Sections, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
										HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
										VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
										FlowDirection="LeftToRight"
										Visibility="Collapsed"/>
									</Grid>
								</DockPanel>
							</Border>
						</StackPanel>
						<ControlTemplate.Triggers>

							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<!-- JJD 12/11/07 Added condition to check if we are in a menu before doing the FindAncestor for ToolMenuItem to prevent binding errors -->
									<Condition Binding="{Binding Location, Converter={x:Static igRibbon:ToolLocationToIsInMenuConverter.Instance}, RelativeSource={RelativeSource Self}}" Value="True"/>
									<Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:ToolMenuItem}, 1}}" Value="True" />
								</MultiDataTrigger.Conditions>
								<Setter TargetName="Caption" Property="TextElement.Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</MultiDataTrigger>


							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
								<Setter TargetName="TextBlock" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
							</Trigger>

							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />

								<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
								<Setter Property="Margin" Value="6,0,0,0"/>
							</Trigger>

							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="MainBorder" Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsDisabledCenterFillKey}}"/>
								<Setter TargetName="MainBorder" Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsDisabledBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
							</Trigger>

							<Trigger Property="IsMouseOver" Value="True" SourceName="MainBorder">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsInEditMode" Value="True">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
								<Setter TargetName="PART_FocusSite" Property="Visibility" Value="Visible"/>
								<Setter TargetName="TextBlock" Property="Visibility" Value="Collapsed"/>
								<Setter TargetName="PART_FocusSite" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
								<Setter Property="IsTabStop" Value="False" />
							</Trigger>
							<Trigger Property="IsFocused" Value="True">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="HasCaption" Value="True">
								<Setter TargetName="Caption" Property="Visibility" Value="Visible" />
							</Trigger>
							<Trigger Property="IsEmbedded" Value="False">
								<Setter TargetName="MainBorder" Property="CornerRadius" Value="0" />
							</Trigger>
							<Trigger Property="Location" Value="Ribbon">
								<Setter TargetName="Image"  Property="Visibility" Value="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
								<Setter TargetName="Image"  Property="Visibility" Value="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter TargetName="Caption"  Property="Visibility" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="igRibbon:XamRibbon.HideAccessKey" Value="False">
								<Setter TargetName="Caption" Property="RecognizesAccessKey" Value="True"/>
								<Setter TargetName="Caption" Property="Content" Value="{Binding Caption, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<!--<Setter Property="EditTemplate">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type igRibbon:MaskedEditorTool}">
					<StackPanel Orientation="Horizontal">
						<TextBlock x:Name="Caption"
						Margin="0,-1,5,0"
						Visibility="Collapsed"
						VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
						Text="{TemplateBinding Caption}"/>
						<Border x:Name="MainBorder"
							Background="{DynamicResource MenuBackgroundGradient}"
							BorderBrush="{TemplateBinding BorderBrush}"
							BorderThickness="{TemplateBinding BorderThickness}"
							Width="{TemplateBinding EditAreaWidth}"
							>
							-->
			<!-- SSP 10/3/07 BR25672 Took the following code out of Border element above
									since we are setting that value on the SectionsList element below.
									We don't want to substract the padding twice
							Margin="{TemplateBinding Padding}"-->
			<!--
							<igEditors:SectionsList
								x:Name="PART_FocusSite"
								Margin="2,-1,0,0"
								Foreground="{TemplateBinding Foreground}"
								ItemsSource="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Sections, Mode=OneWay}"
								HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
								VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
								FlowDirection="LeftToRight"
							/>
						</Border>
					</StackPanel>
					<ControlTemplate.Triggers>
						<Trigger Property="HasCaption" Value="True">
							<Setter TargetName="Caption" Property="Visibility" Value="Visible" />
						</Trigger>
						<Trigger Property="IsEmbedded" Value="False">
							<Setter TargetName="MainBorder" Property="CornerRadius" Value="0" />
						</Trigger>
						-->
			<!-- 
SSP 6/6/07 BR23366
Added trigger that sets IsTabStop to False based on IsInEditMode setting.
We need this in order to make the Tab and Shift+Tab navigation work properly.
Apparently presense of nested textbox causes Shift+Tab to misbehave and cause
the framwork to give focus to the parent ContentPresenter if the editor
is inside a HeaderedContentControl. This is similar to what inbox ComboBox
does.
-->
			<!--
						<Trigger Property="IsInEditMode" Value="True">
							<Setter Property="IsTabStop" Value="False" />
							<Setter Property="Background" TargetName="MainBorder" Value="#FFFFFFFF"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>-->
			<Style.Triggers>
				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsEmbedded" Value="True"/>
						<Condition Property="IsInEditMode" Value="False"/>
					</MultiTrigger.Conditions>
					<Setter Property="Background" Value="{x:Null}"/>
					<Setter Property="BorderBrush" Value="{x:Null}"/>
				</MultiTrigger>
				<Trigger Property="IsInEditMode" Value="True">
					<!-- SSP 5/13/10 TFS30701 - Commented out setting of ClipToBounds which I believe was
				added to clip the caret element and so instead added the necessary code to clip the caret
				in XamMaskedEditor.ArrangeOverride. This bug-fix was done to make the UIElement.Effect work. -->
					<!--<Setter Property="ClipToBounds" Value="True" />-->
					<!--
// SSP 3/15/07 BR21086 BR20704
// Do this through the style via a trigger so when the masked editor is not in edit mode, it draws 
// the focus rect. For example, in DataPresenter when the cell exits edit mode via Escape key, the
// editor retains focus and is not in edit mode. In such a case, it should draw focus rect.
-->
					<Setter Property="FocusVisualStyle">
						<Setter.Value>
							<Style />
						</Setter.Value>
					</Setter>
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- GalleryItemPresenter Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:GalleryItemPresenter}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<!--<Setter Property="Margin" Value="2"/>-->
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:GalleryItemPresenter}">
						<Grid x:Name="borderEntireItem" Background="#00ffffff">
							<Rectangle
						Opacity="1"
						HorizontalAlignment="Stretch"
						VerticalAlignment="Stretch"
						Margin="0,0,0,0"
						RadiusX="2.8000000000000003"
						RadiusY="2.8000000000000003" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterHoverBorderDarkFillKey}}" SnapsToDevicePixels="True" Visibility="Hidden" x:Name="BorderDark"/>
							<Rectangle
						Opacity="1"
						HorizontalAlignment="Stretch"
						VerticalAlignment="Stretch"
						Margin="1,1,1,1"
						RadiusX="2.75"
						RadiusY="2.75" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterHoverBorderLightFillKey}}" SnapsToDevicePixels="True" Visibility="Hidden" x:Name="BorderLight"/>
							<Rectangle SnapsToDevicePixels="True" Visibility="Hidden" Margin="1,1,1,1" x:Name="BottomOverlay" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterHoverBottomOverlayGradientKey}}"/>
							<Rectangle SnapsToDevicePixels="True" Visibility="Hidden" Margin="2,2,2,2" x:Name="CenterBorder" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterHoverCenterFillKey}}" RadiusX="1" RadiusY="1"/>
							<Border SnapsToDevicePixels="True" Visibility="Hidden" Margin="3,3,3,3" x:Name="Center" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterSelectedCenterFillKey}}" CornerRadius="1,1,1,1"/>
							<!-- JM BR27280 10-10-07 -->
							<!--<Grid Margin="2,2,2,2" >-->
							<Grid Margin="2,2,2,2" HorizontalAlignment="Center" VerticalAlignment="Center">
								<Grid.RowDefinitions>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="Auto"/>
									<ColumnDefinition Width="Auto"/>
								</Grid.ColumnDefinitions>
								<Border x:Name="borderImage" Grid.Row="0" Grid.Column="0" BorderBrush="Transparent" BorderThickness="2" CornerRadius="3">
									<igWindows:AutoDisabledImage x:Name="image" Source="{Binding Item.Image, RelativeSource={RelativeSource TemplatedParent}}" 
									igWindows:Utilities.SnapElementToDevicePixels="True" />
								</Border>
								<TextBlock x:Name="text" Grid.Row="1" Grid.Column="0"
							Foreground="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" 
							Visibility="{TemplateBinding TextVisibility}"
							TextAlignment="{TemplateBinding HorizontalTextAlignmentResolved}"
							VerticalAlignment="{TemplateBinding VerticalTextAlignmentResolved}"
							Text="{Binding Item.Text, RelativeSource={RelativeSource TemplatedParent}}"/>
							</Grid>
						</Grid>

						<ControlTemplate.Triggers>
							<!-- Text visible and above Image-->
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="TextPlacementResolved" Value="AboveImage"/>
									<Condition Property="TextVisibility" Value="Visible"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="borderImage" Property="Grid.Row" Value="1" />
								<Setter TargetName="text" Property="Grid.Row" Value="0" />
							</MultiTrigger>

							<!-- Text visible and left of Image-->
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="TextPlacementResolved" Value="LeftOfImage"/>
									<Condition Property="TextVisibility" Value="Visible"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="borderImage" Property="Grid.Column" Value="1"/>
								<Setter TargetName="text" Property="Grid.Row" Value="0" />
							</MultiTrigger>

							<!-- Text visible and right of Image-->
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="TextPlacementResolved" Value="RightOfImage"/>
									<Condition Property="TextVisibility" Value="Visible"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="text" Property="Grid.Column" Value="1"/>
								<Setter TargetName="text" Property="Grid.Row" Value="0" />
							</MultiTrigger>


							<!-- Set highlight on the appropriate part of the Item when selected (i.e., IsSelected = true).  Check SelectionDisplayModeResolved 
to determine what part of the item to highlight -->
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsSelected" Value="True"/>
									<Condition Property="SelectionDisplayModeResolved" Value="HighlightImageOnly"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="borderImage" Property="BorderBrush">
									<Setter.Value>
										<LinearGradientBrush EndPoint="0,0" StartPoint="0,1">
											<GradientStop Offset="0" Color="Gold" />
											<GradientStop Offset="1" Color="Orange" />
										</LinearGradientBrush>
									</Setter.Value>
								</Setter>
							</MultiTrigger>

							<!-- Selected State-->
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsSelected" Value="True"/>
									<Condition Property="SelectionDisplayModeResolved" Value="HighlightEntireItem"/>
								</MultiTrigger.Conditions>
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Fill" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterSelectedBorderDarkFillKey}}"/>
								<Setter Property="Fill" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterSelectedBorderLightFillKey}}"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Margin" TargetName="BorderLight" Value="1,1,1,0"/>
								<Setter Property="Margin" TargetName="BorderDark" Value="0,0,0,1"/>
								<Setter Property="Fill" TargetName="BottomOverlay" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterSelectedBottomOverlayGradientKey}}"/>
								<Setter Property="Visibility" TargetName="BottomOverlay" Value="Visible"/>
								<Setter Property="Margin" TargetName="BottomOverlay" Value="1,1,1,0"/>
								<Setter Property="Visibility" TargetName="CenterBorder" Value="Visible"/>
								<Setter Property="Fill" TargetName="CenterBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemPresenterSelectedBorderLightFillInnerKey}}"/>
								<Setter Property="Visibility" TargetName="Center" Value="Visible"/>
								<Setter Property="Margin" TargetName="Center" Value="3,3,3,2"/>
							</MultiTrigger>

							<!-- Mouseover state-->
							<!-- Set highlight when active (i.e., IsSelected = false and IsMouseOver = true) -->
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="IsSelected" Value="False"/>
									<!-- JJD 11/20/07 - BR27066
									 Trigger off IsHighlighted property instead of IsMouseOver to support keyboard navigation -->
									<!--<Condition Property="IsMouseOver" Value="True"/>-->
									<Condition Property="IsHighlighted" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter Property="Visibility" TargetName="BorderDark" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="BottomOverlay" Value="Visible"/>
								<Setter Property="Visibility" TargetName="CenterBorder" Value="Visible"/>
								<Setter TargetName="text" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</MultiTrigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="IsInPreviewArea" Value="True">
					<Setter Property="Focusable" Value="False" />
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- GalleryToolPreviewPresenter Style -->
		<!-- =================================================================== -->

		<!-- Preview Button Styles -->
		<Style x:Key="GalleryToolPreviewPresenter_ScrollUpButton" BasedOn="{x:Null}" TargetType="{x:Type ButtonBase}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ButtonBase}">
						<Grid x:Name="GalleryToolPreviewPresenter_ScrollUpButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto">
							<Border Width="Auto" Height="Auto" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonDisabledBorderDarkFillKey}}" CornerRadius="0,3,0,0" x:Name="border" SnapsToDevicePixels="True" IsHitTestVisible="True"/>
							<Border CornerRadius="0,2,0,0" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollUpButtonDisabledBorderLightFillKey}}" Margin="1,1,1,1" x:Name="border1" SnapsToDevicePixels="True" IsHitTestVisible="True"/>
							<Border Margin="2,2,2,2" CornerRadius="0,1,0,0" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollUpButtonDisabledCenterFillKey}}" x:Name="border2" SnapsToDevicePixels="True" IsHitTestVisible="True">
								<Grid Opacity="1" x:Name="GalleryToolPreviewPresenter_EnabledArrowUp" HorizontalAlignment="Center" VerticalAlignment="Center">
									<Path
								Margin="0,0,0,0"
								HorizontalAlignment="Left"
								VerticalAlignment="Top"
								Height="4"
								Width="8"
								Stretch="Fill"
								Opacity="1"
								Data="M 0,4 C0,4 8,4 8,4 8,4 4,0 4,0 4,0 0,4 0,4 z"
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDisabledArrowBackgroundFillKey}}" SnapsToDevicePixels="True" />
									<Path
								Margin="1,1,0,0"
								HorizontalAlignment="Left"
								VerticalAlignment="Top"
								Height="3"
								Width="6"
								Stretch="Fill"
								Opacity="1"
								Data="M 1,4 C1,4 7,4 7,4 7,4 4,1 4,1 4,1 1,4 1,4 z"
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDisabledArrowForegroundFillKey}}" SnapsToDevicePixels="True" x:Name="path" />
								</Grid>
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsEnabled" Value="True">
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalCenterFillKey}}"/>
								<Setter Property="Fill" TargetName="path" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterEnabledArrowForegroundFillKey}}"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverCenterFillKey}}"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollUpButtonPressedBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollUpButtonPressedInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollUpButtonPressedCenterFillKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="GalleryToolPreviewPresenter_ScrollDownButton" BasedOn="{x:Null}" TargetType="{x:Type ButtonBase}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ButtonBase}">
						<Grid x:Name="GalleryToolPreviewPresenter_ScrollDownButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto">
							<Rectangle SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonDisabledBorderDarkFillKey}}" x:Name="rectangle"/>
							<Rectangle Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollDownButtonDisabledBorderLightFillKey}}" SnapsToDevicePixels="True" Margin="1,0,1,0" x:Name="rectangle1"/>
							<Border Margin="2,1,2,1" x:Name="border" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollDownButtonDisabledCenterFillKey}}" SnapsToDevicePixels="True">
								<Grid Opacity="1" x:Name="GalleryToolPreviewPresenter_EnabledArrowDown" HorizontalAlignment="Center" VerticalAlignment="Center">
									<Path
								x:Name="ArrowBackground"
								Margin="0,0,0,0"
								HorizontalAlignment="Left"
								VerticalAlignment="Top"
								Height="4"
								Width="8"
								Stretch="Fill"
								Opacity="1"
								Data="M 0,0 C0,0 8,0 8,0 8,0 4,4 4,4 4,4 0,0 0,0 z"
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDisabledArrowBackgroundFillKey}}" SnapsToDevicePixels="True" ClipToBounds="False" />
									<Path
								x:Name="ArrowForeground"
								Margin="1,0,0,0"
								HorizontalAlignment="Left"
								VerticalAlignment="Top"
								Height="3"
								Width="6"
								Stretch="Fill"
								Opacity="1"
								Data="M 1,0 C1,0 7,0 7,0 7,0 4,3 4,3 4,3 1,0 1,0 z"
								Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDisabledArrowForegroundFillKey}}" SnapsToDevicePixels="True" ClipToBounds="False" />
								</Grid>
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsEnabled" Value="True">
								<Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="rectangle1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalCenterFillKey}}"/>
								<Setter Property="Fill" TargetName="ArrowForeground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterEnabledArrowForegroundFillKey}}"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Margin" TargetName="rectangle1" Value="1,1,1,0"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverCenterFillKey}}"/>
								<Setter Property="Fill" TargetName="rectangle1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverInnerBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollUpButtonPressedBorderFillKey}}"/>
								<Setter Property="Margin" TargetName="rectangle1" Value="1,0,1,0"/>
								<Setter Property="Fill" TargetName="rectangle1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollDownButtonPressedInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollDownButtonPressedCenterFillKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style x:Key="GalleryToolPreviewPresenter_DropDownButton" TargetType="{x:Type ButtonBase}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ButtonBase}">
						<Grid x:Name="GalleryToolPreviewPresenter_DropDownButton" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto">
							<Border SnapsToDevicePixels="True" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalBorderFillKey}}" CornerRadius="0,0,3,0" x:Name="border"/>
							<Border SnapsToDevicePixels="True" CornerRadius="0,0,2,0" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalInnerBorderFillKey}}" Margin="1,1,1,1" x:Name="border1"/>
							<Border SnapsToDevicePixels="True" CornerRadius="0,0,1,0" Margin="2,2,2,2" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonNormalCenterFillKey}}" x:Name="border2">
								<Grid HorizontalAlignment="Center" VerticalAlignment="Center" Background="#00ffffff">
									<Path SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDropDownButtonIconBackgroundFillKey}}" Stretch="None" Data="M0,0L7,0 3.5,4z" d:LayoutOverrides="Height" HorizontalAlignment="Center" Margin="0,3,0,0" VerticalAlignment="Top"/>
									<Path SnapsToDevicePixels="True" d:LayoutOverrides="Height" HorizontalAlignment="Center" Margin="0,3,0,0" VerticalAlignment="Top" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDropDownButtonIconForegroundFillKey}}" Stretch="None" Data="M0,0L5,0 2.5,3z"/>
									<Rectangle SnapsToDevicePixels="True" HorizontalAlignment="Stretch" VerticalAlignment="Top" Width="5" Height="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDropDownButtonIconForegroundFillKey}}"/>
									<Rectangle SnapsToDevicePixels="True" HorizontalAlignment="Center" Margin="0,1,0,0" VerticalAlignment="Top" Width="5" Height="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterDropDownButtonIconBackgroundFillKey}}"/>
								</Grid>
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverCenterFillKey}}"/>
							</Trigger>
							<Trigger Property="igRibbon:XamRibbon.IsActive" Value="True">
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverInnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterScrollButtonHoverCenterFillKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<Style TargetType="{x:Type igRibbon:GalleryToolPreviewPresenter}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:GalleryToolPreviewPresenter}">
						<Border 
						x:Name="GalleryToolPreviewPresenterBorder" 
						Grid.Column="0" 
						BorderThickness="1" 
						BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolPreviewPresenterBorderFillKey}}" 
						SnapsToDevicePixels="True"
						CornerRadius="0,5,5,0"
						Margin="3">
							<Grid>
								<Grid.ColumnDefinitions>
									<ColumnDefinition Width="*"/>
									<ColumnDefinition Width="15"/>
								</Grid.ColumnDefinitions>

								<igRibbon:GalleryPreviewScroller x:Name="galleryPreviewScroller" Grid.Column="0" Margin="3">
									<igRibbon:GalleryWrapPanel IsItemsHost="true"
								   MinColumns="{Binding MinColumns, RelativeSource={RelativeSource TemplatedParent}}"
								   MaxColumns="{Binding MaxColumns, RelativeSource={RelativeSource TemplatedParent}}"
/>
								</igRibbon:GalleryPreviewScroller>

								<Grid Grid.Column="1">
									<Grid.RowDefinitions>
										<RowDefinition Height="*"/>
										<RowDefinition Height="*"/>
										<RowDefinition Height="*"/>
									</Grid.RowDefinitions>

									<RepeatButton Focusable="False" Grid.Row="0" Command="igRibbon:GalleryPreviewScroller.ScrollUpCommand" CommandTarget="{Binding ElementName=galleryPreviewScroller}" Style="{StaticResource GalleryToolPreviewPresenter_ScrollUpButton}" Margin="0,-1,-1,0"/>
									<RepeatButton Focusable="False" Grid.Row="1" Command="igRibbon:GalleryPreviewScroller.ScrollDownCommand" CommandTarget="{Binding ElementName=galleryPreviewScroller}" Style="{StaticResource GalleryToolPreviewPresenter_ScrollDownButton}" Margin="0,0,-1,0"/>
									<Button x:Name="PART_DropDownButton"  Focusable="False" Grid.Row="2" Command="igRibbon:GalleryPreviewScroller.DropdownGalleryCommand" CommandTarget="{Binding ElementName=galleryPreviewScroller}"  Style="{StaticResource GalleryToolPreviewPresenter_DropDownButton}" igRibbon:XamRibbon.KeyTipPlacementType="DropDownButton" Margin="0,0,-1,-1"/>
								</Grid>
							</Grid>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>



		<!-- =================================================================== -->
		<!-- Scroll Bar, RepeatButton, ScrollBarThumb -->
		<!-- =================================================================== -->

		<!-- IncreaseRepeatButton - This is used by ScrollBar -->
        <!-- removed -  d:IsControlPart="True" -->
		<Style x:Key="GalleryToolDropDownPresenter_IncreaseRepeatButton" TargetType="{x:Type RepeatButton}" BasedOn="{x:Null}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<ControlTemplate.Resources>
							<Storyboard x:Key="Hover">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Pressed">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Pressed" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Enabled_Fade-In">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Enabled" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.3000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Enabled_Fade-Out">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Enabled" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.1000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Hover_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Pressed_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Pressed" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
						</ControlTemplate.Resources>
						<Grid Margin="1,0,0,0">
							<Grid Opacity="0" x:Name="Enabled">
								<Border x:Name="EnabledBorder" SnapsToDevicePixels="True" Visibility="Visible" CornerRadius="2,2,2,2" Opacity="1" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalBorderDarkFillKey}}" BorderThickness="1,1,1,1" Width="Auto" Height="Auto"/>
								<Border SnapsToDevicePixels="True" Visibility="Visible" x:Name="EnabledCenter" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="0,0,0,0" Opacity="1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalCenterFillKey}}" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<Grid Opacity="0" x:Name="Hover">
								<Border x:Name="HoverBorder" SnapsToDevicePixels="True" Visibility="Visible" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonHoverBorderDarkFillKey}}" CornerRadius="2,2,2,2" Opacity="1" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarHoverBorderDarkFillKey}}" Width="Auto" Height="Auto"/>
								<Border SnapsToDevicePixels="True" Visibility="Visible" x:Name="HoverCenter" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonHoverBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="0,0,0,0" Opacity="1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonHoverCenterFillKey}}" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<Grid x:Name="Pressed" Opacity="0">
								<Border x:Name="PressedBorder" Opacity="1" SnapsToDevicePixels="True" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonPressedBorderDarkFillKey}}" CornerRadius="2,2,2,2" Width="Auto" Height="Auto"/>
								<Border Opacity="1" SnapsToDevicePixels="True" x:Name="PressedCenter" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonPressedCenterFillKey}}" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonPressedBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="0,0,0,0" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<ContentPresenter SnapsToDevicePixels="True" HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Center"/>
							<Path SnapsToDevicePixels="True" Margin="0,0,0,0" VerticalAlignment="Center" Width="Auto" Height="5" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarArrowFillKey}}" Stretch="None" Data="M0,0L9,0 4.5,5z" HorizontalAlignment="Center" x:Name="path"/>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Fill" TargetName="path" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarDisabledArrowFillKey}}"/>
							</Trigger>
							<Trigger Property="IsKeyboardFocused" Value="true">
								<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalBorderDarkFillKey}}" TargetName="EnabledBorder"/>
							</Trigger>
							<Trigger Property="Tag" Value="ScrollBarMouseOverTrue">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Enabled_Fade_In_BeginStoryboard" Storyboard="{StaticResource Enabled_Fade-In}"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<BeginStoryboard x:Name="Enabled_Fade_Out_BeginStoryboard" Storyboard="{StaticResource Enabled_Fade-Out}"/>
								</Trigger.ExitActions>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="true">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Hover_BeginStoryboard" Storyboard="{StaticResource Hover}"/>
									<StopStoryboard BeginStoryboardName="Pressed_BeginStoryboard"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<StopStoryboard BeginStoryboardName="Hover_BeginStoryboard"/>
									<BeginStoryboard x:Name="Hover_FadeOut_BeginStoryboard" Storyboard="{StaticResource Hover_FadeOut}"/>
								</Trigger.ExitActions>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Pressed_BeginStoryboard" Storyboard="{StaticResource Pressed}"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<StopStoryboard BeginStoryboardName="Pressed_BeginStoryboard"/>
									<BeginStoryboard x:Name="Pressed_FadeOut_BeginStoryboard" Storyboard="{StaticResource Pressed_FadeOut}"/>
								</Trigger.ExitActions>
							</Trigger>

						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- DecreaseRepeatButton - This is used by ScrollBar -->
		<Style x:Key="GalleryToolDropDownPresenter_DecreaseRepeatButton" TargetType="{x:Type RepeatButton}" BasedOn="{x:Null}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<ControlTemplate.Resources>
							<Storyboard x:Key="Hover">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Pressed">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Pressed" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Enabled_Fade-In">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Enabled" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.3000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Enabled_Fade-Out">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Enabled" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.1000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Hover_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Pressed_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Pressed" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
						</ControlTemplate.Resources>
						<Grid Margin="1,0,0,0">
							<Grid Opacity="0" x:Name="Enabled">
								<Border x:Name="EnabledBorder" SnapsToDevicePixels="True" Visibility="Visible" CornerRadius="2,2,2,2" Opacity="1" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalBorderDarkFillKey}}" BorderThickness="1,1,1,1" Width="Auto" Height="Auto"/>
								<Border SnapsToDevicePixels="True" Visibility="Visible" x:Name="EnabledCenter" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="0,0,0,0" Opacity="1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonNormalCenterFillKey}}" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<Grid Opacity="0" x:Name="Hover">
								<Border x:Name="HoverBorder" SnapsToDevicePixels="True" Visibility="Visible" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonHoverBorderDarkFillKey}}" CornerRadius="2,2,2,2" Opacity="1" Width="Auto" Height="Auto"/>
								<Border SnapsToDevicePixels="True" Visibility="Visible" x:Name="HoverCenter" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonHoverBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="0,0,0,0" Opacity="1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonHoverCenterFillKey}}" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<Grid x:Name="Pressed" Opacity="0">
								<Border x:Name="PressedBorder" Opacity="1" SnapsToDevicePixels="True" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonPressedBorderDarkFillKey}}" CornerRadius="2,2,2,2" Width="Auto" Height="Auto"/>
								<Border Opacity="1" SnapsToDevicePixels="True" x:Name="PressedCenter" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonPressedCenterFillKey}}" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarRepeatButtonPressedBorderLightFillKey}}" BorderThickness="1,1,1,1" CornerRadius="0,0,0,0" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<ContentPresenter SnapsToDevicePixels="True" HorizontalAlignment="Center" Margin="0,0,0,0" VerticalAlignment="Center"/>
							<Path SnapsToDevicePixels="True" d:LayoutOverrides="Width" Width="Auto" Height="Auto" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarArrowFillKey}}" Stretch="None" Data="M0,5L9,5 4.5,0z" HorizontalAlignment="Center" x:Name="path" VerticalAlignment="Center"/>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Fill" TargetName="path" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarDisabledArrowFillKey}}"/>
							</Trigger>
							<Trigger Property="IsKeyboardFocused" Value="true">
								<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarBorderDarkFillKey}}" TargetName="EnabledBorder"/>
							</Trigger>
							<Trigger Property="Tag" Value="ScrollBarMouseOverTrue">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Enabled_Fade_In_BeginStoryboard" Storyboard="{StaticResource Enabled_Fade-In}"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<BeginStoryboard x:Name="Enabled_Fade_Out_BeginStoryboard" Storyboard="{StaticResource Enabled_Fade-Out}"/>
								</Trigger.ExitActions>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="true">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Hover_BeginStoryboard" Storyboard="{StaticResource Hover}"/>
									<StopStoryboard BeginStoryboardName="Pressed_BeginStoryboard"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<StopStoryboard BeginStoryboardName="Hover_BeginStoryboard"/>
									<BeginStoryboard x:Name="Hover_FadeOut_BeginStoryboard" Storyboard="{StaticResource Hover_FadeOut}"/>
								</Trigger.ExitActions>
							</Trigger>
							<Trigger Property="IsPressed" Value="True">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Pressed_BeginStoryboard" Storyboard="{StaticResource Pressed}"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<StopStoryboard BeginStoryboardName="Pressed_BeginStoryboard"/>
									<BeginStoryboard x:Name="Pressed_FadeOut_BeginStoryboard" Storyboard="{StaticResource Pressed_FadeOut}"/>
								</Trigger.ExitActions>
							</Trigger>

						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ScrollRepeatButton Style - This RepeatButton is used above and below the Thumb in the Scrollbar. They are set to transparent si that they do not show over the scrollbar -->
		<Style x:Key="GalleryToolDropDownPresenter_ScrollRepeatButton"  TargetType="{x:Type RepeatButton}">
			<Setter Property="Background" Value="Transparent"/>
			<Setter Property="BorderBrush" Value="Transparent"/>
			<Setter Property="IsTabStop" Value="false"/>
			<Setter Property="Focusable" Value="false"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type RepeatButton}">
						<Grid>
							<Rectangle Fill="{TemplateBinding Background}" Stroke="{TemplateBinding BorderBrush}" StrokeThickness="{TemplateBinding BorderThickness}"/>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- Thumb - The Thumb is the draggable part of the Scrollbar -->
		<Style x:Key="GalleryToolDropDownPresenter_ScrollbarThumb"  TargetType="{x:Type Thumb}" BasedOn="{x:Null}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Thumb}">
						<ControlTemplate.Resources>
							<Storyboard x:Key="Hover_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Hover_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Hover" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Pressed_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Pressed" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="Pressed_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="Pressed" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
						</ControlTemplate.Resources>
						<Grid Margin="1,0,0,0" x:Name="Grid">
							<Grid x:Name="Normal">
								<Rectangle x:Name="Thumb_Normal_Border" Width="Auto" Height="Auto" RadiusX="2" RadiusY="2" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarBorderDarkFillKey}}" Opacity="1"/>
								<Rectangle SnapsToDevicePixels="True" x:Name="Thumb_Normal_Center" RadiusX="0" RadiusY="0" Margin="1,1,1,1" Width="Auto" Height="Auto" Opacity="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarCenterFillKey}}" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarBorderLightFillKey}}"/>
							</Grid>
							<Grid Opacity="0" x:Name="Hover">
								<Rectangle Opacity="1" SnapsToDevicePixels="True" x:Name="Thumb_Hover_Border" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarHoverBorderDarkFillKey}}" RadiusX="2" RadiusY="2" Width="Auto" Height="Auto"/>
								<Rectangle Opacity="1" SnapsToDevicePixels="True" x:Name="Thumb_Hover_Center" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarHoverCenterFillKey}}" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarHoverBorderLightFillKey}}" RadiusX="0" RadiusY="0" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<Grid Opacity="0" x:Name="Pressed">
								<Rectangle Opacity="1" SnapsToDevicePixels="True" x:Name="Thumb_Pressed_Border" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarPressedBorderDarkFillKey}}" RadiusX="2" RadiusY="2" Width="Auto" Height="Auto"/>
								<Rectangle Opacity="1" SnapsToDevicePixels="True" x:Name="Thumb_Pressed_Center" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarPressedCenterFillKey}}" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarPressedBorderLightFillKey}}" RadiusX="0" RadiusY="0" Margin="1,1,1,1" Width="Auto" Height="Auto"/>
							</Grid>
							<Grid x:Name="ScrollbarGripper" Background="#00ffffff" HorizontalAlignment="Center" VerticalAlignment="Center" Width="8" Height="8">
								<Path
							Margin="0,0,0,0"
							HorizontalAlignment="Left"
							VerticalAlignment="Top"
							Height="7"
							Width="8"
							Stretch="Fill"
							Opacity="0.7490196078431373"
							Data="M 0,6 C0,6 0,7 0,7 0,7 8,7 8,7 8,7 8,6 8,6 8,6 0,6 0,6 zM 0,4 C0,4 0,5 0,5 0,5 8,5 8,5 8,5 8,4 8,4 8,4 0,4 0,4 zM 0,2 C0,2 0,3 0,3 0,3 8,3 8,3 8,3 8,2 8,2 8,2 0,2 0,2 zM 0,0 C0,0 0,1 0,1 0,1 8,1 8,1 8,1 8,0 8,0 8,0 0,0 0,0 z"
							StrokeThickness="1"
							Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarThumbGripperForegroundFillKey}}" SnapsToDevicePixels="True" />
								<Path
							Margin="2,1,0,0"
							HorizontalAlignment="Left"
							VerticalAlignment="Top"
							Height="7"
							Width="6"
							Stretch="Fill"
							Opacity="0.34901960784313724"
							Data="M 2,7 C2,7 2,8 2,8 2,8 8,8 8,8 8,8 8,7 8,7 8,7 2,7 2,7 zM 2,5 C2,5 2,6 2,6 2,6 8,6 8,6 8,6 8,5 8,5 8,5 2,5 2,5 zM 2,3 C2,3 2,4 2,4 2,4 8,4 8,4 8,4 8,3 8,3 8,3 2,3 2,3 zM 2,1 C2,1 2,2 2,2 2,2 8,2 8,2 8,2 8,1 8,1 8,1 2,1 2,1 z"
							Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarThumbGripperBackgroundFillKey}}" SnapsToDevicePixels="True" />
							</Grid>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="IsDragging" Value="True">
								<Trigger.EnterActions>
									<BeginStoryboard x:Name="Pressed_FadeIn_BeginStoryboard" Storyboard="{StaticResource Pressed_FadeIn}"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<BeginStoryboard x:Name="Pressed_FadeOut_BeginStoryboard" Storyboard="{StaticResource Pressed_FadeOut}"/>
								</Trigger.ExitActions>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Trigger.EnterActions>
									<BeginStoryboard Storyboard="{StaticResource Hover_FadeIn}"/>
								</Trigger.EnterActions>
								<Trigger.ExitActions>
									<BeginStoryboard x:Name="Hover_FadeOut_BeginStoryboard" Storyboard="{StaticResource Hover_FadeOut}"/>
								</Trigger.ExitActions>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ScrollBar  This makes use of Thumb, IncreaseRepeatButton, DecreaseRepeatButton and ScrollRepeatButton -->

		<Style x:Key="GalleryToolDropDownPresenter_Scrollbar" TargetType="{x:Type ScrollBar}">
			<Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
			<Setter Property="Foreground" Value="{x:Null}"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ScrollBar}">
						<ControlTemplate.Resources>
							<Storyboard x:Key="hover">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="DecreaseRepeat" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="PART_Track" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="IncreaseRepeat" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="fade">
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="DecreaseRepeat" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0.5"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="PART_Track" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0.5"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="IncreaseRepeat" Storyboard.TargetProperty="(UIElement.Opacity)">
									<SplineDoubleKeyFrame KeyTime="00:00:00.2000000" Value="0.5"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
						</ControlTemplate.Resources>
						<Grid x:Name="GridRoot" Width="{StaticResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}">
							<Grid.RowDefinitions>
								<RowDefinition MaxHeight="18"/>
								<RowDefinition Height="0.00001*"/>
								<RowDefinition MaxHeight="18"/>
							</Grid.RowDefinitions>

							<Rectangle SnapsToDevicePixels="True" Margin="0,0,0,0" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarTrackBorderDarkFillKey}}" Grid.RowSpan="3" x:Name="rectangle"/>
							<Rectangle SnapsToDevicePixels="True" Margin="1,0,0,0" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarTrackBorderLightFillKey}}" Grid.RowSpan="3"/>
							<Rectangle SnapsToDevicePixels="True" Margin="2,0,0,0" Grid.RowSpan="3" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarTrackCenterFillKey}}"/>

							<RepeatButton x:Name="DecreaseRepeat" Focusable="False" Style="{StaticResource GalleryToolDropDownPresenter_DecreaseRepeatButton}" Command="ScrollBar.LineUpCommand" Background="{x:Null}" BorderBrush="{x:Null}" Tag="ScrollBarMouseOverFalse">
								<Grid>
									<Path SnapsToDevicePixels="True" d:LayoutOverrides="Width" HorizontalAlignment="Left" Margin="0,0,0,0" VerticalAlignment="Top" Width="Auto" Height="Auto" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterScrollBarArrowFillKey}}" Stretch="None" Data="M0,5L9,5 4.5,0z"/>
								</Grid>
							</RepeatButton>

							<!-- Track is a special layout container which sizes the thumb and the repeat button which do jump scrolling either side of it -->
							<Track Grid.Row="1" x:Name="PART_Track" Orientation="Vertical" IsDirectionReversed="true">
								<Track.Thumb>
									<Thumb Style="{StaticResource GalleryToolDropDownPresenter_ScrollbarThumb}"/>
								</Track.Thumb>
								<Track.IncreaseRepeatButton>
									<RepeatButton x:Name="PageUp" Focusable="False" Style="{StaticResource GalleryToolDropDownPresenter_ScrollRepeatButton}" Command="ScrollBar.PageDownCommand"/>
								</Track.IncreaseRepeatButton>
								<Track.DecreaseRepeatButton>
									<RepeatButton x:Name="PageDown" Focusable="False" Style="{StaticResource GalleryToolDropDownPresenter_ScrollRepeatButton}" Command="ScrollBar.PageUpCommand"/>
								</Track.DecreaseRepeatButton>
							</Track>

							<RepeatButton Grid.Row="2" x:Name="IncreaseRepeat" Focusable="False" Style="{StaticResource GalleryToolDropDownPresenter_IncreaseRepeatButton}" Command="ScrollBar.LineDownCommand" Background="{x:Null}" BorderBrush="{x:Null}" Tag="ScrollBarMouseOverFalse"/>
						</Grid>

						<!-- This uses a single template for ScrollBar and rotate it to be Horizontal
It also changes the commands so that the it does Left and Right instead of Up and Down Commands -->
						<ControlTemplate.Triggers>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Tag" TargetName="DecreaseRepeat" Value="ScrollBarMouseOverTrue"/>
								<Setter Property="Tag" TargetName="IncreaseRepeat" Value="ScrollBarMouseOverTrue"/>
							</Trigger>
							<EventTrigger RoutedEvent="Mouse.MouseEnter" SourceName="rectangle"/>
							<Trigger Property="IsEnabled" SourceName="DecreaseRepeat" Value="True"/>
							<Trigger Property="Orientation" Value="Horizontal">

								<!-- Rotate the ScrollBar from Vertical to Horizontal -->
								<Setter Property="LayoutTransform" TargetName="GridRoot">
									<Setter.Value>
										<RotateTransform Angle="-90"/>
									</Setter.Value>
								</Setter>

								<!-- Track is bound to Orientation internally, so we need to rotate it back to Vertical -->
								<Setter TargetName="PART_Track" Property="Orientation" Value="Vertical"/>

								<!-- Change the commands to do Horizontal commands -->
								<Setter Property="Command" Value="ScrollBar.LineLeftCommand" TargetName="DecreaseRepeat"/>
								<Setter Property="Command" Value="ScrollBar.LineRightCommand" TargetName="IncreaseRepeat"/>
								<Setter Property="Command" Value="ScrollBar.PageLeftCommand" TargetName="PageDown"/>
								<Setter Property="Command" Value="ScrollBar.PageRightCommand" TargetName="PageUp"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Background" Value="{x:Null}"/>
		</Style>

		<!-- ScrollViewer Styles for the GalleryToolDropDownPresenter -->
		<Style x:Key="GalleryToolDropDownPresenter_ScrollViewer" TargetType="{x:Type ScrollViewer}" BasedOn="{x:Null}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ScrollViewer}">
						<Grid Background="{DynamicResource MenuBackgroundGradient}">
							<Grid.ColumnDefinitions>
								<ColumnDefinition Width="*"/>
								<ColumnDefinition Width="Auto"/>
							</Grid.ColumnDefinitions>
							<Grid.RowDefinitions>
								<RowDefinition Height="*"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>
							<ScrollContentPresenter Grid.Column="0" Grid.Row="0" Margin="{TemplateBinding Padding}" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" CanContentScroll="{TemplateBinding CanContentScroll}"/>

							<!-- The visibility of the ScrollBars is controlled by the implementation fo the control -->
							<ScrollBar Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" Grid.Column="0" Grid.Row="1" x:Name="PART_HorizontalScrollBar" Style="{StaticResource GalleryToolDropDownPresenter_Scrollbar}" Orientation="Horizontal" Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportWidth}" Minimum="0" Maximum="{TemplateBinding ScrollableWidth}" AutomationProperties.AutomationId="HorizontalScrollBar"/>
							<ScrollBar Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" Grid.Column="1" Grid.Row="0" x:Name="PART_VerticalScrollBar" Style="{StaticResource GalleryToolDropDownPresenter_Scrollbar}" Orientation="Vertical" Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" ViewportSize="{TemplateBinding ViewportHeight}" Minimum="0" Maximum="{TemplateBinding ScrollableHeight}" AutomationProperties.AutomationId="VerticalScrollBar"/>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>



		<!-- =================================================================== -->
		<!-- GalleryToolDropDownPresenter Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:GalleryToolDropDownPresenter}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:GalleryToolDropDownPresenter}">
						<Border
						x:Name="Background"
						Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterCenterFillKey}}"
						SnapsToDevicePixels="True"
						HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
							<Grid>
								<Grid.RowDefinitions>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="*"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>

								<!-- JJD 11/8/07 added pre separator, visibility triggered off IsFirstInMenu property -->
								<Rectangle
				  x:Name="PreGallerySeparator"
				  Grid.Row="0" 
				  Height="1" 
				  Fill ="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterBorderFillKey}}"
				  Visibility="Collapsed"
					/>

								<!-- JJD 11/1/07 - BR27851 - Set CanContentScroll to false to enable pixel level scrolling -->
								<ScrollViewer
				  Grid.Row="1" 
				  Margin="0,0,0,0"
				  CanContentScroll="false"
				  Focusable="false"
				  HorizontalScrollBarVisibility="Disabled"
				  VerticalScrollBarVisibility="{TemplateBinding VerticalScrollBarVisibility}"
				  Style="{StaticResource GalleryToolDropDownPresenter_ScrollViewer}">
									<ItemsPresenter/>
								</ScrollViewer>

								<!-- JJD 11/8/07 added post separator, visibility triggered off IsLastInMenu property -->
								<Rectangle
				  x:Name="PostGallerySeparator"
				  Height="1" 
				  Grid.Row="2"
				  Fill ="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterBorderFillKey}}"
				  Visibility="Collapsed"
					/>
							</Grid>
						</Border>
						<ControlTemplate.Triggers>
							<!-- JJD 11/8/07 added pre separator, visibility triggered off IsFirstInMenu property -->
							<Trigger Property="IsFirstInMenu" Value="False">
								<Setter TargetName="PreGallerySeparator" Property="Visibility" Value="Visible"/>
							</Trigger>
							<!-- JJD 11/8/07 added post separator, visibility triggered off IsLastInMenu property -->
							<Trigger Property="IsLastInMenu" Value="False">
								<Setter TargetName="PostGallerySeparator" Property="Visibility" Value="Visible"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- GalleryItemGroup Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:GalleryItemGroup}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:GalleryItemGroup}">
						<Grid>
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="*"/>
							</Grid.RowDefinitions>
							<Border
						x:Name="Caption"
						SnapsToDevicePixels="True"
						Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionFillKey}}"
						BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}"
						BorderThickness="0,0,0,1"
						CornerRadius="2,2,0,0"
						Padding="11,2,0,1">
								<TextBlock Foreground="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextNormalForegroundFillKey}}" Grid.Row="0" FontWeight="Bold" Text="{TemplateBinding Title}"/>
							</Border>
							<igRibbon:GalleryWrapPanel Grid.Row="1" 
							MinColumns="{Binding GalleryTool.MinDropDownColumns, RelativeSource={RelativeSource TemplatedParent}}"
							MaxColumns="{Binding GalleryTool.MaxDropDownColumns, RelativeSource={RelativeSource TemplatedParent}}"
							PreferredColumns="{Binding GalleryTool.PreferredDropDownColumns, RelativeSource={RelativeSource TemplatedParent}}"
							IsItemsHost="True"/>
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- GalleryTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:GalleryTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:GalleryTool}">
						<Border>
							<!-- AS 11/14/07 BR28450 
								The namescope was broken because the recordlistcontrol was not in the logical tree. We 
								need to use a ContentControl instead so the content	is made a logical child. -->
							<ContentControl x:Name="PART_DropDownPresenterSite"/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- StatusBar Style -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonWindowContentHost.StatusBarStyleKey}" TargetType="{x:Type StatusBar}">
			<!--<Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}"/>-->
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.StatusBarBorderFillKey}}"/>
			<Setter Property="BorderThickness" Value="0,1"/>
			<Setter Property="Border.CornerRadius" Value="0,0,3,3"/>
			<Setter Property="FocusManager.IsFocusScope" Value="True"/>
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.StatusBarTextForegroundFillKey}}"/>
			<Setter Property="FontFamily" Value="{DynamicResource {x:Static SystemFonts.StatusFontFamilyKey}}"/>
			<Setter Property="FontSize" Value="{DynamicResource {x:Static SystemFonts.StatusFontSizeKey}}"/>
			<Setter Property="FontStyle" Value="{DynamicResource {x:Static SystemFonts.StatusFontStyleKey}}"/>
			<Setter Property="FontWeight" Value="{DynamicResource {x:Static SystemFonts.StatusFontWeightKey}}"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type StatusBar}">
						<Grid x:Name="StatusBar">
							<Border x:Name="StatusBar_BackgroundLayer" SnapsToDevicePixels="True" CornerRadius="{TemplateBinding Border.CornerRadius}" Background="{DynamicResource MenuBackgroundGradient}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}"/>
							<!-- AS 12/2/09 TFS24267
							Added Margin binding to a new property on RibbonWindowContentHost that returns a thickness
							which provides the border extent. Note since someone may be using the Padding to add additional 
							space I'm not binding the actual padding property of the statusbar to this property. -->
							<!-- AS 12/3/09 TFS24545 
							Removed hard coded padding which accounted for size grip and conditionally 
							included the required extent in the StatusBarPadding -->
							<Border Padding="{Binding (igRibbon:RibbonWindowContentHost.ContentHost).(StatusBar.Padding), RelativeSource={RelativeSource Self}}">
								<ItemsPresenter OpacityMask="{x:Null}" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Width="Auto" Height="Auto" Margin="{TemplateBinding Padding}" />
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<DataTrigger Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" >
								<Setter Property="CornerRadius" TargetName="StatusBar_BackgroundLayer" Value="0,0,0,0" />
							</DataTrigger>

							<DataTrigger Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized">
								<Setter Property="CornerRadius" TargetName="StatusBar_BackgroundLayer" Value="0,0,0,0" />
							</DataTrigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsScenicTheme, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:RibbonWindowContentHost}, 1}}" Value="True" >
					<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}" />
					<Setter Property="BorderBrush"  Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ScenicStatusBarBorderFillKey}}" />
					<Setter Property="Foreground"  Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ScenicStatusBarTextForegroundFillKey}}" />
					<Setter Property="BorderThickness" Value="0,1,0,0"/>
					<Setter Property="Border.CornerRadius" Value="0"/>
				</DataTrigger>
			</Style.Triggers>
		</Style>


		<!-- =================================================================== -->
		<!-- StatusBarItem Style -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonWindowContentHost.StatusBarItemStyleKey}"
	TargetType="{x:Type StatusBarItem}">
			<Setter Property="BorderThickness" Value="0,0,0,0"/>
			<Setter Property="Padding" Value="3,3,3,3"/>
			<Setter Property="Background" Value="{x:Null}"/>
			<Setter Property="HorizontalContentAlignment" Value="Left"/>
			<Setter Property="VerticalContentAlignment" Value="Center"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type StatusBarItem}">
						<Border BorderBrush="{TemplateBinding BorderBrush}"
					BorderThickness="{TemplateBinding BorderThickness}"
					Background="{DynamicResource MenuBackgroundGradient}"
					SnapsToDevicePixels="True"
					Padding="{TemplateBinding Padding}">
							<ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
						VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
						SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
						ContentTemplate="{TemplateBinding ContentTemplate}"
						Content="{TemplateBinding Content}" />
						</Border>
						<ControlTemplate.Triggers>
							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.StatusBarTextForegroundFillKey}}"/>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsScenicTheme, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:RibbonWindowContentHost}, 1}}" Value="True" >
					<Setter Property="Foreground"  Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ScenicStatusBarTextForegroundFillKey}}" />
				</DataTrigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- StatusBar Separator Style -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonWindowContentHost.StatusBarSeparatorStyleKey}"
	TargetType="{x:Type Separator}">
			<!--<Setter Property="Background" Value="{DynamicResource {x:Static SystemColors.ControlDarkBrushKey}}"/>-->
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}"/>
			<Setter Property="Margin" Value="2,0,2,0"/>
			<Setter Property="Focusable" Value="False"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type Separator}">
						<Border
					Width="2"
					BorderBrush="{TemplateBinding BorderBrush}"
					BorderThickness="{TemplateBinding BorderThickness}"
					Background="{DynamicResource MenuBackgroundGradient}"
					SnapsToDevicePixels="True" Margin="0,1,0,0" />
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Foreground" Value="{x:Null}"/>
			<Setter Property="BorderThickness" Value="0,0,1,0"/>
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.StatusBarSeparatorGradientLeftKey}}"/>
			<Style.Triggers>
				<DataTrigger Binding="{Binding IsScenicTheme, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:RibbonWindowContentHost}, 1}}" Value="True" >
					<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}" />
					<Setter Property="BorderBrush"  Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ScenicStatusBarSeparatorGradientLeftKey}}" />
				</DataTrigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- RibbonGroup Collapsed Toggle Button Style -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonGroup.CollapsedGroupButtonStyleKey}"
	TargetType="{x:Type igRibbon:DropDownToggle}">
			<Setter Property="Background" Value="{DynamicResource MenuBackgroundGradient}" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:DropDownToggle}">
						<igWindows:CardPanel d:LayoutOverrides="Height" Background="{DynamicResource MenuBackgroundGradient}" Margin="0,0,0,1">
							<Rectangle x:Name="BorderDark" HorizontalAlignment="Stretch" Margin="0,0,0,0" Width="Auto" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedNormalBorderDarkFillKey}}" RadiusX="2" RadiusY="2" SnapsToDevicePixels="True"/>
							<Rectangle x:Name="BorderLight" SnapsToDevicePixels="True" HorizontalAlignment="Stretch" Margin="1,1,1,1" Width="Auto" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedNormalBorderLightFillKey}}" RadiusX="1" RadiusY="1"/>
							<Rectangle x:Name="BaseColorBorderLight" StrokeThickness="2"  SnapsToDevicePixels="True" Margin="1,1,1,1" Height="Auto" Width="Auto"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" RadiusX="1" RadiusY="1" Visibility="Collapsed">
								<!--JJD 12/11/07 moved setting to Trigger if IsInContextualTabGroup == true -->
								<!--<Rectangle.Stroke>
								<SolidColorBrush Color="{Binding Path=ContextualTabGroup.BaseBackColorResolved, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:RibbonGroup}, 1}}"/>
							</Rectangle.Stroke>-->
								<Rectangle.OpacityMask>
									<LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
										<GradientStop Color="#00000000" Offset="0"/>
										<GradientStop Color="#26FFFFFF" Offset="0.4"/>
										<GradientStop Color="#7FFFFFFF" Offset="0.75"/>
										<GradientStop Color="#FFFFFFFF" Offset="1"/>
									</LinearGradientBrush>
								</Rectangle.OpacityMask>
							</Rectangle>
							<Rectangle SnapsToDevicePixels="True" HorizontalAlignment="Stretch" Margin="1,1,1,1" x:Name="IsActive_Highlight" Width="Auto" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsActiveHighlightFillKey}}" RadiusX="1" RadiusY="1" Visibility="Collapsed"/>
							<Border SnapsToDevicePixels="True" Margin="2,1,2,2" x:Name="CenterFill" Background="{DynamicResource MenuBackgroundGradient}" CornerRadius="1,1,1,1"/>
							<Rectangle SnapsToDevicePixels="True" Visibility="Collapsed" HorizontalAlignment="Stretch" Margin="1,1,1,1" x:Name="Pressed_Highlight" Width="Auto" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedPressedHighlightFillKey}}"/>
							<Border SnapsToDevicePixels="True" HorizontalAlignment="Stretch" Margin="2,2,2,2">
								<StackPanel>
									<Border x:Name="InnerArea" SnapsToDevicePixels="True" CornerRadius="3" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaNormalBorderFillKey}}" Background="{DynamicResource MenuBackgroundGradient}" BorderThickness="1" Padding="0"
								HorizontalAlignment="Center" Margin="0,3,0,3">
										<Grid Width="Auto" Height="Auto">
											<Border x:Name="InnerAreaBottom" HorizontalAlignment="Stretch" Margin="0" VerticalAlignment="Bottom" Height="7" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaNormalBottomGradientFillKey}}" CornerRadius="0,0,2,2"/>
											<igWindows:AutoDisabledImage x:Name="image" Margin="8,5,7,10" Width="16" Height="16" Source="{Binding (igRibbon:RibbonGroup.SmallImage), RelativeSource={x:Static RelativeSource.TemplatedParent}}"
											igWindows:Utilities.SnapElementToDevicePixels="True"
											igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}" />
										</Grid>
									</Border>
									<igRibbon:LargeToolCaptionPresenter 
									x:Name="Caption"
									HorizontalAlignment="Center"
									igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"
									Text="{Binding (igRibbon:RibbonGroup.Caption), RelativeSource={x:Static RelativeSource.TemplatedParent}}">
										<igRibbon:LargeToolCaptionPresenter.Glyph>
											<Control x:Name="largeCaptionGlyph"  Margin="0,4,0,0" Style="{DynamicResource {x:Static igRibbon:MenuTool.MenuToolDropDownArrowStyleKey}}" />
										</igRibbon:LargeToolCaptionPresenter.Glyph>
									</igRibbon:LargeToolCaptionPresenter>
								</StackPanel>
							</Border>
						</igWindows:CardPanel>
						<ControlTemplate.Triggers>
							<Trigger Property="igRibbon:XamRibbon.IsActive" Value="True">
								<Setter Property="Visibility" TargetName="IsActive_Highlight" Value="Visible"/>
								<Setter Property="Stroke" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsActiveBorderDarkFillKey}}"/>
								<Setter Property="Fill" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsActiveBorderLightFillKey}}"/>
								<Setter Property="Background" TargetName="CenterFill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsActiveCenterFillKey}}"/>
								<Setter Property="Background" TargetName="InnerAreaBottom" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaIsActiveBottomGradientFillKey}}"/>
								<Setter Property="Background" TargetName="InnerArea" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaIsActiveCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="InnerArea" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaIsActiveBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</Trigger>
							<Trigger Property="IsDroppedDown" Value="True">
								<Setter Property="Stroke" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedPressedBorderDarkFillKey}}"/>
								<Setter Property="Visibility" TargetName="Pressed_Highlight" Value="Visible"/>
								<Setter Property="RadiusX" TargetName="Pressed_Highlight" Value="1"/>
								<Setter Property="RadiusY" TargetName="Pressed_Highlight" Value="1"/>
								<Setter Property="Fill" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedPressedBorderLightFillKey}}"/>
								<Setter Property="Background" TargetName="CenterFill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedPressedCenterFillKey}}"/>
								<Setter Property="Background" TargetName="InnerAreaBottom" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaPressedBottomGradientFillKey}}"/>
								<Setter Property="Background" TargetName="InnerArea" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaPressedCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="InnerArea" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaPressedBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Stroke" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedHoverBorderDarkFillKey}}"/>
								<Setter Property="Fill" TargetName="BorderLight" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedHoverBorderLightFillKey}}"/>
								<Setter Property="Background" TargetName="CenterFill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedHoverCenterFillKey}}"/>
								<Setter Property="Background" TargetName="InnerAreaBottom" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaHoverBottomGradientFillKey}}"/>
								<Setter Property="Background" TargetName="InnerArea" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="InnerArea" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedInnerAreaHoverBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</Trigger>

							<!-- Triggers for when IsInContextualTabGroup -->

							<Trigger Property="igRibbon:RibbonGroup.IsInContextualTabGroup" Value="True">
								<Setter Property="Stroke" TargetName="BaseColorBorderLight" 
				Value="{Binding ContextualTabGroup.BaseBackColorResolved, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:RibbonGroup}, 1}}"/>

							</Trigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="igRibbon:XamRibbon.IsActive" Value="True"/>
									<Condition Property="igRibbon:RibbonGroup.IsInContextualTabGroup" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Visible"/>
								<Setter Property="Visibility" TargetName="CenterFill" Value="Visible"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="igRibbon:XamRibbon.IsActive" Value="False"/>
									<Condition Property="igRibbon:RibbonGroup.IsInContextualTabGroup" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter Property="Stroke" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsInContextualNormalBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsInContextualNormalCenterFillKey}}"/>
								<Setter Property="Visibility" TargetName="IsActive_Highlight" Value="Collapsed"/>
								<Setter Property="Visibility" TargetName="Pressed_Highlight" Value="Collapsed"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Collapsed"/>
								<Setter Property="Visibility" TargetName="CenterFill" Value="Collapsed"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="igRibbon:RibbonGroup.IsInContextualTabGroup" Value="True"/>
									<Condition Property="IsMouseOver" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="BorderDark" Property="Stroke" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsInContextualHoverBorderFillKey}}"/>
								<Setter TargetName="CenterFill" Property="Background" Value="Transparent"/>
								<Setter TargetName="CenterFill" Property="CornerRadius" Value="0,3,3,0"/>
								<Setter TargetName="CenterFill" Property="BorderThickness" Value="0,0,1,1"/>
								<Setter TargetName="CenterFill" Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsInContextualHoverBorderFillKey}}"/>
								<Setter TargetName="CenterFill" Property="Visibility" Value="Visible" />
								<Setter TargetName="BaseColorBorderLight" Property="Visibility" Value="Visible"/>
								<Setter TargetName="IsActive_Highlight" Property="Visibility" Value="Collapsed"/>
								<Setter TargetName="Pressed_Highlight" Property="Visibility" Value="Collapsed"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="igRibbon:RibbonGroup.IsInContextualTabGroup" Value="True"/>
									<Condition Property="IsDroppedDown" Value="True"/>
								</MultiTrigger.Conditions>
								<Setter Property="Stroke" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsInContextualPressedBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="BorderDark" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupCollapsedIsInContextualPressedCenterFillKey}}"/>
								<Setter Property="Visibility" TargetName="IsActive_Highlight" Value="Collapsed"/>
								<Setter Property="Visibility" TargetName="Pressed_Highlight" Value="Collapsed"/>
								<Setter Property="Visibility" TargetName="BorderLight" Value="Collapsed"/>
								<Setter Property="Visibility" TargetName="CenterFill" Value="Collapsed"/>
							</MultiTrigger>
							<!-- END Triggers for when IsInContextualTabGroup -->

						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- RibbonGroup Qat Toggle Button Style -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonGroup.QuickAccessToolbarGroupButtonStyleKey}"
	TargetType="{x:Type igRibbon:DropDownToggle}">
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:DropDownToggle}">
						<!-- The element is shifted up by 2 to meet fitt's law -->
						<Grid x:Name="RibbonGroupQAT" Background="#00ffffff" Margin="0,-2,0,0">
							<Rectangle
						x:Name="BorderAndInnerBorder"
						Opacity="1"
						HorizontalAlignment="Stretch"
						VerticalAlignment="Stretch"
						Margin="0,2,0,0"
						Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATNormalCenterFillKey}}" SnapsToDevicePixels="True" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATBorderDarkFillKey}}" RadiusX="3" RadiusY="3" />
							<Rectangle
						Opacity="1"
						HorizontalAlignment="Stretch"
						VerticalAlignment="Stretch"
						Margin="1,3,1,1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHover2InnerBorderFillKey}}" SnapsToDevicePixels="True" Visibility="Collapsed" x:Name="rectangle" Stroke="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHover1InnerBorderFillKey}}" RadiusX="2" RadiusY="2"/>
							<Border SnapsToDevicePixels="True" Margin="2,4,2,2" x:Name="border" BorderThickness="1,1,1,1" CornerRadius="1,1,1,1">
								<igWindows:AutoDisabledImage x:Name="image" Source="{Binding (igRibbon:RibbonGroup.SmallImage), RelativeSource={x:Static RelativeSource.TemplatedParent}}" igRibbon:XamRibbon.KeyTipPlacementType="SmallImage" 
								igWindows:Utilities.SnapElementToDevicePixels="True" />
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="igRibbon:XamRibbon.IsActive" Value="True">
								<Setter Property="Visibility" TargetName="rectangle" Value="Visible"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHover3InnerBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True">
								<Setter Property="Visibility" TargetName="rectangle" Value="Visible"/>
								<Setter TargetName="BorderAndInnerBorder" Property="Stroke" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHoverBorderDarkFillKey}}"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATHover3InnerBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsDroppedDown" Value="True">
								<Setter Property="Visibility" TargetName="rectangle" Value="Visible"/>
								<Setter Property="Stroke" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATPressed1InnerBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATPressed2InnerBorderFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border" Value="{x:Null}"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATPressedCenterFillKey}}"/>
							</Trigger>
							<DataTrigger Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True">
								<Setter TargetName="BorderAndInnerBorder" Property="Stroke" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATVistaNormalBorderDarkFillKey}}"/>
							</DataTrigger>

							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource TemplatedParent}}" Value="True" />
								</MultiDataTrigger.Conditions>
								<Setter Property="Visibility" TargetName="rectangle" Value="Visible"/>
								<Setter Property="Visibility" TargetName="border" Value="Visible"/>
								<Setter TargetName="BorderAndInnerBorder" Property="Stroke" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATVistaHoverBorderDarkFillKey}}"/>
								<Setter Property="Stroke" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATVistaHover1InnerBorderFillKey}}"/>
								<Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATVistaHover2InnerBorderFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATVistaHover3InnerBorderFillKey}}"/>
								<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.RibbonGroupQATVistaHoverCenterFillKey}}"/>
							</MultiDataTrigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>


		<!-- =================================================================== -->
		<!-- ResizeGrip -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonWindowContentHost.ResizeGripStyleKey}"
	TargetType="{x:Type ResizeGrip}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate>
						<Grid x:Name="ResizeGrippers" Background="#00ffffff">
							<Path
						Margin="1,1,0,0"
						HorizontalAlignment="Left"
						VerticalAlignment="Top"
						Height="10"
						Width="10"
						Stretch="Fill"
						Opacity="1"
						Data="M 9,9 C9,9 9,11 9,11 9,11 11,11 11,11 11,11 11,9 11,9 11,9 9,9 9,9 zM 5,9 C5,9 5,11 5,11 5,11 7,11 7,11 7,11 7,9 7,9 7,9 5,9 5,9 zM 1,9 C1,9 1,11 1,11 1,11 3,11 3,11 3,11 3,9 3,9 3,9 1,9 1,9 zM 5,5 C5,5 5,7 5,7 5,7 7,7 7,7 7,7 7,5 7,5 7,5 5,5 5,5 zM 9,5 C9,5 9,7 9,7 9,7 11,7 11,7 11,7 11,5 11,5 11,5 9,5 9,5 zM 9,1 C9,1 9,3 9,3 9,3 11,3 11,3 11,3 11,1 11,1 11,1 9,1 9,1 z"
						Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ResizeGrippersBackgroundFillKey}}" SnapsToDevicePixels="True" />
							<Path
						Margin="0,0,0,0"
						HorizontalAlignment="Left"
						VerticalAlignment="Top"
						Height="10"
						Width="10"
						Stretch="Fill"
						Opacity="1"
						Data="M 8,8 C8,8 8,10 8,10 8,10 10,10 10,10 10,10 10,8 10,8 10,8 8,8 8,8 zM 4,8 C4,8 4,10 4,10 4,10 6,10 6,10 6,10 6,8 6,8 6,8 4,8 4,8 zM 0,8 C0,8 0,10 0,10 0,10 2,10 2,10 2,10 2,8 2,8 2,8 0,8 0,8 zM 4,4 C4,4 4,6 4,6 4,6 6,6 6,6 6,6 6,4 6,4 6,4 4,4 4,4 zM 8,4 C8,4 8,6 8,6 8,6 10,6 10,6 10,6 10,4 10,4 10,4 8,4 8,4 zM 8,0 C8,0 8,2 8,2 8,2 10,2 10,2 10,2 10,0 10,0 10,0 8,0 8,0 z"
						Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ResizeGrippersForegroundFillKey}}" SnapsToDevicePixels="True" />
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>



		<!-- =================================================================== -->
		<!-- ScenicResizeGrip -->
		<!-- =================================================================== -->
		<Style x:Key="{x:Static igRibbon:RibbonWindowContentHost.ScenicResizeGripStyleKey}"
	TargetType="{x:Type ResizeGrip}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate>
						<Grid x:Name="ResizeGrippers" Background="#00ffffff">
							<Path
						Margin="1,1,0,0"
						HorizontalAlignment="Left"
						VerticalAlignment="Top"
						Height="10"
						Width="10"
						Stretch="Fill"
						Opacity="1"
						Data="M 9,9 C9,9 9,11 9,11 9,11 11,11 11,11 11,11 11,9 11,9 11,9 9,9 9,9 zM 5,9 C5,9 5,11 5,11 5,11 7,11 7,11 7,11 7,9 7,9 7,9 5,9 5,9 zM 1,9 C1,9 1,11 1,11 1,11 3,11 3,11 3,11 3,9 3,9 3,9 1,9 1,9 zM 5,5 C5,5 5,7 5,7 5,7 7,7 7,7 7,7 7,5 7,5 7,5 5,5 5,5 zM 9,5 C9,5 9,7 9,7 9,7 11,7 11,7 11,7 11,5 11,5 11,5 9,5 9,5 zM 9,1 C9,1 9,3 9,3 9,3 11,3 11,3 11,3 11,1 11,1 11,1 9,1 9,1 z"
						Fill="{DynamicResource MenuBackgroundGradient}" SnapsToDevicePixels="True" />
							<Path
						Margin="0,0,0,0"
						HorizontalAlignment="Left"
						VerticalAlignment="Top"
						Height="10"
						Width="10"
						Stretch="Fill"
						Opacity="1"
						Data="M 8,8 C8,8 8,10 8,10 8,10 10,10 10,10 10,10 10,8 10,8 10,8 8,8 8,8 zM 4,8 C4,8 4,10 4,10 4,10 6,10 6,10 6,10 6,8 6,8 6,8 4,8 4,8 zM 0,8 C0,8 0,10 0,10 0,10 2,10 2,10 2,10 2,8 2,8 2,8 0,8 0,8 zM 4,4 C4,4 4,6 4,6 4,6 6,6 6,6 6,6 6,4 6,4 6,4 4,4 4,4 zM 8,4 C8,4 8,6 8,6 8,6 10,6 10,6 10,6 10,4 10,4 10,4 8,4 8,4 zM 8,0 C8,0 8,2 8,2 8,2 10,2 10,2 10,2 10,0 10,0 10,0 8,0 8,0 z"
						Fill="{DynamicResource MenuBackgroundGradient}" SnapsToDevicePixels="True" />
						</Grid>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>


		<!-- =================================================================== -->
		<!-- XamRibbonScreenTip -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:XamRibbonScreenTip}">
			<Style.Resources>
				<DataTemplate DataType="{x:Type sys:String}">
					<TextBlock TextWrapping="Wrap" Text="{Binding}" />
				</DataTemplate>
			</Style.Resources>

			<Setter Property="Foreground" Value="#EE000000"/>
			<Setter Property="FontFamily" Value="Segoe UI"/>
			<Setter Property="FontSize" Value="11"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamScreenTipBorderFillKey}}"/>
			<Setter Property="Width" Value="210"/>
			<Setter Property="MinHeight" Value="50"/>

			<!-- JM BR27833 10-26-07 -->
			<!--<Setter Property="FooterSeparatorVisibility" Value="Collapsed"/>-->

			<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamScreenTipFillKey}}"/>

			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:XamRibbonScreenTip}">
						<Border BorderThickness="{TemplateBinding BorderThickness}" BorderBrush="{TemplateBinding BorderBrush}" Background="{DynamicResource MenuBackgroundGradient}" SnapsToDevicePixels="True" CornerRadius="2">
							<Grid Margin="{TemplateBinding Padding}">
								<Grid.RowDefinitions>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
									<RowDefinition Height="Auto"/>
								</Grid.RowDefinitions>

								<!-- Header Content -->
								<ContentControl Grid.Row="0" FontWeight="Bold"  Margin="5,7,5,5" Content="{TemplateBinding Header}" ContentTemplate="{TemplateBinding HeaderTemplate}" ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" SnapsToDevicePixels="True"/>

								<!-- Header Separator -->
								<StackPanel Grid.Row="1" Margin="4,0,3,5" Visibility="{TemplateBinding HeaderSeparatorVisibility}">
									<Rectangle Height="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamScreenTipSeparatorDarkFillKey}}" HorizontalAlignment="Stretch" SnapsToDevicePixels="True"/>
									<Rectangle Height="1" Fill="White" HorizontalAlignment="Stretch" SnapsToDevicePixels="True"/>
								</StackPanel>

								<!-- Main Content -->
								<Grid Grid.Row="2" Margin="0,3,13,0" >
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="Auto"/>
										<ColumnDefinition Width="*"/>
									</Grid.ColumnDefinitions>

									<Image Grid.Column="0" Margin="12,0,0,0" Source="{TemplateBinding ContentImage}"/>
									<ContentPresenter x:Name="mainContent"  Margin="0,0,0,0" Grid.Column="1" />
									<!--<ContentControl Margin="13,0,0,0" Grid.Column="1" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"/>-->
								</Grid>

								<!-- Footer Separator -->
								<StackPanel Grid.Row="3" Margin="4,5,4,7" Visibility="{TemplateBinding FooterSeparatorVisibility}">
									<Rectangle Height="1" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.XamScreenTipSeparatorDarkFillKey}}" HorizontalAlignment="Stretch" SnapsToDevicePixels="True"/>
									<Rectangle Height="1" Fill="White" HorizontalAlignment="Stretch" SnapsToDevicePixels="True"/>
								</StackPanel>

								<!-- Footer Content -->
								<ContentControl Grid.Row="4" FontWeight="Bold" Margin="5,-1,5,6" Content="{TemplateBinding Footer}" ContentTemplate="{TemplateBinding FooterTemplate}" ContentTemplateSelector="{TemplateBinding FooterTemplateSelector}"/>
							</Grid>
						</Border>

						<ControlTemplate.Triggers>
							<Trigger Property="HasContentImage" Value="True">
								<Setter Property="Width" Value="318"/>
								<Setter Property="Margin" Value="13,0,0,0" TargetName="mainContent"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- DialogBoxLauncherToolTemplate -->
		<!-- =================================================================== -->
		<ControlTemplate TargetType="{x:Type igRibbon:ButtonTool}" x:Key="{x:Static igRibbon:RibbonGroup.DialogBoxLauncherToolTemplateKey}">
			<Grid Margin="0,0,1,0" HorizontalAlignment="Center" VerticalAlignment="Center" Width="15" Height="14" Background="#00000000">
				<Border Margin="0,0,0,0" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateHoverBorderDarkFillKey}}" CornerRadius="0,0,2,0" SnapsToDevicePixels="True" Visibility="Hidden" x:Name="border"/>
				<Border Margin="1,1,1,1" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateHoverBorderLightFillKey}}" CornerRadius="0,0,1,0" SnapsToDevicePixels="True" Visibility="Hidden" x:Name="border1"/>
				<Border Margin="2,2,2,2" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateHoverCenterFillKey}}" SnapsToDevicePixels="True" Visibility="Hidden" x:Name="border2"/>
				<Grid x:Name="ToolBar_Corner" Margin="1,0,0,0" Width="8" Height="8" HorizontalAlignment="Center" VerticalAlignment="Center">
					<Path
				x:Name="CornerForeground"
				Stretch="Fill"
				Opacity="1"
				Data="M 0,0 C0,0 0,1 0,1 0,1 0,6 0,6 0,6 1,6 1,6 1,6 1,1 1,1 1,1 6,1 6,1 6,1 6,0 6,0 6,0 0,0 0,0 z"
				Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphNormalForegroundFillKey}}" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" Margin="0,0,2,2" />
					<Path
				x:Name="CornerBackground"
				Stretch="Fill"
				Opacity="1"
				Data="M 1,1 C1,1 1,2 1,2 1,2 1,6 1,6 1,6 2,6 2,6 2,6 2,2 2,2 2,2 6,2 6,2 6,2 6,1 6,1 6,1 1,1 1,1 z"
				Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphNormalBackgroundFillKey}}" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" Margin="1,1,2,2" />
					<Path x:Name="ArrowForeground" Opacity="1" SnapsToDevicePixels="True" d:LayoutOverrides="HorizontalAlignment, VerticalAlignment" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphNormalForegroundFillKey}}" Stretch="Fill" Margin="3,3,1,1" Data="F1 M3,-3 L4,-3 4,-2 4,-1 4,1 2,1 1,1 0,1 0,0 1,0 1,-2 3,-2 3,-3 z M0,-3 L1,-3 1,-2 0,-2 0,-3 z"/>
					<Path x:Name="ArrowBackground" Opacity="1" SnapsToDevicePixels="True" d:LayoutOverrides="VerticalAlignment" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphNormalBackgroundFillKey}}" Stretch="Fill" HorizontalAlignment="Right" Margin="0,3,0,0" Width="4" Data="F1 M1.4901161E-08,0 L1,0 1,4 1,5 1.4901161E-08,5 -3,5 -3,4 1.4901161E-08,4 1.4901161E-08,0 z M-3,0 L-2,0 -2,1 -3,1 -3,0 z"/>
				</Grid>
			</Grid>
			<ControlTemplate.Triggers>
				<Trigger Property="IsActive" Value="True">
					<Setter Property="Visibility" TargetName="border" Value="Visible"/>
					<Setter Property="Visibility" TargetName="border1" Value="Visible"/>
					<Setter Property="Visibility" TargetName="border2" Value="Visible"/>
				</Trigger>
				<Trigger Property="IsMouseOver" Value="True">
					<Setter Property="Visibility" TargetName="border" Value="Visible"/>
					<Setter Property="Visibility" TargetName="border1" Value="Visible"/>
					<Setter Property="Visibility" TargetName="border2" Value="Visible"/>
					<Setter TargetName="CornerForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphHoverForegroundFillKey}}"/>
					<Setter TargetName="CornerBackground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphHoverBackgroundFillKey}}"/>
					<Setter TargetName="ArrowForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphHoverForegroundFillKey}}"/>
					<Setter TargetName="ArrowBackground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphHoverBackgroundFillKey}}"/>
				</Trigger>
				<Trigger Property="IsPressed" Value="True">
					<Setter Property="Visibility" TargetName="border" Value="Visible"/>
					<Setter Property="Visibility" TargetName="border1" Value="Visible"/>
					<Setter Property="Visibility" TargetName="border2" Value="Visible"/>
					<Setter Property="Background" TargetName="border" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplatePressedBorderDarkFillKey}}"/>
					<Setter Property="Background" TargetName="border1" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplatePressedBorderLightFillKey}}"/>
					<Setter Property="Background" TargetName="border2" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplatePressedCenterFillKey}}"/>
					<Setter TargetName="CornerForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphPressedForegroundFillKey}}"/>
					<Setter TargetName="CornerBackground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphPressedBackgroundFillKey}}"/>
					<Setter TargetName="ArrowForeground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphPressedForegroundFillKey}}"/>
					<Setter TargetName="ArrowBackground" Property="Fill" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.DialogBoxLauncherToolTemplateGlyphPressedBackgroundFillKey}}"/>
				</Trigger>
			</ControlTemplate.Triggers>
		</ControlTemplate>


		<!-- =================================================================== -->
		<!-- LabelTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:LabelTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:LabelTool}">
						<Grid>
							<Border x:Name="NormalLabel" Background="{DynamicResource MenuBackgroundGradient}" SnapsToDevicePixels="True" Padding="{TemplateBinding Padding}" >
								<StackPanel Orientation="Horizontal">
									<igWindows:AutoDisabledImage Source="{TemplateBinding ImageResolved}" x:Name="NormalLabel_image"
															 igWindows:Utilities.SnapElementToDevicePixels="True" />
									<!-- AS 5/11/09 17190 Like the buttontools, the labeltool should have been using the caption -->
									<ContentPresenter x:Name="NormalLabelContent" Margin="3,0,0,0"  VerticalAlignment="Center"  
												  Content="{TemplateBinding Caption}" 
												  ContentTemplate="{TemplateBinding ContentTemplate}" 
												  ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"/>
								</StackPanel>
							</Border>
							<Border 
							x:Name="ApplicationMenuSubMenuLabel"
							Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionFillKey}}"
							BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}"
							BorderThickness="0,0,0,1"
							CornerRadius="2,2,0,0"   
							SnapsToDevicePixels="True" 
							Padding="7,3,4,3" 
							Visibility="Collapsed">
								<StackPanel Orientation="Horizontal">
									<igWindows:AutoDisabledImage Source="{TemplateBinding ImageResolved}" x:Name="ApplicationMenuSubMenuLabel_image" 
									igWindows:Utilities.SnapElementToDevicePixels="True" />
									<!-- AS 9/18/09 22320 Like the buttontools, the labeltool should have been using the caption -->
									<ContentPresenter x:Name="ApplicationMenuSubMenuLabelContent" VerticalAlignment="Center"  Content="{TemplateBinding Caption}" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"/>
								</StackPanel>
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<Trigger Property="Location" Value="ApplicationMenuSubMenu">
								<Setter TargetName="NormalLabel" Property="Visibility" Value="Collapsed"/>
								<Setter TargetName="ApplicationMenuSubMenuLabel" Property="Visibility" Value="Visible"/>
							</Trigger>
							<Trigger Property="Location" Value="Menu">
								<Setter Property="FontWeight" Value="Bold"/>
								<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionFillKey}}" TargetName="NormalLabel"/>
								<Setter Property="Margin" Value="7,3,14,4" TargetName="NormalLabelContent"/>
								<Setter Property="CornerRadius" Value="2,2,0,0" TargetName="NormalLabel"/>
								<Setter Property="BorderThickness" Value="0,0,0,1" TargetName="NormalLabel"/>
								<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}" TargetName="NormalLabel"/>
							</Trigger>

							<Trigger Property="Location" Value="ApplicationMenu">
								<Setter Property="FontWeight" Value="Bold"/>
								<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionFillKey}}" TargetName="NormalLabel"/>
								<Setter Property="Margin" Value="7,3,14,4" TargetName="NormalLabelContent"/>
								<Setter Property="Margin" Value="1,0,1,0" TargetName="NormalLabel"/>
								<Setter Property="CornerRadius" Value="2,2,0,0" TargetName="NormalLabel"/>
								<Setter Property="BorderThickness" Value="0,0,0,1" TargetName="NormalLabel"/>
								<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}" TargetName="NormalLabel"/>
							</Trigger>

							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />

								<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
								<Setter Property="Margin" Value="6,0,0,0"/>
							</Trigger>

							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
							</Trigger>

							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
							</Trigger>

						</ControlTemplate.Triggers>


						<!--<Border x:Name="background" HorizontalAlignment="Stretch" VerticalAlignment="Top" Width="Auto" Height="Auto" Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionFillKey}}" CornerRadius="2,2,0,0" SnapsToDevicePixels="True" BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}" BorderThickness="0,0,0,1">
			<ContentPresenter x:Name="labelContent" Content="{TemplateBinding Content}" ContentTemplate="{TemplateBinding ContentTemplate}" ContentTemplateSelector="{TemplateBinding ContentTemplateSelector}"/>
		  </Border>
		  <ControlTemplate.Triggers>
			<Trigger Property="Location" Value="Menu">
			  <Setter Property="FontWeight" Value="Bold"/>
			  <Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionFillKey}}" TargetName="background"/>
			  <Setter Property="Margin" Value="7,3,7,4" TargetName="labelContent"/>
			  <Setter Property="BorderThickness" Value="0,0,0,1" TargetName="background"/>
			  <Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}" TargetName="background"/>
			</Trigger>
		  </ControlTemplate.Triggers>-->
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>


		<!-- =================================================================== -->
		<!-- SeparatorTool Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:SeparatorTool}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:SeparatorTool}">
						<igWindows:CardPanel>

							<!-- Horizontal Separator used in menus. -->
							<!-- JJD 12/4/07 - BR28873 -->
							<!-- Adjusted margins for new approach for having the SeparatorTool in the Header of the ToolMenuItem -->
							<!--<igWindows:CardPanel x:Name="HorizontalSeparator" Margin="30,0,1,1" Height="3" SnapsToDevicePixels="true" Grid.Column="1">-->
							<igWindows:CardPanel x:Name="HorizontalSeparator" Margin="1,0,1,0" SnapsToDevicePixels="true" Grid.Column="1">
								<Rectangle Height="1" Margin="0,0,0,0" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.HorizontalSeparatorNormalDarkFillKey}}" SnapsToDevicePixels="true" />
								<Rectangle Height="1" Margin="0,1,0,0" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.HorizontalSeparatorNormalLightFillKey}}" SnapsToDevicePixels="true" />
							</igWindows:CardPanel>

							<!-- Vertical Separator used in RibbonGroups and ApplicationMenuFooterToolbar. -->
							<igWindows:CardPanel x:Name="VerticalSeparator" Width="3"  Visibility="Collapsed" Margin="4,5,4,7" Grid.ColumnSpan="2">
								<Rectangle Width="1" Margin="0,0,0,0" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VerticalSeparatorNormalLightFillKey}}" SnapsToDevicePixels="true" />
								<Rectangle Width="1" Margin="1,0,0,0" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VerticalSeparatorNormalDarkFillKey}}" SnapsToDevicePixels="true" />
							</igWindows:CardPanel>
						</igWindows:CardPanel>

						<ControlTemplate.Triggers>
							<Trigger Property="Location" Value="Ribbon">
								<Setter Property="Visibility" Value="Visible" TargetName="VerticalSeparator"/>
								<Setter Property="Visibility" Value="Collapsed" TargetName="HorizontalSeparator"/>
							</Trigger>
							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Visibility" Value="Visible" TargetName="VerticalSeparator"/>

								<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
								<!--<Setter Property="Margin" Value="4,2,4,4" TargetName="VerticalSeparator"/>-->
								<Setter Property="Margin" Value="0,2,0,4" TargetName="VerticalSeparator"/>
								<Setter Property="Margin" Value="6,0,0,0"/>

								<Setter Property="Visibility" Value="Collapsed" TargetName="HorizontalSeparator"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>


		<!-- =================================================================== -->
		<!-- LargeToolCaptionPresenter Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:LargeToolCaptionPresenter}">
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:LargeToolCaptionPresenter}">
						<Grid SnapsToDevicePixels="true">
							<Grid.RowDefinitions>
								<RowDefinition Height="Auto"/>
								<RowDefinition Height="Auto"/>
							</Grid.RowDefinitions>

							<TextBlock
							x:Name="PART_Line1"
							Grid.Row="0"
							TextAlignment="Center"
							Margin="3,0,3,0"
							igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}" />
							<TextBlock
							x:Name="PART_Line2"
							Grid.Row="1"
							TextAlignment="Center"
							Margin="3,-2,3,0"
							igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}" />
						</Grid>
						<ControlTemplate.Triggers>

							<Trigger Property="IsEnabled" Value="False">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}" />
							</Trigger>

						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- ========================================================================================= -->
		<!-- ToolTip Style - Used for Non ScreenTip ToolTips for RibbonTabItem and ContextualTabGroup  -->
		<!-- ========================================================================================= -->
		<Style TargetType="{x:Type ToolTip}" x:Key="{x:Static igRibbon:XamRibbon.ToolTipStyleKey}">
			<Setter Property="Foreground" Value="#EE000000"/>
			<Setter Property="FontFamily" Value="Segoe UI"/>
			<Setter Property="FontSize" Value="11"/>
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolTipNonScreenTipBorderFillKey}}"/>
			<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolTipNonScreenTipCenterFillKey}}"/>
		</Style>

		<!-- =================================================================== -->
		<!-- KeyTip Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:KeyTip}">
			<Setter Property="Foreground" Value="Black" />
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="Padding" Value="3,2,3,2" />
			<Setter Property="Border.CornerRadius" Value="2" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:KeyTip}">
						<Border
					Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.KeyTipCenterFillKey}}"
					BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.KeyTipBorderFillKey}}"
					BorderThickness="1,1,1,1"
					Padding="{TemplateBinding Padding}"
					CornerRadius="{TemplateBinding Border.CornerRadius}"
					SnapsToDevicePixels="True"
>
							<TextBlock
						HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
						VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
						Text="{TemplateBinding Value}"
						/>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="IsEnabled" Value="False">
					<Setter Property="Opacity" Value="0.7"/>
					<Setter Property="BorderBrush" Value="Gray" />
					<Setter Property="Foreground" Value="Gray" />
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- ComboEditorTool Style -->
		<!-- =================================================================== -->

		<Style x:Key="{x:Static igRibbon:ComboEditorTool.ComboEditorToolComboBoxStyleKey}" TargetType="{x:Type ComboBox}">
			<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.WindowTextBrushKey}}" />
			<Setter Property="Background" Value="Transparent" />
			<Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Auto" />
			<Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Auto" />
			<Setter Property="ScrollViewer.CanContentScroll" Value="True" />
			<Setter Property="VerticalContentAlignment" Value="Center" />
			<!-- SSP 1/7/08 BR27432  - set IsSynchronizedWithCurrentItem to False -->
			<Setter Property="IsSynchronizedWithCurrentItem" Value="False" />
			<Setter Property="ItemsPanel">
				<Setter.Value>
					<ItemsPanelTemplate>
						<VirtualizingStackPanel/>
					</ItemsPanelTemplate>
				</Setter.Value>
			</Setter>
			<!--SSP 11/7/07 BR27220
			In Non-Editable mode, we don't want to draw dashed focus rect which was happening when you toggle
			through items with keyboard.
			-->
			<Setter Property="FocusVisualStyle">
				<Setter.Value>
					<Style />
				</Setter.Value>
			</Setter>
			<Style.Triggers>
				<Trigger Property="IsEditable" Value="True">
					<Setter Property="IsTabStop" Value="False" />
				</Trigger>
			</Style.Triggers>
		</Style>

		<Style TargetType="{x:Type igRibbon:ComboEditorTool}">
			<Setter Property="ToolTipService.ShowDuration" Value="20000" />
			<Setter Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalCenterFillKey}}" />
			<Setter Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalBorderFillKey}}" />
			<Setter Property="BorderThickness" Value="1" />
			<Setter Property="Padding" Value="2,2,2,2" />
			<Setter Property="VerticalAlignment" Value="Center"/>
			<!--<Setter Property="Margin" Value="{StaticResource TextEditorMargin}" />-->
			<Setter Property="SnapsToDevicePixels" Value="True" />
			<!--SSP 11/2/07 Now this is being done in code. See ComboBoxStyleKey property of the XamComboEditor-->
			<!--<Setter Property="ComboBoxStyle" Value="{StaticResource ComboEditor_ComboBoxStyle}" />-->
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:ComboEditorTool}">
						<StackPanel Orientation="Horizontal" >
							<igWindows:AutoDisabledImage Width="16" Height="16" x:Name="Image"
								igRibbon:XamRibbon.KeyTipPlacementType="SmallImage"
								igWindows:Utilities.SnapElementToDevicePixels="True"
								Visibility="Collapsed"
								Source="{TemplateBinding igRibbon:TextEditorTool.ImageResolved}"/>
							<ContentPresenter x:Name="Caption"
								Margin="0,0,5,0" 
								Visibility="{Binding (igRibbon:ButtonTool.HasCaption), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"
								VerticalAlignment="{TemplateBinding VerticalAlignment}"
								Content="{TemplateBinding Caption, Converter={StaticResource stringWithoutMnemonicsConverter}}"/>
							<Border x:Name="MainBorder"
								SnapsToDevicePixels="True"
								Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalCenterFillKey}}"
								BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsNormalBorderFillKey}}"
								BorderThickness="1,1,1,1"
								Width="{TemplateBinding EditAreaWidth}"
								CornerRadius="0,0,0,0">
								<Grid>
									<ComboBox
										x:Name="PART_FocusSite"
										Padding="{TemplateBinding Padding}"
										HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
										VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"
										IsReadOnly="{TemplateBinding ReadOnly}"
										Background="Transparent"
										BorderBrush="Transparent"
										BorderThickness="0,0,0,0"									
										ContextMenu="{TemplateBinding ContextMenu}"
										IsDropDownOpen="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}"
										Style="{TemplateBinding ComboBoxStyle}"
										IsEditable="{TemplateBinding IsEditable}"
										SelectedValuePath="{Binding ItemsProvider.ValuePath, RelativeSource={RelativeSource TemplatedParent}}"
										DisplayMemberPath="{Binding ItemsProvider.DisplayMemberPath, RelativeSource={RelativeSource TemplatedParent}}"
										MaxDropDownHeight="{TemplateBinding MaxDropDownHeight}"
										igEditors:XamComboEditor.ComboEditor="{Binding RelativeSource={RelativeSource TemplatedParent}}"
										Visibility="Collapsed"/>

									<Grid x:Name="TextBlockGrid" >
										<Grid.RowDefinitions>
											<RowDefinition/>
										</Grid.RowDefinitions>
										<Grid.ColumnDefinitions>
											<ColumnDefinition Width="*" />
											<ColumnDefinition Width="Auto" />
										</Grid.ColumnDefinitions>

										<TextBlock x:Name="TextBlock"
											Grid.Column="0"
											Padding="{TemplateBinding Padding}" 
											Margin="1,0,0,0" 
											Text="{TemplateBinding DisplayText}"
											HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
											VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />

										<!--SSP 11/9/10 TFS33587 - Added IsEnabled setter-->
										<ToggleButton x:Name="DropDownButton"
											Grid.Column="1"
											Width="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}"
											ClickMode="Press"
											IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}, UpdateSourceTrigger=PropertyChanged}"
											Style="{TemplateBinding DropDownButtonStyle}"
											Visibility="Visible" 
											IsEnabled="{Binding IsReadOnly, Converter={StaticResource complementConverter}, RelativeSource={RelativeSource TemplatedParent}}"
										/>
									</Grid>
								</Grid>
							</Border>
						</StackPanel>
						<ControlTemplate.Triggers>

							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<!-- JJD 12/11/07 Added condition to check if we are in a menu before doing the FindAncestor for ToolMenuItem to prevent binding errors -->
									<Condition Binding="{Binding Location, Converter={x:Static igRibbon:ToolLocationToIsInMenuConverter.Instance}, RelativeSource={RelativeSource Self}}" Value="True"/>
									<Condition Binding="{Binding IsMouseOver, RelativeSource={RelativeSource FindAncestor, {x:Type igRibbon:ToolMenuItem}, 1}}" Value="True" />
								</MultiDataTrigger.Conditions>
								<Setter TargetName="Caption" Property="TextElement.Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.TextHottrackFillKey}}"/>
							</MultiDataTrigger>

							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolInQATForegroundTextFillKey}}"/>
								<Setter TargetName="TextBlock" Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}"/>
							</Trigger>

							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />

								<!-- AS 12/1/09 TFS24129 - Default margin when in the footer toolbar -->
								<Setter Property="Margin" Value="6,0,0,0"/>
							</Trigger>

							<Trigger Property="IsEnabled" Value="False">
								<Setter TargetName="MainBorder" Property="Background" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsDisabledCenterFillKey}}"/>
								<Setter TargetName="MainBorder" Property="BorderBrush" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsDisabledBorderFillKey}}"/>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolDisabledForegroundTextFillKey}}"/>
							</Trigger>

							<Trigger SourceName="MainBorder" Property="IsMouseOver" Value="True">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
							</Trigger>
							<Trigger Property="IsMouseOver" Value="True" SourceName="MainBorder">
								<Setter TargetName="DropDownButton"  Property="Tag" Value="MouseOverControlTrue" />
							</Trigger>
							<Trigger Property="IsInEditMode" Value="True">
								<Setter Property="Background" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverCenterFillKey}}"/>
								<Setter Property="BorderBrush" TargetName="MainBorder" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.EditorsHoverBorderFillKey}}"/>
								<Setter TargetName="PART_FocusSite" Property="Visibility" Value="Visible"/>
								<Setter TargetName="TextBlock" Property="Visibility" Value="Collapsed"/>
								<Setter Property="IsTabStop" Value="False" />
							</Trigger>
							<Trigger Property="Location" Value="Ribbon">
								<Setter TargetName="Image"  Property="Visibility" Value="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
							<Trigger Property="Location" Value="ApplicationMenuFooterToolbar">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.ToolEnabledForegroundTextFillKey}}" />
								<Setter TargetName="Image"  Property="Visibility" Value="{Binding (igRibbon:ButtonTool.HasImage), Converter={StaticResource BoolToVisConverter}, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter TargetName="Caption"  Property="Visibility" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="IsEmbedded" Value="False">
								<Setter TargetName="MainBorder" Property="CornerRadius" Value="1" />
							</Trigger>
							<Trigger Property="igRibbon:XamRibbon.HideAccessKey" Value="False">
								<Setter TargetName="Caption" Property="RecognizesAccessKey" Value="True"/>
								<Setter TargetName="Caption" Property="Content" Value="{Binding Caption, RelativeSource={x:Static RelativeSource.TemplatedParent}}"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<!--<Setter Property="EditTemplate">
			<Setter.Value>
				<ControlTemplate TargetType="{x:Type igRibbon:ComboEditorTool}">
					<StackPanel Orientation="Horizontal">
						<TextBlock x:Name="Caption"
						Visibility="Collapsed"
						VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
						Text="{TemplateBinding Caption}"/>
						<Border x:Name="MainBorder"
							Background="{DynamicResource MenuBackgroundGradient}"
							BorderBrush="{TemplateBinding BorderBrush}"
							BorderThickness="{TemplateBinding BorderThickness}"
							Width="{TemplateBinding EditAreaWidth}"
							>
							-->
			<!-- SSP 10/3/07 BR25672 Took the Margin="{TemplateBinding Padding}" code out of Border element above
								since the ComboBox below is already setting its Padding to that value. We don't want to
								substract the Padding twice. -->
			<!--
							<ComboBox
								Name="PART_FocusSite"
								Padding="{TemplateBinding Padding}"
								HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
								IsReadOnly="{TemplateBinding ReadOnly}"
								Background="Transparent"
								BorderBrush="Transparent"
								BorderThickness="0,0,0,0"
								Foreground="{TemplateBinding Foreground}"
								ContextMenu="{TemplateBinding ContextMenu}"
								IsDropDownOpen="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=IsDropDownOpen, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
								Style="{TemplateBinding ComboBoxStyle}"
								IsEditable="{TemplateBinding IsEditable}"
								SelectedValuePath="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ItemsProvider.ValuePath}"
								DisplayMemberPath="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=ItemsProvider.DisplayMemberPath}"
								MaxDropDownHeight="{TemplateBinding MaxDropDownHeight}"
								igEditors:XamComboEditor.ComboEditor="{TemplateBinding igEditors:XamComboEditor.ComboEditor}"
							/>
						</Border>
					</StackPanel>
					<ControlTemplate.Triggers>
						<Trigger Property="HasCaption" Value="True">
							<Setter TargetName="Caption" Property="Visibility" Value="Visible" />
						</Trigger>
						<Trigger Property="IsEmbedded" Value="False">
							<Setter TargetName="MainBorder" Property="CornerRadius" Value="1" />
						</Trigger>
						-->
			<!-- 
SSP 6/6/07 BR23366
Added trigger that sets IsTabStop to False based on IsInEditMode setting.
We need this in order to make the Tab and Shift+Tab navigation work properly.
Apparently presense of nested textbox causes Shift+Tab to misbehave and cause
the framwork to give focus to the parent ContentPresenter if the editor
is inside a HeaderedContentControl. This is similar to what inbox ComboBox
does.
-->
			<!--
						<Trigger Property="IsInEditMode" Value="True">
							<Setter Property="IsTabStop" Value="False" />
							<Setter Property="Background" TargetName="MainBorder" Value="#FFFFFFFF"/>
						</Trigger>
					</ControlTemplate.Triggers>
				</ControlTemplate>
			</Setter.Value>
		</Setter>-->
			<Style.Triggers>
				<MultiTrigger>
					<MultiTrigger.Conditions>
						<Condition Property="IsEmbedded" Value="True"/>
						<Condition Property="IsInEditMode" Value="False"/>
					</MultiTrigger.Conditions>
					<Setter Property="Background" Value="{x:Null}"/>
					<Setter Property="BorderBrush" Value="{x:Null}"/>
				</MultiTrigger>
				<Trigger Property="IsInEditMode" Value="True">
					<!-- SSP 5/13/10 TFS30701 - Commented out setting of ClipToBounds which I believe was
				added to clip the caret element and so instead added the necessary code to clip the caret
				in XamMaskedEditor.ArrangeOverride. This bug-fix was done to make the UIElement.Effect work. -->
					<!--<Setter Property="ClipToBounds" Value="True" />-->
					<!--
// SSP 3/15/07 BR21086 BR20704
// Do this through the style via a trigger so when the masked editor is not in edit mode, it draws 
// the focus rect. For example, in DataPresenter when the cell exits edit mode via Escape key, the
// editor retains focus and is not in edit mode. In such a case, it should draw focus rect.
-->
					<Setter Property="FocusVisualStyle">
						<Setter.Value>
							<Style />
						</Setter.Value>
					</Setter>
				</Trigger>
			</Style.Triggers>
		</Style>

		<!-- =================================================================== -->
		<!-- PopupResizerBar Style -->
		<!-- =================================================================== -->

		<Style x:Key="{x:Static igRibbon:XamRibbon.PopupResizerBarStyleKey}" TargetType="{x:Type igWindows:PopupResizerBar}">
			<Setter Property="BorderThickness" Value="1"/>
			<Setter Property="BorderBrush" Value="Black"/>
			<Setter Property="Height" Value="12"/>

			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igWindows:PopupResizerBar}">
						<Grid
						x:Name="BorderStrokeWhenTop"
						Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarStrokeKey}}"
						HorizontalAlignment="Stretch"
						VerticalAlignment="Stretch"
						Width="Auto"
						Height="Auto">
							<Border
							x:Name="Footer"
							SnapsToDevicePixels="True"
							Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGradientKey}}"
							BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarStrokeKey}}"
							BorderThickness="0,1,0,0"
							CornerRadius="0,0,2,2"
							HorizontalAlignment="Stretch"
							VerticalAlignment="Stretch"
							Width="Auto"
							Height="Auto"
							Margin="0,0,0,0">
								<igWindows:CardPanel Margin="{TemplateBinding Padding}">
									<igWindows:CardPanel x:Name="GlyphArea">

										<!-- the thumb is transparent and needs to be placed after the glyphs so that it is on top with respect to z-order -->
										<Thumb x:Name="PART_Thumb" Background="Transparent" Foreground="Transparent" Opacity="0"/>

										<!-- the glyph that is used when the resizemode is Both and the location is Bottom-->
										<Grid
										x:Name="BottomRightGlyph"
										Visibility="Collapsed"
										Width="{Binding ActualHeight, Mode=OneWay, RelativeSource={RelativeSource Self}}"
										VerticalAlignment="Bottom"
										HorizontalAlignment="Right"
										Margin="0,0,1,1"
										Background="{x:Null}"
										IsHitTestVisible="False">
											<Path
										  Margin="1,1,0,0"
										  VerticalAlignment="Top"
										  Height="6"
										  Stretch="Fill"
										  Opacity="1"
										  Data="M 1,6 C1,6.5522918701171875 1.4477081298828125,7 2,7 2.5522918701171875,7 3,6.5522918701171875 3,6 3,5.4477081298828125 2.5522918701171875,5 2,5 1.4477081298828125,5 1,5.4477081298828125 1,6 zM 5,2 C5,2.5522918701171875 5.4477081298828125,3 6,3 6.5522918701171875,3 7,2.5522918701171875 7,2 7,1.4477081298828125 6.5522918701171875,1 6,1 5.4477081298828125,1 5,1.4477081298828125 5,2 zM 5,6 C5,6.5522918701171875 5.4477081298828125,7 6,7 6.5522918701171875,7 7,6.5522918701171875 7,6 7,5.4477081298828125 6.5522918701171875,5 6,5 5.4477081298828125,5 5,5.4477081298828125 5,6 z"
										  Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphNormalBackgroundFillKey}}" SnapsToDevicePixels="True" HorizontalAlignment="Left" Width="6" />
											<Grid
										  Opacity="1"
										  Margin="0,0,0,0"
										  HorizontalAlignment="Left" Width="6">
												<Path
											  Margin="0,4,0,0"
											  HorizontalAlignment="Left"
											  VerticalAlignment="Top"
											  Height="2"
											  Width="2"
											  Stretch="Fill"
											  Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}"
											  Opacity="1"
											  Data="M 0,5 C0,4.4477081298828125 0.4477081298828125,4 1,4 1.5522918701171875,4 2,4.4477081298828125 2,5 2,5.5522918701171875 1.5522918701171875,6 1,6 0.4477081298828125,6 0,5.5522918701171875 0,5 z" SnapsToDevicePixels="True"/>
												<Path
											  Margin="4,4,0,0"
											  HorizontalAlignment="Left"
											  VerticalAlignment="Top"
											  Height="2"
											  Width="2"
											  Stretch="Fill"
											  Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}"
											  Opacity="1"
											  Data="M 4,5 C4,4.4477081298828125 4.4477081298828125,4 5,4 5.5522918701171875,4 6,4.4477081298828125 6,5 6,5.5522918701171875 5.5522918701171875,6 5,6 4.4477081298828125,6 4,5.5522918701171875 4,5 z" SnapsToDevicePixels="True"/>
												<Path
											  Margin="4,0,0,0"
											  HorizontalAlignment="Left"
											  VerticalAlignment="Top"
											  Height="2"
											  Width="2"
											  Stretch="Fill"
											  Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}"
											  Opacity="1"
											  Data="M 4,1 C4,0.4477081298828125 4.4477081298828125,0 5,0 5.5522918701171875,0 6,0.4477081298828125 6,1 6,1.5522918701171875 5.5522918701171875,2 5,2 4.4477081298828125,2 4,1.5522918701171875 4,1 z" SnapsToDevicePixels="True"/>
											</Grid>
										</Grid>

										<!-- the glyph that is used when the resizemode is Both and the location is Top-->
										<Grid
										x:Name="TopRightGlyph"
										Visibility="Collapsed"
										d:LayoutOverrides="HorizontalAlignment"
										Background="{x:Null}"
										Width="{Binding ActualHeight, Mode=OneWay, RelativeSource={RelativeSource Self}}"
										IsHitTestVisible="False">
											<Path SnapsToDevicePixels="True" HorizontalAlignment="Right" Margin="0,1,2,0" VerticalAlignment="Top" Width="6" Height="6" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphNormalBackgroundFillKey}}" Stretch="Fill" Data="F1 M1,2.9802322E-08 C1.5522847,0 2,0.44771525 2,1 C2,1.5522847 1.5522847,2 1,2 0.44771525,2 0,1.5522847 -5.9604645E-08,1 0,0.44771525 0.44771525,0 1,2.9802322E-08 z M1,-4 C1.5522847,-4 2,-3.5522847 2,-3 C2,-2.4477153 1.5522847,-2 1,-2 0.44771525,-2 0,-2.4477153 -5.9604645E-08,-3 0,-3.5522847 0.44771525,-4 1,-4 z M-3,-4 C-2.4477153,-4 -2,-3.5522847 -2,-3 C-2,-2.4477153 -2.4477153,-2 -3,-2 -3.5522847,-2 -4,-2.4477153 -4,-3 -4,-3.5522847 -3.5522847,-4 -3,-4 z"/>
											<Grid
											Opacity="1"
											Margin="0,0,0,0"
											HorizontalAlignment="Right" Width="Auto" VerticalAlignment="Top">
												<Path
												Margin="0,2,7,0"
												HorizontalAlignment="Right"
												VerticalAlignment="Top"
												Height="2"
												Width="2"
												Stretch="Fill"
												Opacity="1"
												Data="M 0,5 C0,4.4477081298828125 0.4477081298828125,4 1,4 1.5522918701171875,4 2,4.4477081298828125 2,5 2,5.5522918701171875 1.5522918701171875,6 1,6 0.4477081298828125,6 0,5.5522918701171875 0,5 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}"/>
												<Path
												Margin="0,6,3,0"
												HorizontalAlignment="Right"
												VerticalAlignment="Top"
												Height="2"
												Width="2"
												Stretch="Fill"
												Opacity="1"
												Data="M 4,5 C4,4.4477081298828125 4.4477081298828125,4 5,4 5.5522918701171875,4 6,4.4477081298828125 6,5 6,5.5522918701171875 5.5522918701171875,6 5,6 4.4477081298828125,6 4,5.5522918701171875 4,5 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}"/>
												<Path
												Margin="0,2,3,0"
												HorizontalAlignment="Right"
												VerticalAlignment="Top"
												Height="2"
												Width="2"
												Stretch="Fill"
												Opacity="1"
												Data="M 4,1 C4,0.4477081298828125 4.4477081298828125,0 5,0 5.5522918701171875,0 6,0.4477081298828125 6,1 6,1.5522918701171875 5.5522918701171875,2 5,2 4.4477081298828125,2 4,1.5522918701171875 4,1 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}"/>
											</Grid>
										</Grid>

										<!-- the glyph that is used when the resizemode is VerticalOnly-->

										<Grid
									x:Name="VerticalOnlyGlyph"
									 IsHitTestVisible="False"
									 Visibility="Collapsed"
									 Margin="0,0,0,0"
									 HorizontalAlignment="Center"
									 Width="Auto"
									 VerticalAlignment="Center"
									 Height="Auto">
											<Path SnapsToDevicePixels="True" HorizontalAlignment="Left" Margin="1,1,0,0" x:Name="WhiteShadows" VerticalAlignment="Top" Width="17" Height="2" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GenericGlyphNormalBackgroundFillKey}}" Stretch="None" Data="F1 M16,5.9604645E-08 C16.552284,0 17,0.44771525 17,1 C17,1.5522847 16.552284,2 16,2 15.447715,2 15,1.5522847 15,1 15,0.44771525 15.447715,0 16,5.9604645E-08 z M11,5.9604645E-08 C11.552285,0 12,0.44771525 12,1 C12,1.5522847 11.552285,2 11,2 10.447715,2 10,1.5522847 10,1 10,0.44771525 10.447715,0 11,5.9604645E-08 z M6,5.9604645E-08 C6.5522847,0 7,0.44771525 7,1 C7,1.5522847 6.5522847,2 6,2 5.4477153,2 5,1.5522847 5,1 5,0.44771525 5.4477153,0 6,5.9604645E-08 z M0.99999994,5.9604645E-08 C1.5522847,0 2,0.44771525 1.9999999,1 C2,1.5522847 1.5522847,2 0.99999994,2 0.44771525,2 0,1.5522847 0,1 0,0.44771525 0.44771525,0 0.99999994,5.9604645E-08 z"/>
											<Path
											Height="2"
											Width="2"
											Stretch="Fill"
											Opacity="1"
											Data="M 4,5 C4,4.4477081298828125 4.4477081298828125,4 5,4 5.5522918701171875,4 6,4.4477081298828125 6,5 6,5.5522918701171875 5.5522918701171875,6 5,6 4.4477081298828125,6 4,5.5522918701171875 4,5 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}" HorizontalAlignment="Left" Margin="0,0,6,0" x:Name="_1" VerticalAlignment="Top"/>
											<Path
											Margin="5,0,0,0"
											HorizontalAlignment="Left"
											VerticalAlignment="Top"
											Height="2"
											Width="2"
											Stretch="Fill"
											Opacity="1"
											Data="M 0,5 C0,4.4477081298828125 0.4477081298828125,4 1,4 1.5522918701171875,4 2,4.4477081298828125 2,5 2,5.5522918701171875 1.5522918701171875,6 1,6 0.4477081298828125,6 0,5.5522918701171875 0,5 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}" x:Name="_2"/>
											<Path
											Margin="10,0,0,0"
											HorizontalAlignment="Left"
											VerticalAlignment="Top"
											Height="2"
											Width="2"
											Stretch="Fill"
											Opacity="1"
											Data="M 4,5 C4,4.4477081298828125 4.4477081298828125,4 5,4 5.5522918701171875,4 6,4.4477081298828125 6,5 6,5.5522918701171875 5.5522918701171875,6 5,6 4.4477081298828125,6 4,5.5522918701171875 4,5 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}" x:Name="_3"/>
											<Path
											Margin="15,0,0,0"
											HorizontalAlignment="Left"
											VerticalAlignment="Top"
											Height="2"
											Width="2"
											Stretch="Fill"
											Opacity="1"
											Data="M 4,1 C4,0.4477081298828125 4.4477081298828125,0 5,0 5.5522918701171875,0 6,0.4477081298828125 6,1 6,1.5522918701171875 5.5522918701171875,2 5,2 4.4477081298828125,2 4,1.5522918701171875 4,1 z" SnapsToDevicePixels="True" Fill="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryToolDropDownPresenterFooterBarGlyphFillKey}}" x:Name="_4"/>
										</Grid>

									</igWindows:CardPanel>
								</igWindows:CardPanel>
							</Border>
						</Grid>
						<ControlTemplate.Triggers>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="ResizeMode" Value="Both"/>
									<Condition Property="Location" Value="Bottom"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="BottomRightGlyph" Property="Visibility" Value="Visible"/>
								<Setter TargetName="PART_Thumb" Property="Cursor" Value="SizeNWSE"/>
								<Setter TargetName="GlyphArea" Property="HorizontalAlignment" Value="Right"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="ResizeMode" Value="Both"/>
									<Condition Property="Location" Value="Bottom"/>
									<Condition Property="FlowDirection" Value="RightToLeft"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="PART_Thumb" Property="Cursor" Value="SizeNESW"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="ResizeMode" Value="Both"/>
									<Condition Property="Location" Value="Top"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="TopRightGlyph" Property="Visibility" Value="Visible"/>
								<Setter TargetName="PART_Thumb" Property="Cursor" Value="SizeNESW"/>
								<Setter TargetName="GlyphArea" Property="HorizontalAlignment" Value="Right"/>
								<Setter TargetName="Footer" Property="BorderThickness" Value="0,0,0,0"/>
								<Setter TargetName="Footer" Property="CornerRadius" Value="2,2,2,2"/>
								<Setter TargetName="Footer" Property="Margin" Value="0,0,0,1"/>
								<Setter TargetName="BorderStrokeWhenTop" Property="Visibility" Value="Visible"/>
							</MultiTrigger>

							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="ResizeMode" Value="Both"/>
									<Condition Property="Location" Value="Top"/>
									<Condition Property="FlowDirection" Value="RightToLeft"/>
								</MultiTrigger.Conditions>
								<Setter TargetName="PART_Thumb" Property="Cursor" Value="SizeNWSE"/>
							</MultiTrigger>

							<Trigger Property="ResizeMode" Value="VerticalOnly">
								<Setter TargetName="VerticalOnlyGlyph" Property="Visibility" Value="Visible"/>
								<Setter TargetName="PART_Thumb" Property="Cursor" Value="SizeNS"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
		<!--<Style x:Key="{x:Static igRibbon:XamRibbon.PopupResizerBarStyleKey}"
		 TargetType="{x:Type igWindows:PopupResizerBar}">
	
  </Style>-->

		<!-- =================================================================== -->
		<!-- RibbonContextMenu Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type igRibbon:RibbonContextMenu}">
			<Setter Property="TextElement.FontWeight" Value="{x:Static FontWeights.Normal}" />
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:RibbonContextMenu}">
						<Border x:Name="SubMenuBorder" SnapsToDevicePixels="True" Background="{DynamicResource MenuBackgroundGradient}" BorderThickness="1" BorderBrush="{DynamicResource MenuBackgroundGradient}" CornerRadius="2,2,2,2">
							<Grid Background="{DynamicResource MenuBackgroundGradient}" Width="Auto" Height="Auto" Margin="1,1,1,1">
								<Grid.ColumnDefinitions>
									<ColumnDefinition x:Name="IconArea" SharedSizeGroup="MenuItemIconColumnGroup" Width="Auto"/>
									<!--SSP/JJD 10/15/07
									 Use the '*' for Width instead of 'Auto' because 'Auto' will cause the menu to be unreasonably 
									 wide for the ComboEditorTool because 'MenuItemIconColumnGroup' shared size group will cause it
									 unless '*' is used.
								-->
									<!--<ColumnDefinition x:Name="TextArea" Width="Auto"/>-->
									<ColumnDefinition x:Name="TextArea" Width="*"/>
								</Grid.ColumnDefinitions>

								<!-- JJD 12/4/07 - BR28873 -->
								<!-- Moved icon area background to menu item templates -->
								<!--<Border 
							Grid.Column="0" 
							Grid.ColumnSpan="1" 
							SnapsToDevicePixels="True" 
							Margin="0,0,0,0" 
							x:Name="LeftIconArea" 
							Background="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.MenuToolPresenterLeftColumnFillKey}}" 
							CornerRadius="1,0,0,1"
							 HorizontalAlignment="Left" 
							 Width="25" 
							 BorderBrush="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.GalleryItemGroupCaptionStrokeFillKey}}" 
							 BorderThickness="0,0,1,0"/>-->

								<Border
							Grid.Column="1"
							Grid.ColumnSpan="1"
							Margin="0,0,0,0" 
							Background="{DynamicResource MenuBackgroundGradient}" 
							CornerRadius="0,2,2,0" 
							SnapsToDevicePixels="True"/>

								<Grid 
							Margin="0,0,0,0" 
							Grid.Column="0" 
							Grid.ColumnSpan="2" 
							VerticalAlignment="Stretch" 
							HorizontalAlignment="Stretch"  Width="Auto" Height="Auto">

									<ItemsPresenter 
							KeyboardNavigation.TabNavigation="Cycle" 
							KeyboardNavigation.DirectionalNavigation="Cycle" 
							SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
							Grid.IsSharedSizeScope="true"/>

								</Grid>

							</Grid>
						</Border>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>

		<!-- =================================================================== -->
		<!-- Caption ContentControl Style -->
		<!-- =================================================================== -->
		<Style TargetType="{x:Type ContentControl}" x:Key="{x:Static igRibbon:RibbonCaptionPanel.CaptionStyleKey}">
			<Setter Property="Focusable" Value="False"/>
			<Setter Property="IsHitTestVisible" Value="False"/>
			<Setter Property="TextBlock.TextAlignment" Value="Center"/>
			<Setter Property="VerticalAlignment" Value="Center"/>
			<Setter Property="HorizontalAlignment" Value="Stretch"/>
			<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CaptionActiveTextForegroundKey}}"/>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type ContentControl}">
						<TextBlock 
						x:Name="CaptionText"
						Text="{TemplateBinding Content}" 
						FontSize="{DynamicResource {x:Static SystemFonts.CaptionFontSizeKey}}" 
						FontStyle="{DynamicResource {x:Static SystemFonts.CaptionFontStyleKey}}" 
						TextDecorations="{DynamicResource {x:Static SystemFonts.CaptionFontTextDecorationsKey}}" 
						TextTrimming="CharacterEllipsis"/>
						<ControlTemplate.Triggers>

							<!-- Glow when on Vista with glass enabled -->
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Normal" />
								</MultiDataTrigger.Conditions>
								<Setter TargetName="CaptionText" Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowSize=10, GlowColor=White, Opacity=0.6}"/>
							</MultiDataTrigger>

							<!--<DataTrigger Binding="{Binding Path=(igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True">
							<Setter Property="BitmapEffect" Value="{igWindows:SafeOuterGlow GlowColor=White, GlowSize=10, Opacity=0.6}"/>
						</DataTrigger>-->

							<!-- Inactive caption foreground -->
							<DataTrigger Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False">
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.CaptionInactiveTextForegroundKey}}" />
							</DataTrigger>

							<!-- Inactive glass caption foreground -->
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="False" />
								</MultiDataTrigger.Conditions>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.InactiveCaptionTextBrushKey}}" />
							</MultiDataTrigger>

							<!-- Active glass caption foreground -->
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding IsActive, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="True" />
								</MultiDataTrigger.Conditions>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.ActiveCaptionTextBrushKey}}" />
							</MultiDataTrigger>

							<!-- Active glass caption foreground when WindowState=Maximized -->
							<MultiDataTrigger>
								<MultiDataTrigger.Conditions>
									<Condition Binding="{Binding (igRibbon:XamRibbon.IsGlassActive), RelativeSource={x:Static RelativeSource.Self}}" Value="True" />
									<Condition Binding="{Binding WindowState, RelativeSource={RelativeSource FindAncestor, {x:Type Window}, 1}}" Value="Maximized" />
								</MultiDataTrigger.Conditions>
								<Setter Property="Foreground" Value="{DynamicResource {x:Static igRibbon:RibbonBrushKeys.VistaWindowMaximizedTextFillKey}}" />
							</MultiDataTrigger>

						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
		</Style>
        
<!--HERE!!!!-->

        <Style x:Key="RibbonGroupStyle1" TargetType="{x:Type igRibbon:RibbonGroup}">
			<Setter Property="SmallImage">
				<Setter.Value>
					<DrawingImage>
						<DrawingImage.Drawing>
							<DrawingGroup>
								<GeometryDrawing Brush="Transparent">
									<GeometryDrawing.Geometry>
										<RectangleGeometry Rect="0,0,11,11"/>
									</GeometryDrawing.Geometry>
								</GeometryDrawing>
								<DrawingGroup Opacity="0.67058823529411771">
									<GeometryDrawing Brush="White" Geometry="M1,1C1,1 10,1 10,1 10,1 10,10 10,10 10,10 1,10 1,10 1,10 1,1 1,1z M0,0C0,0 0,11 0,11 0,11 11,11 11,11 11,11 11,0 11,0 11,0 0,0 0,0z"/>
								</DrawingGroup>
								<DrawingGroup>
									<DrawingGroup.Transform>
										<MatrixTransform Matrix="1,0,0,1,3,3"/>
									</DrawingGroup.Transform>
									<GeometryDrawing Brush="White" Geometry="M5,0C5,0 4.2857132,0 4.2857132,0 4.2857132,0 0,5 0,5 0,5 0.7142868,5 0.7142868,5 0.7142868,5 5,0 5,0z"/>
								</DrawingGroup>
							</DrawingGroup>
						</DrawingImage.Drawing>
					</DrawingImage>
				</Setter.Value>
			</Setter>
			<Setter Property="Template">
				<Setter.Value>
					<ControlTemplate TargetType="{x:Type igRibbon:RibbonGroup}">
						<ControlTemplate.Resources>
							<Storyboard x:Key="RibbonGroup_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Center">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="PART_Header_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Header_Hover">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="RibbonGroup_IsInContextual_FadeIn">
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="IsInContextualCenter">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="RibbonGroup_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Center">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="PART_Header_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Header_Hover">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
							<Storyboard x:Key="RibbonGroup_IsInContextual_FadeOut">
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="IsInContextualCenter">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
								<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
									<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
								</DoubleAnimationUsingKeyFrames>
							</Storyboard>
						</ControlTemplate.Resources>
						<igWindows:CardPanel Width="1200">
							<ContentControl x:Name="PART_RibbonGroupSite" igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}" HorizontalAlignment="Left">
								<ContentControl.Style>
									<Style TargetType="{x:Type ContentControl}">
										<Setter Property="OverridesDefaultStyle" Value="True"/>
										<Setter Property="Margin" Value="0"/>
										<Setter Property="Padding" Value="0"/>
										<Setter Property="Focusable" Value="False"/>
										<Setter Property="Template">
											<Setter.Value>
												<ControlTemplate TargetType="{x:Type ContentControl}">
													<igWindows:CardPanel Background="{TemplateBinding Background}">
														<ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" Margin="{TemplateBinding Padding}" igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"/>
													</igWindows:CardPanel>
												</ControlTemplate>
											</Setter.Value>
										</Setter>
									</Style>
								</ContentControl.Style>
								<igWindows:CardPanel x:Name="groupPanel" Background="{TemplateBinding Background}" HorizontalAlignment="Left">
									<Grid x:Name="Center" Opacity="0">
										<Border Background="{DynamicResource RibbonBrushKeys.RibbonGroupHoverCenterFillKey}" CornerRadius="2" HorizontalAlignment="Stretch" Height="Auto" Margin="1,1,2,2" VerticalAlignment="Stretch" Width="Auto"/>
									</Grid>
									<Grid x:Name="IsInContextualCenter" Opacity="0">
										<Border Background="{DynamicResource RibbonBrushKeys.RibbonGroupIsInContextualHoverCenterFillKey}" CornerRadius="2" HorizontalAlignment="Stretch" Height="Auto" Margin="1,1,2,2" VerticalAlignment="Stretch" Width="Auto"/>
									</Grid>
									<Border x:Name="borderLight" BorderBrush="{x:Null}" BorderThickness="1" CornerRadius="3" HorizontalAlignment="Stretch" Margin="1,1,0,0" SnapsToDevicePixels="True">
										<DockPanel LastChildFill="True" KeyboardNavigation.TabNavigation="Local">
											<Grid DockPanel.Dock="Bottom" Height="Auto" KeyboardNavigation.TabIndex="1" KeyboardNavigation.TabNavigation="Local" Width="Auto">
												<Border x:Name="Header_Background" Background="{x:Null}" CornerRadius="0,0,2,2" HorizontalAlignment="Stretch" Margin="-1,0,0,0" SnapsToDevicePixels="True"/>
												<Border x:Name="Header_Hover" Background="{x:Null}" CornerRadius="0,0,2,2" HorizontalAlignment="Stretch" Margin="-1,0,0,0" Opacity="0" SnapsToDevicePixels="True"/>
												<DockPanel LastChildFill="True">
													<ContentControl x:Name="DialogBoxLauncher" Content="{TemplateBinding DialogBoxLauncherTool}" DockPanel.Dock="Right" Focusable="False" Height="15" Visibility="Hidden"/>
													<TextBlock x:Name="PART_Caption" Foreground="{DynamicResource RibbonBrushKeys.RibbonGroupCaptionTextFillKey}" HorizontalAlignment="Stretch" Margin="5,0,5,2" Grid.Row="1" igWindows:ClippedTextToolTipService.ShowToolTipWhenClipped="True" TextAlignment="Center" Text="{TemplateBinding Caption}" TextTrimming="CharacterEllipsis" VerticalAlignment="Bottom"/>
												</DockPanel>
											</Grid>
											<ItemsPresenter x:Name="PART_Items" HorizontalAlignment="Center" Margin="2,0,4,1" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" KeyboardNavigation.TabIndex="0" KeyboardNavigation.TabNavigation="Local"/>
										</DockPanel>
									</Border>
									<Border x:Name="borderDarkNormal" BorderBrush="{x:Null}" BorderThickness="1" CornerRadius="3" Margin="0,0,1,1" SnapsToDevicePixels="True"/>
									<Grid x:Name="BorderHover" Opacity="0" SnapsToDevicePixels="True">
										<Border x:Name="borderDarkHover" BorderBrush="{x:Null}" BorderThickness="1" CornerRadius="3" Margin="0,0,1,1" SnapsToDevicePixels="True"/>
									</Grid>
								</igWindows:CardPanel>
							</ContentControl>
							<igRibbon:DropDownToggle x:Name="PART_RibbonGroupButton" IsDroppedDown="{Binding IsOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Style="{DynamicResource RibbonGroup.CollapsedGroupButtonStyleKey}" igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}" Visibility="Collapsed"/>
							<Popup x:Name="PART_Popup" AllowsTransparency="True" igWindows:PopupHelper.HandleMouseDownOnClose="True" IsOpen="{Binding IsOpen, RelativeSource={RelativeSource TemplatedParent}}" Placement="Bottom" StaysOpen="False">
								<AdornerDecorator KeyboardNavigation.DirectionalNavigation="Cycle">
									<Border Background="{DynamicResource RibbonBrushKeys.ContainerFillKey}" CornerRadius="3">
										<ContentControl x:Name="PART_PopupRibbonGroupSite" igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}">
											<ContentControl.Style>
												<Style TargetType="{x:Type ContentControl}">
													<Setter Property="OverridesDefaultStyle" Value="True"/>
													<Setter Property="Margin" Value="0"/>
													<Setter Property="Padding" Value="0"/>
													<Setter Property="Focusable" Value="False"/>
													<Setter Property="Template">
														<Setter.Value>
															<ControlTemplate TargetType="{x:Type ContentControl}">
																<igWindows:CardPanel Background="{TemplateBinding Background}">
																	<ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}" Content="{TemplateBinding Content}" ContentStringFormat="{TemplateBinding ContentStringFormat}" Margin="{TemplateBinding Padding}" igRibbon:RibbonGroupPanel.SizingModeVersion="{TemplateBinding igRibbon:RibbonGroupPanel.SizingModeVersion}"/>
																</igWindows:CardPanel>
															</ControlTemplate>
														</Setter.Value>
													</Setter>
												</Style>
											</ContentControl.Style>
										</ContentControl>
									</Border>
								</AdornerDecorator>
							</Popup>
						</igWindows:CardPanel>
						<ControlTemplate.Triggers>
							<Trigger Property="IsOpen" Value="False">
								<Setter Property="PopupAnimation" TargetName="PART_Popup" Value="{DynamicResource {x:Static SystemParameters.MenuPopupAnimationKey}}"/>
							</Trigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="System_ComponentModel:DesignerProperties.IsInDesignMode" Value="False"/>
									<Condition Property="IsInContextualTabGroup" Value="True"/>
									<Condition Property="HighlightContent" Value="True"/>
								</MultiTrigger.Conditions>
								<MultiTrigger.EnterActions>
									<BeginStoryboard x:Name="RibbonGroup_IsInContextual_FadeIn_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="IsInContextualCenter">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
											</DoubleAnimationUsingKeyFrames>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
									<BeginStoryboard x:Name="PART_Header_IsInContextual_FadeIn_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Header_Hover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
								</MultiTrigger.EnterActions>
								<MultiTrigger.ExitActions>
									<StopStoryboard BeginStoryboardName="RibbonGroup_IsInContextual_FadeIn_BeginStoryboard"/>
									<StopStoryboard BeginStoryboardName="PART_Header_IsInContextual_FadeIn_BeginStoryboard"/>
									<BeginStoryboard x:Name="RibbonGroup_IsInContextual_FadeOut_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="IsInContextualCenter">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
											</DoubleAnimationUsingKeyFrames>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
									<BeginStoryboard x:Name="PART_Header_IsInContextual_FadeOut_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Header_Hover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
								</MultiTrigger.ExitActions>
							</MultiTrigger>
							<MultiTrigger>
								<MultiTrigger.Conditions>
									<Condition Property="System_ComponentModel:DesignerProperties.IsInDesignMode" Value="False"/>
									<Condition Property="IsInContextualTabGroup" Value="False"/>
									<Condition Property="HighlightContent" Value="True"/>
								</MultiTrigger.Conditions>
								<MultiTrigger.EnterActions>
									<BeginStoryboard x:Name="RibbonGroup_FadeIn_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Center">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
											</DoubleAnimationUsingKeyFrames>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
									<BeginStoryboard x:Name="PART_Header_FadeIn_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Header_Hover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="1"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
								</MultiTrigger.EnterActions>
								<MultiTrigger.ExitActions>
									<StopStoryboard BeginStoryboardName="RibbonGroup_FadeIn_BeginStoryboard"/>
									<StopStoryboard BeginStoryboardName="PART_Header_FadeIn_BeginStoryboard"/>
									<BeginStoryboard x:Name="RibbonGroup_FadeOut_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Center">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
											</DoubleAnimationUsingKeyFrames>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="BorderHover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
									<BeginStoryboard x:Name="PART_Header_FadeOut_BeginStoryboard">
										<Storyboard>
											<DoubleAnimationUsingKeyFrames BeginTime="0" Storyboard.TargetProperty="(UIElement.Opacity)" Storyboard.TargetName="Header_Hover">
												<SplineDoubleKeyFrame KeyTime="0:0:0.5" Value="0"/>
											</DoubleAnimationUsingKeyFrames>
										</Storyboard>
									</BeginStoryboard>
								</MultiTrigger.ExitActions>
							</MultiTrigger>
							<Trigger Property="IsCollapsed" Value="True">
								<Setter Property="Visibility" TargetName="PART_RibbonGroupButton" Value="Visible"/>
								<Setter Property="igRibbon:RibbonToolHelper.Caption" TargetName="PART_RibbonGroupButton" Value="{Binding Caption, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="igRibbon:RibbonToolHelper.SmallImage" TargetName="PART_RibbonGroupButton" Value="{Binding SmallImage, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="Visibility" TargetName="PART_RibbonGroupSite" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="IsActive" Value="True">
								<Setter Property="Background" TargetName="PART_RibbonGroupButton" Value="Yellow"/>
							</Trigger>
							<Trigger Property="Location" Value="QuickAccessToolbar">
								<Setter Property="Style" TargetName="PART_RibbonGroupButton" Value="{DynamicResource RibbonGroup.QuickAccessToolbarGroupButtonStyleKey}"/>
								<Setter Property="Visibility" TargetName="PART_RibbonGroupButton" Value="Visible"/>
								<Setter Property="igRibbon:RibbonToolHelper.Caption" TargetName="PART_RibbonGroupButton" Value="{Binding Caption, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="igRibbon:RibbonToolHelper.SmallImage" TargetName="PART_RibbonGroupButton" Value="{Binding SmallImage, RelativeSource={RelativeSource TemplatedParent}}"/>
								<Setter Property="Visibility" TargetName="PART_RibbonGroupSite" Value="Collapsed"/>
							</Trigger>
							<Trigger Property="HasDialogBoxLauncherTool" Value="True">
								<Setter Property="Visibility" TargetName="DialogBoxLauncher" Value="Visible"/>
							</Trigger>
						</ControlTemplate.Triggers>
					</ControlTemplate>
				</Setter.Value>
			</Setter>
			<Setter Property="Margin" Value="2,0,0,0"/>
			<Style.Triggers>
				<Trigger Property="Location" Value="QuickAccessToolbar">
					<Setter Property="Margin" Value="0"/>
					<Setter Property="Focusable" Value="True"/>
				</Trigger>
				<Trigger Property="IsCollapsed" Value="True">
					<Setter Property="Focusable" Value="True"/>
				</Trigger>
			</Style.Triggers>
		</Style>




		<!-- Templates Start -->
	</igRibbon:XamRibbon.Resources>
	<igRibbon:XamRibbon.QuickAccessToolbar >
		<igRibbon:QuickAccessToolbar Width="2000"  />
	</igRibbon:XamRibbon.QuickAccessToolbar>
	<igRibbon:XamRibbon.ApplicationMenu>
		<igRibbon:ApplicationMenu Image="/Razer;component/Resources/Icons/MainMenu_Default.png" >
			<igRibbon:ApplicationMenu.FooterToolbar>
				<igRibbon:ApplicationMenuFooterToolbar>
					<igRibbon:ButtonTool   Caption="E_xit" Id="ExitButton" IsQatCommonTool="True" LargeImage="/Razer;component/Resources/Exit.png" />
				</igRibbon:ApplicationMenuFooterToolbar>
			</igRibbon:ApplicationMenu.FooterToolbar>
			<igRibbon:ButtonTool   Caption="_Save" Id="btnSave" IsQatCommonTool="True" LargeImage="/Razer;component/Resources/Save.png" Command="Save" />
			<igRibbon:ButtonTool   Caption="_New" IsQatCommonTool="True" Id="btnInsert" LargeImage="/Razer;component/Resources/Insert_large.png" Command="New" />
			<igRibbon:ButtonTool   Caption="_Delete" Id="btnDelete" IsQatCommonTool="True" LargeImage="/Razer;component/Resources/Delete.png" Command="Delete" />
			<igRibbon:ButtonTool   Caption="Save _As" Id="btnSaveAs" LargeImage="/Razer;component/Resources/Save.png" Command="NotACommand" />
			<igRibbon:ButtonTool   Caption="E_xport" Id="btnExport" SmallImage="/Razer;component/Resources/Excel_Icon_small.jpg" Command="SaveAs" />
			<igRibbon:SeparatorTool/>
            <igRibbon:ButtonTool   Caption="Print Report" Id="btnPrintReport" SmallImage="/Razer;component/Resources/print.png" Command="Print" />
            <igRibbon:ButtonTool   Caption="Print Screen Ctrl F2" Id="btnPrintScreen" SmallImage="/Razer;component/Resources/print.png" Command="PrintPreview" />

            <!--<igRibbon:MenuTool Caption="_Print" Id="btnPrint" ButtonType="DropDown" LargeImage="/Razer;component/Resources/Print.png" >
				<igRibbon:LabelTool Caption="Print the Screen or a Report" />
				<igRibbon:ButtonTool   Caption="Print Screen" Id="btnPrintScreen" SmallImage="/Razer;component/Resources/Redo_small.png"  Command="PrintPreview" />
				<igRibbon:ButtonTool   Caption="Print Report" Id="btnPrintReport" SmallImage="/Razer;component/Resources/Redo_small.png" Command="Print" />
			</igRibbon:MenuTool>-->
			<igRibbon:SeparatorTool/>
			<igRibbon:ButtonTool   Caption="_Refresh" Id="btnRefresh" LargeImage="/Razer;component/Resources/Refresh.png" Command="Refresh" />
			<igRibbon:ButtonTool   Caption="C_lear" Id="btnClear" LargeImage="/Razer;component/Resources/Clear.png" Command="NotACommand" />
			<igRibbon:ButtonTool   Caption="_Undo" Id="btnUndo" Command="Undo" LargeImage="/Razer;component/Resources/Undo.png"/>
			<igRibbon:ButtonTool   Caption="R_edo" Id="btnRedo" Command="Redo" LargeImage="/Razer;component/Resources/Folder.png" />
			<igRibbon:SeparatorTool/>
			<igRibbon:ButtonTool   Caption="C_opy" Id="btnCopy" LargeImage="/Razer;component/Resources/Copy.png" Command="Copy" />
			<igRibbon:ButtonTool   Caption="C_ut" Id="btnCut" LargeImage="/Razer;component/Resources/Cut.png" Command="Cut" />
			<igRibbon:ButtonTool   Caption="Pas_te" Id="PasteTool" LargeImage="/Razer;component/Resources/Paste.png" Command="Paste" />
			<igRibbon:SeparatorTool/>
			<igRibbon:ButtonTool   Caption="_Close" Id="CloseButton" IsQatCommonTool="True" LargeImage="/Razer;component/Resources/Close.png" Command="Close" />
		</igRibbon:ApplicationMenu>
	</igRibbon:XamRibbon.ApplicationMenu>
	<igRibbon:XamRibbon.ContextualTabGroups>
		<igRibbon:ContextualTabGroup  IsVisible="True" Key="ctgCore" ToolTipService.ShowDuration="20000">
			<igRibbon:RibbonTabItem Header="Folder">
				<igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" HorizontalAlignment="Left" >
					<igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" HorizontalAlignment="Left">
								<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Ads" Id="btnAds" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/AdsFolder.png" ToolTip="Open Ads Folder" Foreground="#FFD2D2D2" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Ads Search" Id="btnAdSearch" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/AdsSearch.png" ToolTip="Open Ads Search" Foreground="#FFD2D2D2" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Audit" Id="btnAudit" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/AuditFolder.png" ToolTip="Open Audit Folder" Foreground="#FFD2D2D2" Height="77" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Cash" Id="btnCash" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/CashFolder.png" ToolTip="Open Cash Folder" Foreground="#FFD2D2D2" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Entity" Id="btnEntity" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/EntityFolder.png" ToolTip="Open Entity Folder" Foreground="#FFD2D2D2" Height="77" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="People" Id="btnContacts" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/ContactFolder.png" ToolTip="Open Contact Folder" 
                            Foreground="#FFD2D2D2" HorizontalAlignment="Center" IsQatCommonTool="True" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Contract" Id="btnContracts" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/ContractFolder.png" ToolTip="Open Contract Folder" Foreground="#FFD2D2D2" HorizontalAlignment="Center" />
						
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Customer" Id="btnCustomer" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/CustomerFolder.png" ToolTip="Open Customer Folder" Foreground="#FFD2D2D2" Height="77" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Invoice" Id="btnInvoice" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/InvoiceFolder.png" ToolTip="Open Invoice Folder" Foreground="#FFD2D2D2" Height="77" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Location" Id="btnLocation" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/LocationFolder.png" ToolTip="Open Location Folder" Foreground="#FFD2D2D2" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Withholding Tax" Id="btnWithholdingTax" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/WithholdingTaxFolder.png" ToolTip="Open Withholding Tax Folder" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Custom Invoice" Id="btnCustomInvoice" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/CustomInvoiceFolder.png" ToolTip="Open Custom Invoice Folder" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="BCF" Id="btnBCF" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/InvoiceConversion.png" ToolTip="Open BCF Folder" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="TF" Id="btnTF" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/UploadAdjustment.png" ToolTip="Open TF Folder" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                    </igRibbon:ToolHorizontalWrapPanel>
                </igRibbon:RibbonGroup>
			</igRibbon:RibbonTabItem>
			<igRibbon:RibbonTabItem Header="Billing" FontWeight="Medium">
				<igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" HorizontalAlignment="Left" >
					<igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" HorizontalAlignment="Left">
						<!--<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Ads Interactive Revenue Distribution" Id="btnAdRevenueDistribution" 
								igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/AdsInteractiveRevenueDist.png" ToolTip="Open Ads Interactive Revenue Distribution" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />-->
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Create Billing Batch" Id="btnBillingBatch" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreateBillingBatch.png" ToolTip="Open Create Billing Batch" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Unposted Billing" Id="btnUnpostedBiling" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/UnpostedBilling.png" ToolTip="Open Unposted Biling" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Post Billing" Id="btnPostBiling" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/PostBilling.png" ToolTip="Open Post Biling" Foreground="#FFD2D2D2" Height="80" />
                        
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Generate Invoices" Id="btnGenerateInvoices" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/GenerateInvoices.png" ToolTip="Open Generate Invoices" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Ads Revenue Allocation" Id="btnAdsRevenueAllocation" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/AdsInteractiveRevenueDist.png" ToolTip="Open Ads Revenue Allocation" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Ads Billing  " Id="btnPostAdsBiling" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/PostAdsBilling.png" ToolTip="Open Schedule Ads Billing" Foreground="#FFD2D2D2" Height="80" />

                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Generate Ads Invoices" Id="btnGenerateAdsInvoices" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/GenerateAdsInvoices.png" ToolTip="Open Generate Ads Invoices" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						
					
						
						
                       
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Generate Custom Invoices" Id="btnGenerateCustomInvoices" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/GenerateCustomInvoices.png" ToolTip="Open Generate Custom Invoices" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="View Unposted Custom Invoices" Id="btnViewUnpostedCustomInvoices" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/ViewUnpostedCostumInvoices.png" ToolTip="Open Unposted Custom Invoices" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Post Custom Billing" Id="btnPostCustomBiling" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/PostCustomBilling.png" ToolTip="Open Post Custom Billing" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Invoice Email Queue" Id="btnInvoiceEmailQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/InvoiceEmailQueue.png" ToolTip="Open Email Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="COLA" Id="btnCola" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/COLA.png" ToolTip="Open COLA" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Contract Reporting Queue" Id="btnContractReportingQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/InvoiceEmailQueue.png" ToolTip="Open Contract Reporting Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="BCF/TF Ops Email Queue" Id="btnBCFEmailQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/InvoiceEmailQueue.png" ToolTip="Open BCF/TF Ops Email Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Proforma Queue" Id="btnProformaTrackingQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CustomInvoiceFolder.png" ToolTip="Open Proforma Tracking Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                       
                    </igRibbon:ToolHorizontalWrapPanel>
				</igRibbon:RibbonGroup>
			</igRibbon:RibbonTabItem>
			<igRibbon:RibbonTabItem Header="Customer">
				<igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" Width="800" HorizontalAlignment="Left" >
					<igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" HorizontalAlignment="Left">
							  <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Comment Search" Id="btnCommentSearch" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CommentSearch.png" ToolTip="Open Comment Search" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Credit Memo Adjustment" Id="btnCreditMemoAdjustment" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreditMemoAdjustment.png" ToolTip="Open Credit Memo Adjustment" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Invoice Conversion" Id="btnInvoiceConversion" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/InvoiceConversion.png" ToolTip="Open Invoice Conversion" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Customer Documents" Id="btnReceivableDocument" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/ReceivableDocumentFolder.png" ToolTip="Open Receivable Document Folder" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Upload Adjustment" Id="btnUploadAdjustment" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/UploadAdjustment.png" ToolTip="Open Upload Adjustment" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="View Cash Document" Id="btnViewCash" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CustomInvoiceAdjustment.png" ToolTip="Open Cash Document" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Cash Document Search" Id="btnCashDocSearch" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							    LargeImage="/Razer;component/Resources/Icons/CommentSearch.png" ToolTip="Open Cash Document Search" Foreground="#FFD2D2D2" HorizontalAlignment="Center" VerticalAlignment="Top" />
					   </igRibbon:ToolHorizontalWrapPanel>
				</igRibbon:RibbonGroup>
			</igRibbon:RibbonTabItem>
			<igRibbon:RibbonTabItem Header="Accounting">
				<igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" Width="800" HorizontalAlignment="Left" >
					<igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" HorizontalAlignment="Left">
						<!--<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Cash Entry" Id="btnCashEntry" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge"--> 
								<!--LargeImage="/Razer;component/Resources/Icons/CashEntry.png" ToolTip="Open Cash Entry" Foreground="#FFD2D2D2" Height="80" />-->
						<!--<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Create Deferred Pool Voucher" Id="btnDeferredPoolVoucher" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreateDeferredPoolVoucher.png" ToolTip="Open Deferred Pool Voucher" Foreground="#FFD2D2D2" Height="80" />-->
                      
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="G/L Journal Voucher Folder" Id="btnJournalVoucher" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/GLJournalVoucherFolder.png" ToolTip="Open G/L Journal Voucher Folder" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Post Cash" Id="btnPostCash" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/PostCash.png" ToolTip="Open Post Cash" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Post G/L" Id="btnPostGL" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/PostGL.png" ToolTip="Open Post G/L" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
						<!--<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Deferred Pool Detail" Id="btnDeferredPoolDetail" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreateDeferredPoolVoucher.png" ToolTip="Open Deferred Pool Detail" Foreground="#FFD2D2D2" Height="80" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Deferred Revenue Maintenance" Id="btnDeferredRevenueMaint" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreateDeferredPoolVoucher.png" ToolTip="Open Deferred Revenue Maintenance Folder" Foreground="#FFD2D2D2" Height="80" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Deferred Revenue Unapplied Cash" Id="btnDeferredRevenueUnappliedCash" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreateDeferredPoolVoucher.png" ToolTip="Open Deferred Revenue Unapplied Cash Folder" Foreground="#FFD2D2D2" Height="80" />-->
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Accounting Class" Id="btnUpdateAccountingClass" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/Credit_DebitAdjustment.png" ToolTip="Open Update Accounting Class" Foreground="#FFD2D2D2" Height="80" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Set Period" Id="btnSetPeriod" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/SetPeriod.png" ToolTip="Open Set Period" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Currency Conversion" Id="btnCurConv" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/ApplyCashAdjustment.png" ToolTip="Currency Conversion Rates" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />

                    </igRibbon:ToolHorizontalWrapPanel>
				</igRibbon:RibbonGroup>
			</igRibbon:RibbonTabItem>
            <igRibbon:RibbonTabItem Header="Adjustments/Queues">
                <igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" Width="800" HorizontalAlignment="Left" >
                    <igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" HorizontalAlignment="Left">
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Adjustments" Id="btnAdjustments" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
							LargeImage="/Razer;component/Resources/Icons/AdjustmentFolder.png" ToolTip="Open Adjustments Folder" Foreground="#FFD2D2D2" Height="77" HorizontalAlignment="Center" VerticalAlignment="Top"  />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Adjustment Queue" Id="btnAdjustmentQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/AdjustmentQue.png" ToolTip="Open Adjustment Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Workflow Queue" Id="btnWorkflowQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/WorkflowQue.png" ToolTip="Open Workflow Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Adjustment Upload" Id="btnAdjustmentUpload" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/UploadAdjustment.png" ToolTip="Adjustment Upload" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                    </igRibbon:ToolHorizontalWrapPanel>
                </igRibbon:RibbonGroup>
            </igRibbon:RibbonTabItem>
            <igRibbon:RibbonTabItem Header="Units" Margin="0,0,0,0" d:LayoutOverrides="Width">
                <igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}"  HorizontalAlignment="Left" >
                    <igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" Width="Auto" HorizontalAlignment="Left">
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Unit Filter Setup" Id="btnUnitSetup" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/UnitFilterSetup.png" ToolTip="Unit Filter Setup" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Unit Type Setup" Id="btnUnitTypeSetup" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/TableMaintenence.png" ToolTip="Unit Type Setup" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Unit Upload" Id="btnUnitsUpload" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/UnitUpload.png" ToolTip="Unit Upload" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Unit Entry" Id="btnUnitsEntry" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/UnitEntry.png" ToolTip="Unit Entry" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Ancillary Upload" Id="btnAncillaryUpload" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/UploadAdjustment.png" ToolTip="Ancillary Upload" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                    </igRibbon:ToolHorizontalWrapPanel>
                </igRibbon:RibbonGroup>
            </igRibbon:RibbonTabItem>
            <igRibbon:RibbonTabItem Header="Reporting"  d:LayoutOverrides="Width">
                <igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" Width="800" HorizontalAlignment="Left" >
                    <igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" Width="Auto" HorizontalAlignment="Left">
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Job/Group Maintenance" Id="btnJobGroupMaintenance" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/JobGroup_Maintenance.png" ToolTip="Open Job/Group Maintenance" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Job/Group Viewer" Id="btnJobGroupViewer" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/JobGroup_Viewer.png" ToolTip="Open Job/Group Viewer" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Report Manager" Id="btnReportConfigurationViewer" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/Report_ConfigurationViewer.png" ToolTip="Open Report Configuration/Viewer" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Report Setup" Id="btnReportSetup" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/ReportSetup.png" ToolTip="Open Report Setup" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
 
                    </igRibbon:ToolHorizontalWrapPanel>
                </igRibbon:RibbonGroup>
            </igRibbon:RibbonTabItem>

            <igRibbon:RibbonTabItem Header="Admin" d:LayoutOverrides="Width">
				<igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" Width="800" HorizontalAlignment="Left" >
					<igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" Width="Auto" HorizontalAlignment="Left">
                        
                   
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Exception Handling" Id="btnExceptionHandling" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/ExceptionHandling.png" ToolTip="Open Exception Handling" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Configuration Maintenance" Id="btnTableMaintenance" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/TableMaintenence.png" ToolTip="Open Configuration Maintenance" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Secured Objects" Id="btnSecuredObjects" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/SecuredObjects.png" ToolTip="Open Secured Objects" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Security Role/Access Maintenance" Id="btnRoleAccessMaintenance" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/Security.png" ToolTip="Open Security Role/Access Maintenance" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="User Maintenance" Id="btnUserMaintenance" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/UserMaitenance.png" ToolTip="Open Security User Maintenance" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" />
						<igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Job Monitor" Id="btnJobMonitor" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/JobMonitor.png" ToolTip="Open Job Monitor" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Schedule Job/Report" Id="btnScheduleJobReport" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/Schedule_JobReport.png" ToolTip="Open Schedule Job/Report" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />

                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Salesperson" Id="btnSalesperson" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
					LargeImage="/Razer;component/Resources/Icons/ferrari.png" ToolTip="Open Salesperson" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />

                    </igRibbon:ToolHorizontalWrapPanel>
                    
				</igRibbon:RibbonGroup>
			</igRibbon:RibbonTabItem>

            <igRibbon:RibbonTabItem Header="Deferred">
                <igRibbon:RibbonGroup Style="{DynamicResource RibbonGroupStyle1}" Margin="2,-7.5,0,-6.5" Width="800" HorizontalAlignment="Left" >
                    <igRibbon:ToolHorizontalWrapPanel Margin="0,0,0,-15" HorizontalAlignment="Left">
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Schedule Lockdown CM Memo" Id="btnLockdownCMMemo" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/LockdownCreditMemo_BadDebt.png" ToolTip="Schedule Lockdown CM Job" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Credit Status Queue" Id="btnCreditStatusEmailQueue" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/WorkflowQue.png" ToolTip="Open Credit Status Queue" Foreground="#FFD2D2D2" Height="80" HorizontalAlignment="Center" VerticalAlignment="Top" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Create Deferred Pool Voucher" Id="btnDeferredPoolVoucher" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/GLJournalVoucherFolder.png" ToolTip="Open Deferred Pool Voucher" Foreground="#FFD2D2D2" Height="80" />

                      
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Deferred Pool Detail" Id="btnDeferredPoolDetail" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/CreateDeferredPoolVoucher.png" ToolTip="Open Deferred Pool Detail" Foreground="#FFD2D2D2" Height="80" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Deferred Revenue Management" Id="btnDeferredRevenueMaint" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/TableMaintenence.png" ToolTip="Open Deferred Revenue Management" Foreground="#FFD2D2D2" Height="80" />
                        <igRibbon:ButtonTool Template="{DynamicResource RibbonButtonToolTemplate1}"  Caption="Deferred Revenue Unapplied Cash" Id="btnDeferredRevenueUnappliedCash" igRibbon:RibbonGroup.MaximumSize="ImageAndTextLarge" 
								LargeImage="/Razer;component/Resources/Icons/PostCash.png" ToolTip="Open Deferred Revenue Unapplied Cash Folder" Foreground="#FFD2D2D2" Height="80" />
                      
                        
                    </igRibbon:ToolHorizontalWrapPanel>
                </igRibbon:RibbonGroup>
            </igRibbon:RibbonTabItem>
        </igRibbon:ContextualTabGroup>
	</igRibbon:XamRibbon.ContextualTabGroups>
</igRibbon:XamRibbon>
